(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{VzSG:function(e,t,i){"use strict";i.r(t),i.d(t,"SupervisionModule",function(){return Tt});var l=i("ofXK"),a=i("tyNb"),s=i("fXoL"),n=i("v8Ou"),o=i("0IaG"),h=i("+0xr"),r=i("M9IT"),d=i("Dh3D"),c=i("l7P3");function p(e,t){1&e&&(s.Wb(0,"th",16),s.Ec(1," C\xf3digo "),s.Vb())}function g(e,t){if(1&e&&(s.Wb(0,"td",17),s.Ec(1),s.Vb()),2&e){const e=t.$implicit;s.Eb(1),s.Gc(" ",e.codigo," ")}}function u(e,t){1&e&&(s.Wb(0,"th",16),s.Ec(1," Riesgo "),s.Vb())}function b(e,t){if(1&e&&(s.Wb(0,"td",17),s.Ec(1),s.Vb()),2&e){const e=t.$implicit;s.Eb(1),s.Gc(" ",e.nombre," ")}}function m(e,t){1&e&&(s.Wb(0,"th",18),s.Ec(1," Frecuencia "),s.Vb())}function x(e,t){if(1&e&&(s.Wb(0,"td",17),s.Ec(1),s.Vb()),2&e){const e=t.$implicit;s.Eb(1),s.Gc(" ",e.frecuencia," ")}}function S(e,t){1&e&&(s.Wb(0,"th",18),s.Ec(1," Impacto "),s.Vb())}function C(e,t){if(1&e&&(s.Wb(0,"td",17),s.Ec(1),s.Vb()),2&e){const e=t.$implicit;s.Eb(1),s.Gc(" ",e.impacto," ")}}function y(e,t){1&e&&(s.Wb(0,"th",16),s.Ec(1," R. Inherente "),s.Vb())}function M(e,t){if(1&e&&(s.Wb(0,"td",17),s.Ec(1),s.Vb()),2&e){const e=t.$implicit;s.Eb(1),s.Gc(" ",e.riesgoInherente," ")}}function v(e,t){1&e&&(s.Wb(0,"th",18),s.Ec(1," Frecuencia R"),s.Vb())}function f(e,t){if(1&e&&(s.Wb(0,"td",17),s.Ec(1),s.Vb()),2&e){const e=t.$implicit;s.Eb(1),s.Gc(" ",e.frecuenciaResidual," ")}}function w(e,t){1&e&&(s.Wb(0,"th",18),s.Ec(1," Impacto R "),s.Vb())}function R(e,t){if(1&e&&(s.Wb(0,"td",17),s.Ec(1),s.Vb()),2&e){const e=t.$implicit;s.Eb(1),s.Gc(" ",e.impactoResidual," ")}}function L(e,t){1&e&&(s.Wb(0,"th",18),s.Ec(1," R. Residual "),s.Vb())}function T(e,t){if(1&e&&(s.Wb(0,"td",17),s.Ec(1),s.Vb()),2&e){const e=t.$implicit;s.Eb(1),s.Gc(" ",e.riesgoResidual," ")}}function O(e,t){1&e&&s.Rb(0,"tr",19)}function j(e,t){1&e&&s.Rb(0,"tr",20)}const A=function(){return[5,10,25,100]};let I=(()=>{class e{constructor(e,t,i){this._store=e,this._dialogRef=t,this._detail=i,this.dataSource=new h.o,this.displayedColumns=[]}ngOnInit(){this._detail&&("I"==this._detail.tipo?(this.displayedColumns=["codigo","nombre","frecuencia","impacto","riesgoInherente"],this.cargaRiesgos(this._detail.frecuencia,this._detail.impacto)):"R"==this._detail.tipo&&(this.displayedColumns=["codigo","nombre","frecuenciaResidual","impactoResidual","riesgoInherente","riesgoResidual"],this.cargaRiesgosRR(this._detail.frecuencia,this._detail.impacto)))}ngOnDestroy(){this.riesgoSubs&&this.riesgoSubs.unsubscribe()}cargaRiesgos(e,t){this._store.dispatch(n.E({frecuencia:e,impacto:t})),this.riesgoSubs=this._store.select("riesgo").subscribe(e=>{this.dataSource.data=e.riesgos,this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}cargaRiesgosRR(e,t){this._store.dispatch(n.F({frecuencia:e,impacto:t})),this.riesgoSubs=this._store.select("riesgo").subscribe(e=>{this.dataSource.data=e.riesgos,this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})}}return e.\u0275fac=function(t){return new(t||e)(s.Qb(c.h),s.Qb(o.h),s.Qb(o.a))},e.\u0275cmp=s.Kb({type:e,selectors:[["app-detalle-riesgos"]],viewQuery:function(e,t){if(1&e&&(s.Ic(r.a,1),s.Ic(d.a,1)),2&e){let e;s.rc(e=s.ec())&&(t.paginator=e.first),s.rc(e=s.ec())&&(t.sort=e.first)}},decls:29,vars:5,consts:[[1,"mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","codigo"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","nombre"],["matColumnDef","frecuencia"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","impacto"],["matColumnDef","riesgoInherente"],["matColumnDef","frecuenciaResidual"],["matColumnDef","impactoResidual"],["matColumnDef","riesgoResidual"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["pageSize","10","aria-label","Select page of risks",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-header-row",""],["mat-row",""]],template:function(e,t){1&e&&(s.Wb(0,"div",0),s.Wb(1,"table",1),s.Ub(2,2),s.Cc(3,p,2,0,"th",3),s.Cc(4,g,2,1,"td",4),s.Tb(),s.Ub(5,5),s.Cc(6,u,2,0,"th",3),s.Cc(7,b,2,1,"td",4),s.Tb(),s.Ub(8,6),s.Cc(9,m,2,0,"th",7),s.Cc(10,x,2,1,"td",4),s.Tb(),s.Ub(11,8),s.Cc(12,S,2,0,"th",7),s.Cc(13,C,2,1,"td",4),s.Tb(),s.Ub(14,9),s.Cc(15,y,2,0,"th",3),s.Cc(16,M,2,1,"td",4),s.Tb(),s.Ub(17,10),s.Cc(18,v,2,0,"th",7),s.Cc(19,f,2,1,"td",4),s.Tb(),s.Ub(20,11),s.Cc(21,w,2,0,"th",7),s.Cc(22,R,2,1,"td",4),s.Tb(),s.Ub(23,12),s.Cc(24,L,2,0,"th",7),s.Cc(25,T,2,1,"td",4),s.Tb(),s.Cc(26,O,1,0,"tr",13),s.Cc(27,j,1,0,"tr",14),s.Vb(),s.Rb(28,"mat-paginator",15),s.Vb()),2&e&&(s.Eb(1),s.mc("dataSource",t.dataSource),s.Eb(25),s.mc("matHeaderRowDef",t.displayedColumns),s.Eb(1),s.mc("matRowDefColumns",t.displayedColumns),s.Eb(1),s.mc("pageSizeOptions",s.oc(4,A)))},directives:[h.n,d.a,h.c,h.i,h.b,h.k,h.m,r.a,h.h,d.b,h.a,h.j,h.l],styles:["table[_ngcontent-%COMP%]{width:100%}"]}),e})();var V=i("xa+l"),D=i("z6cu"),z=i("JIr8"),P=i("tk/3");let E=(()=>{class e{constructor(e){this.http=e,this.url=`${V.a}/escalaColores`}getEscalaColores(){return this.http.get(this.url).pipe(Object(z.a)(e=>(console.log(e),Object(D.a)(`${e.error.hasOwnProperty("title")?e.error.title:e.error}: ${e.message}`))))}getEscalaColor(e){return this.http.get(`${this.url}/${e}`).pipe(Object(z.a)(e=>(console.log(e),Object(D.a)(`${e.error.hasOwnProperty("title")?e.error.title:e.error}: ${e.message}`))))}addEscalaColor(e){return this.http.post(this.url,e).pipe(Object(z.a)(e=>(console.log(e),Object(D.a)(`${e.error.hasOwnProperty("title")?e.error.title:e.error}: ${e.message}`))))}updateEscalaColor(e){return this.http.put(`${this.url}/${e.escalaColorId}`,e).pipe(Object(z.a)(e=>(console.log(e),Object(D.a)(`${e.error.hasOwnProperty("title")?e.error.title:e.error}: ${e.message}`))))}deleteEscalaColor(e){return this.http.delete(`${this.url}/${e}`).pipe(Object(z.a)(e=>(console.log(e),Object(D.a)(`${e.error.hasOwnProperty("title")?e.error.title:e.error}: ${e.message}`))))}}return e.\u0275fac=function(t){return new(t||e)(s.ac(P.a))},e.\u0275prov=s.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var _=i("FesS"),B=i("h+i/"),G=function(){function e(){this.isProtectedOnChange=!0,this.isFormInit=!0}return e.prototype.saveChanges=function(e,t,i){if(!this.isProtectedOnChange){this.oldProperties[e]=i,this.changedProperties[e]=t,this.finalUpdate();var l=setTimeout(this.dataBind.bind(this));this.finalUpdate=function(){clearTimeout(l)}}},e.prototype.ngOnInit=function(e){var t=e||this;t.registeredTemplate={},t.ngBoundedEvents={},t.isAngular=!0,t.isFormInit=!0,e&&(this.tags=e.tags),t.tags=this.tags||[],t.complexTemplate=this.complexTemplate||[],t.tagObjects=[],t.ngAttr=this.getAngularAttr(t.element),t.createElement=function(e,i){var l=t.srenderer?t.srenderer.createElement(e):Object(B.p)(e);return void 0===i||(l.innerHTML=i.innerHTML?i.innerHTML:"",void 0!==i.className&&(l.className=i.className),void 0!==i.id&&(l.id=i.id),void 0!==i.styles&&l.setAttribute("style",i.styles),void 0!==t.ngAttr&&l.setAttribute(t.ngAttr,""),void 0!==i.attrs&&Object(B.n)(l,i.attrs)),l};for(var i=0,l=t.tags;i<l.length;i++){var a=l[i],s={instance:Object(B.s)("child"+a.substring(0,1).toUpperCase()+a.substring(1),t),name:a};t.tagObjects.push(s)}for(var n=Object.keys(t),o=0,h=n=n.filter(function(e){return/Ref$/i.test(e)&&/\_/i.test(e)});o<h.length;o++){var r=h[o].replace("Ref",""),d={};Object(B.D)(r.replace("_","."),Object(B.s)(r,t),d),t.setProperties(d,!0)}},e.prototype.getAngularAttr=function(e){for(var t,i=e.attributes,l=i.length,a=0;a<l;a++)/_ngcontent/g.test(i[a].name)&&(t=i[a].name);return t},e.prototype.ngAfterViewInit=function(e){var t=e||this;/ejs-tab|ejs-accordion/g.test(t.ngEle.nativeElement.outerHTML)&&(t.ngEle.nativeElement.style.visibility="hidden");for(var i=Object.keys(t),l=0,a=i=i.filter(function(e){return/Ref$/i.test(e)});l<a.length;l++){var s=a[l].replace("Ref","");Object(B.D)(s.replace("_","."),Object(B.s)(s+"Ref",t),t)}"btn"===t.getModuleName()?"undefined"!=typeof window&&document.body.contains(t.element)&&(t.appendTo(t.element),t.ngEle.nativeElement.style.visibility=""):setTimeout(function(){"undefined"!=typeof window&&document.body.contains(t.element)&&(t.appendTo(t.element),t.ngEle.nativeElement.style.visibility="")})},e.prototype.ngOnDestroy=function(e){var t=e||this;setTimeout(function(){"undefined"!=typeof window&&t.element.classList.contains("e-control")&&(t.destroy(),t.clearTemplate(null),t.ngBoundedEvents={},t.tagObjects={},t.ngEle=null)})},e.prototype.clearTemplate=function(e,t){!function(e,t,i){var l=Object.keys(e.registeredTemplate);if(l.length)for(var a=t&&t.filter(function(e){return!/\./g.test(e)}),s=0,n=a&&a||l;s<n.length;s++){var o=n[s];if(i&&i.length)for(var h=0;h<i.length;h++)for(var r=0;r<e.registeredTemplate.template.length;r++)e.registeredTemplate.template[r].rootNodes[0]===i[h]&&(p=e.registeredTemplate[o])[r].destroy();else if(e.registeredTemplate[o])for(var d=0,c=e.registeredTemplate[o];d<c.length;d++){var p;if(!(p=c[d]).destroyed){if(p._view){var g=p._view.renderer.parentNode(p.rootNodes[0]);if(!Object(B.u)(g))for(r=0;r<p.rootNodes.length;r++)g.appendChild(p.rootNodes[r])}p.destroy()}}delete e.registeredTemplate[o]}for(var u=function(e){e.instance&&e.instance.clearTemplate(t&&t.filter(function(t){return!!new RegExp(e.name).test(t)}))},b=0,m=e.tagObjects;b<m.length;b++)u(m[b])}(this,e,t)},e.prototype.ngAfterContentChecked=function(e){for(var t=e||this,i=0,l=t.tagObjects;i<l.length;i++){var a=l[i];if(!Object(B.w)(a.instance)&&(a.instance.isInitChanges||a.instance.hasChanges||a.instance.hasNewChildren))if(a.instance.isInitChanges){var s={},n=void 0;(M=Object(B.s)("instance.list",a))&&M.length&&(n=M[0].directivePropList);var o=!0;if(t.getModuleName&&"gantt"===t.getModuleName()&&(o=!1),n&&o&&-1===n.indexOf(a.instance.propertyName))for(var h=Object.keys(a.instance.list[0].propCollection),r=0;r<a.instance.list.length;r++){a.instance.list[r].propCollection[a.instance.propertyName]=[];for(var d={},c=0;c<h.length;c++)d[T=h[c]]=a.instance.list[r].propCollection[T];for(var p=0;p<a.instance.list[r].tags.length;p++){var g=a.instance.list[r].tags[p],u=Object(B.s)("child"+g.substring(0,1).toUpperCase()+g.substring(1),a.instance.list[r]);if(u){var b=a.instance.list[r]["child"+g.substring(0,1).toUpperCase()+g.substring(1)];if(b)for(var m=0;m<b.list.length;m++){var x=b.list[0].tags[0];if(x){var S=Object(B.s)("child"+x.substring(0,1).toUpperCase()+x.substring(1),b.list[m]);S&&b.list[m].tagObjects.push({instance:S,name:x})}}a.instance.list[r].tagObjects.push({instance:u,name:g})}}a.instance.list[r].propCollection[a.instance.propertyName].push(d)}s[a.name]=a.instance.getProperties(),t.setProperties(s,a.instance.isInitChanges)}else{t[a.name].length===a.instance.list.length&&"diagram"!==t.getModuleName()||(t[a.name]=a.instance.list);for(var C=0,y=a.instance.list;C<y.length;C++){var M,v=a.instance.list.indexOf(M=y[C]),f=Object(B.s)(a.name,t)[v],w=Object.keys(f);if(w=w.filter(function(e){return/Ref$/i.test(e)}),f.properties&&0!==Object.keys(f.properties).length&&/chart/.test(t.getModuleName()))for(var R=0,L=w;R<L.length;R++){var T;T=(T=L[R]).replace(/Ref/,""),f.properties[T]=f.properties[T]?f.properties[T]:f.propCollection[T]}Object(B.w)(f)||Object(B.w)(f.setProperties)||(/diagram|DashboardLayout/.test(t.getModuleName())?f.setProperties(M.getProperties(),!0):f.setProperties(M.getProperties())),M.isUpdated=!0}}}},e.prototype.registerEvents=function(e){!function(e,t,i){var l={};if(e&&e.length){for(var a=0,n=e;a<n.length;a++){var o=n[a];l[o]=new s.o(!1)}t.setProperties(l,!0)}}(e,this)},e.prototype.twoWaySetter=function(e,t){var i=Object(B.s)(t,this.properties);i!==e&&(this.saveChanges(t,e,i),Object(B.D)(t,Object(B.u)(e)?null:e,this.properties),Object(B.s)(t+"Change",this).emit(e))},e.prototype.addTwoWay=function(e){for(var t=this,i=function(e){Object(B.s)(e,l),Object.defineProperty(l,e,{get:function(){return Object(B.s)(e,t.properties)},set:function(i){return t.twoWaySetter(i,e)}}),Object(B.D)(e+"Change",new s.o,l)},l=this,a=0,n=e;a<n.length;a++)i(n[a])},e.prototype.addEventListener=function(e,t){var i=Object(B.s)(e,this);Object(B.w)(i)||(this.ngBoundedEvents[e]||(this.ngBoundedEvents[e]=new Map),this.ngBoundedEvents[e].set(t,i.subscribe(t)))},e.prototype.removeEventListener=function(e,t){var i=Object(B.s)(e,this);Object(B.w)(i)||this.ngBoundedEvents[e].get(t).unsubscribe()},e.prototype.trigger=function(e,t,i){var l=Object(B.s)(e,this),a=this.isProtectedOnChange;this.isProtectedOnChange=!1,t&&(t.name=e),Object(B.w)(l)||l.next(t);var s=Object(B.s)("local"+e.charAt(0).toUpperCase()+e.slice(1),this);Object(B.w)(s)||s.call(this,t),this.isProtectedOnChange=a,i&&(this.preventChange=this.isPreventChange,i.call(this,t)),this.isPreventChange=!1},e}(),F=Object(B.r)();Object(B.C)({compile:function(e,t){if("string"==typeof e)return F(e,t);var i=e.elementRef.nativeElement._viewContainerRef,l=e.elementRef.nativeElement.propName;return function(t,a,s){var n=i||a.viewContainerRef,o=n.createEmbeddedView(e,{$implicit:t});o.markForCheck();var h=a&&a.registeredTemplate?a.registeredTemplate:Object(B.s)("currentInstance.registeredTemplate",n);return void 0===h[s=s&&a.registeredTemplate?s:l]&&(h[s]=[]),h[s].push(o),o.rootNodes}}});var N,H=i("FioG"),k=i("YFW5"),W=i("W1Am");!function(e){e.heatMapTitleFont={size:"15px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.titleFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI",textOverflow:"None"},e.axisTitleFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.axisLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.legendLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI",textOverflow:"None"},e.rectLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI",textOverflow:"None"},e.tooltipFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI",textOverflow:"None"}}(N||(N={}));var Y=function(e,t,i,l){var a,s=arguments.length,n=s<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,l);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(s<3?a(n):s>3?a(t,i,n):a(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let X=(()=>{class e extends B.d{}return Y([Object(B.l)("16px")],e.prototype,"size",void 0),Y([Object(B.l)("")],e.prototype,"color",void 0),Y([Object(B.l)("Segoe UI")],e.prototype,"fontFamily",void 0),Y([Object(B.l)("Normal")],e.prototype,"fontWeight",void 0),Y([Object(B.l)("Normal")],e.prototype,"fontStyle",void 0),Y([Object(B.l)("Center")],e.prototype,"textAlignment",void 0),Y([Object(B.l)("Trim")],e.prototype,"textOverflow",void 0),e})(),U=(()=>{class e extends B.d{}return Y([Object(B.l)(10)],e.prototype,"left",void 0),Y([Object(B.l)(10)],e.prototype,"right",void 0),Y([Object(B.l)(10)],e.prototype,"top",void 0),Y([Object(B.l)(10)],e.prototype,"bottom",void 0),e})(),J=(()=>{class e extends B.d{}return Y([Object(B.l)("")],e.prototype,"color",void 0),Y([Object(B.l)(1)],e.prototype,"width",void 0),Y([Object(B.l)("")],e.prototype,"radius",void 0),e})(),$=(()=>{class e extends B.d{}return Y([Object(B.l)("")],e.prototype,"color",void 0),Y([Object(B.l)(0)],e.prototype,"width",void 0),e})(),Q=(()=>{class e extends B.d{}return Y([Object(B.l)(null)],e.prototype,"size",void 0),Y([Object(B.l)(null)],e.prototype,"color",void 0),e})(),q=(()=>{class e extends B.d{}return Y([Object(B.l)("")],e.prototype,"text",void 0),Y([Object(B.f)({},X)],e.prototype,"textStyle",void 0),e})(),K=(()=>{class e extends B.d{}return Y([Object(B.l)("#eeeeee")],e.prototype,"minColor",void 0),Y([Object(B.l)("#eeeeee")],e.prototype,"maxColor",void 0),e})(),Z=(()=>{class e extends B.d{}return Y([Object(B.l)(null)],e.prototype,"value",void 0),Y([Object(B.l)(null)],e.prototype,"color",void 0),Y([Object(B.l)(null)],e.prototype,"label",void 0),Y([Object(B.l)(null)],e.prototype,"startValue",void 0),Y([Object(B.l)(null)],e.prototype,"endValue",void 0),Y([Object(B.l)(null)],e.prototype,"minColor",void 0),Y([Object(B.l)(null)],e.prototype,"maxColor",void 0),e})(),ee=(()=>{class e extends B.d{}return Y([Object(B.l)("#b5b5b5")],e.prototype,"color",void 0),Y([Object(B.l)(1)],e.prototype,"width",void 0),Y([Object(B.l)("Rectangle")],e.prototype,"type",void 0),e})(),te=(()=>{class e extends B.d{}return Y([Object(B.l)("0%")],e.prototype,"minimum",void 0),Y([Object(B.l)("100%")],e.prototype,"maximum",void 0),e})(),ie=(()=>{class e extends B.d{}return Y([Object(B.l)(null)],e.prototype,"start",void 0),Y([Object(B.l)(null)],e.prototype,"end",void 0),Y([Object(B.l)("")],e.prototype,"text",void 0),Y([Object(B.l)(null)],e.prototype,"maximumTextWidth",void 0),e})(),le=(()=>{class e extends B.d{}return Y([Object(B.l)("Center")],e.prototype,"alignment",void 0),Y([Object(B.l)("Wrap")],e.prototype,"overflow",void 0),Y([Object(B.f)(N.axisLabelFont,X)],e.prototype,"textStyle",void 0),Y([Object(B.f)({color:"#b5b5b5",width:1,type:"Rectangle"},ee)],e.prototype,"border",void 0),Y([Object(B.e)([],ie)],e.prototype,"categories",void 0),e})();class ae{constructor(e,t,i,l,a,s,n){this.value=e,this.color=t,this.label=i,this.startValue=l,this.endValue=a,this.minColor=s,this.maxColor=n}}class se{constructor(e,t,i){this.mappingName=e,this.bubbleData=t,this.valueType=i}}class ne{constructor(e,t,i,l,a,s,n,o){this.value=e,this.color=t,this.label=i,this.startValue=l,this.endValue=a,this.minColor=s,this.maxColor=n,this.isHidden=o}}class oe{constructor(e,t,i,l,a){this.index=1,this.row=1,this.start=e,this.end=t,this.index=i,this.label=l,this.row=a}}var he=function(e,t,i,l){var a,s=arguments.length,n=s<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,l);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(s<3?a(n):s>3?a(t,i,n):a(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let re=(()=>{class e extends B.d{}return he([Object(B.e)([{}],Z)],e.prototype,"palette",void 0),he([Object(B.l)("Gradient")],e.prototype,"type",void 0),he([Object(B.l)("")],e.prototype,"emptyPointColor",void 0),he([Object(B.l)("Table")],e.prototype,"colorGradientMode",void 0),he([Object(B.f)({},K)],e.prototype,"fillColor",void 0),e})();class de{constructor(e,t,i){this.R=e,this.G=t,this.B=i}}class ce{constructor(e){this.heatMap=e}convertToRGB(e,t){let i,l,a=this.heatMap.isColorRange?t[0].startValue:t[0].value,s=0,n=0;if(this.heatMap.isColorRange&&"Gradient"===this.heatMap.paletteSettings.type)for(n=0;n<t.length;n++){const o=Number(t[n].endValue);if(e<=o&&e>=Number(t[n].startValue)){s=o,i=this.heatMap.colorCollection[n].minColor,l=this.heatMap.colorCollection[n].maxColor;break}if(t[0].startValue!==this.heatMap.dataSourceMinValue&&e<t[0].startValue){s=t[0].startValue,a=this.heatMap.dataSourceMinValue,i=this.heatMap.paletteSettings.fillColor.minColor,l=this.heatMap.paletteSettings.fillColor.maxColor;break}if(e>o&&e<=(n===t.length-1?this.heatMap.dataSourceMaxValue:t[n+1].startValue)){s=n===t.length-1?this.heatMap.dataSourceMaxValue:t[n+1].startValue,a=o,i=this.heatMap.paletteSettings.fillColor.minColor,l=this.heatMap.paletteSettings.fillColor.maxColor;break}s=o,a=o}else for(n=1;n<t.length;n++){const o=Number(t[n].value);if(e<=o){s=o,i=this.getEqualColor(t,a),l=this.getEqualColor(t,s);break}s=o,a=o}let o=0;return o=(e-a)/(s-a),o=isNaN(o)?0:o,this.getPercentageColor(o,i,l)}rgbToHex(e,t,i){return"#"+this.componentToHex(e)+this.componentToHex(t)+this.componentToHex(i)}componentToHex(e){const t=e.toString(16);return 1===t.length?"0"+t:t}getEqualColor(e,t){for(let i=0;i<e.length;i++)if(Number(e[i].value)===t){let t=e[i].color;return-1!==t.indexOf("rgb")?t=this.convertToHex(t):-1===t.indexOf("#")&&(t="#FFFFFF"),t}return"#00000"}convertToHex(e){let t=e.substr(3);t=t.split("(")[1].split(")")[0];const i=t.split(",");return t=this.rgbToHex(parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)),t}getPercentageColor(e,t,i){const l=i.split("#")[1],a=t.split("#")[1],s=this.getPercentage(e,parseInt(a.substr(0,2),16),parseInt(l.substr(0,2),16)),n=this.getPercentage(e,parseInt(a.substr(2,2),16),parseInt(l.substr(2,2),16)),o=this.getPercentage(e,parseInt(a.substr(4,2),16),parseInt(l.substr(4,2),16));return new de(s,n,o)}getPercentage(e,t,i){return Math.round(t+(i-t)*e)}getColorCollection(){const e=this.heatMap;let t;e.colorCollection=[],e.legendColorCollection=[];for(let s=0;s<this.heatMap.paletteSettings.palette.length;s++){if(null===this.heatMap.paletteSettings.palette[s].startValue||null===this.heatMap.paletteSettings.palette[s].endValue){this.heatMap.isColorRange=!1;break}this.heatMap.isColorRange=!0}const i=e.bubbleSizeWithColor?e.minColorValue:e.dataSourceMinValue,l=e.bubbleSizeWithColor?e.maxColorValue:e.dataSourceMaxValue;e.emptyPointColor=e.paletteSettings.emptyPointColor?e.paletteSettings.emptyPointColor:e.themeStyle.emptyCellColor;const a=this.orderbyOffset(this.heatMap.isColorRange||e.paletteSettings.palette&&e.paletteSettings.palette.length>1?e.paletteSettings.palette:e.themeStyle.palette);if(a.isCompact)e.colorCollection=a.offsets,e.legendColorCollection=Object(B.q)([],a.offsets,null,!0);else if(t="Gradient"===e.paletteSettings.type?(l-i)/(a.offsets.length-1):(l-i)/a.offsets.length,a.offsets.length>=2)for(let s=0;s<a.offsets.length;s++)e.colorCollection.push(new ae(Math.round(100*(i+s*t))/100,a.offsets[s].color,a.offsets[s].label,a.offsets[s].startValue,a.offsets[s].endValue,a.offsets[s].minColor,a.offsets[s].maxColor)),e.legendColorCollection.push(new ne(Math.round(100*(i+s*t))/100,a.offsets[s].color,a.offsets[s].label,a.offsets[s].startValue,a.offsets[s].endValue,a.offsets[s].minColor,a.offsets[s].maxColor,!1));this.heatMap.isColorRange||this.updateLegendColorCollection(i,l,a)}updateLegendColorCollection(e,t,i){"Fixed"===this.heatMap.paletteSettings.type&&(i.isCompact||i.isLabel)||(Math.round(100*e)/100<this.heatMap.legendColorCollection[0].value&&this.heatMap.legendColorCollection.unshift(new ne(Math.round(100*e)/100,this.heatMap.legendColorCollection[0].color,this.heatMap.legendColorCollection[0].label,this.heatMap.legendColorCollection[0].startValue,this.heatMap.legendColorCollection[0].endValue,this.heatMap.legendColorCollection[0].minColor,this.heatMap.legendColorCollection[0].maxColor,!0)),Math.round(100*t)/100>this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].value&&this.heatMap.legendColorCollection.push(new ne(Math.round(100*t)/100,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].color,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].label,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].startValue,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].endValue,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].minColor,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].maxColor,!0)))}orderbyOffset(e){const t=new He,i=this.heatMap.isColorRange?"to":"value";return t.isCompact=!0,t.isLabel=!0,t.offsets=e.sort((e,l)=>(Object(B.u)(e.label)&&Object(B.u)(l.label)&&(t.isLabel=!1),Object(B.u)(e[i])||Object(B.u)(l[i])?(t.isCompact=!1,e):e[i]-l[i])),t.isCompact||(t.offsets=this.heatMap.paletteSettings.palette&&this.heatMap.paletteSettings.palette.length>1?this.heatMap.paletteSettings.palette:this.heatMap.themeStyle.palette),t}getColorByValue(e){let t,i="",l=0;if(""!==e.toString())if("Bubble"!==this.heatMap.cellSettings.tileType||"Size"!==this.heatMap.cellSettings.bubbleType&&"Sector"!==this.heatMap.cellSettings.bubbleType)if("Fixed"===this.heatMap.paletteSettings.type)for(let a=0;a<this.heatMap.colorCollection.length;a++){l=this.heatMap.isColorRange?this.heatMap.paletteSettings.palette[a].startValue:this.heatMap.colorCollection[a+1]?this.heatMap.colorCollection[a+1].value:this.heatMap.colorCollection[a].value;const t=this.heatMap.dataSourceMinValue===this.heatMap.dataSourceMaxValue;if(this.heatMap.isColorRange){let t;if(e<=this.heatMap.colorCollection[a].endValue&&e>=this.heatMap.colorCollection[a].startValue){this.heatMap.legendVisibilityByCellType&&(t=this.heatMap.legendModule.legendRange),i=this.heatMap.legendVisibilityByCellType&&t[a]&&!t[a].visible?this.heatMap.themeStyle.toggledColor:this.heatMap.colorCollection[a].minColor;break}i=this.heatMap.paletteSettings.fillColor.minColor}else if(e<=l&&t&&0===a||e<l||e>=l&&a===this.heatMap.colorCollection.length-1){let e;this.heatMap.legendVisibilityByCellType&&(e=this.heatMap.legendModule.legendRange),i=this.heatMap.legendVisibilityByCellType&&e[a]&&!e[a].visible?this.heatMap.themeStyle.toggledColor:this.heatMap.colorCollection[a].color;break}}else"Table"!==this.heatMap.paletteSettings.colorGradientMode&&this.getColorCollection(),e<this.heatMap.colorCollection[0].value&&!this.heatMap.isColorRange?i=this.heatMap.colorCollection[0].color:e>this.heatMap.colorCollection[this.heatMap.colorCollection.length-1].value&&!this.heatMap.isColorRange?i=this.heatMap.colorCollection[this.heatMap.colorCollection.length-1].color:(t=this.convertToRGB(e,this.heatMap.colorCollection),i=this.rgbToHex(t.R,t.G,t.B));else i=this.heatMap.isColorRange?this.heatMap.colorCollection[0].minColor:this.heatMap.colorCollection[0].color;else i=this.heatMap.emptyPointColor;return i}}function pe(e,t){return null!=e?-1!==e.indexOf("%")?t/100*parseInt(e,10):parseInt(e,10):null}function ge(e,t){let i=document.getElementById("heatmapmeasuretext");return null===i&&(i=Object(B.p)("text",{id:"heatmapmeasuretext"}),document.body.appendChild(i)),i.innerText=e,i.style.position="absolute",i.style.visibility="hidden",i.style.fontSize=-1!==t.size.indexOf("px")?t.size:t.size+"px",i.style.fontWeight=t.fontWeight,i.style.fontStyle=t.fontStyle,i.style.fontFamily=t.fontFamily,i.style.top="-100",i.style.left="0",i.style.whiteSpace="nowrap",i.style.lineHeight="normal",new be(i.clientWidth,i.clientHeight)}function ue(e,t,i,l){let a;return a="Near"===l.textAlignment?t:"Center"===l.textAlignment?t+e/2:e+t,a}class be{constructor(e,t){this.width=e,this.height=t}}class me extends class{constructor(e){this.id=e}}{constructor(e,t,i,l,a,s,n){super(e),this.opacity=a,this.fill=t,this.stroke=l||"",this["stroke-width"]=parseFloat(i.toString()),this["stroke-dasharray"]=s,this.d=n}}class xe{constructor(e,t,i,l,a,s,n,o,h,r,d,c,p,g){this.x=e,this.y=t,this.width=i,this.height=l,this.value=a,this.id=s,this.xIndex=n,this.yIndex=o,this.xValue=h,this.yValue=r,this.visible=d,this.displayText=c,this.textId=p,this.allowCollection=g}}class Se{constructor(e,t,i,l,a,s,n,o,h,r,d,c){this.value=e,this.xLabel=t,this.yLabel=i,this.xValue=l,this.yValue=a,this.cellElement=s,this.xPosition=n,this.yPosition=o,this.width=h,this.height=r,this.x=d,this.y=c}}class Ce extends me{constructor(e,t,i,l,a,s,n,o,h,r){super(e,t,i.width,s,l,r),this.y=a.y,this.x=a.x,this.height=a.height>0?a.height:0,this.width=a.width>0?a.width:0,this.rx=n||0,this.ry=o||0,this.transform=h||""}}class ye extends me{constructor(e,t,i,l,a,s,n,o){super(e,t,i.width,a,l),this.cx=s||0,this.cy=n||0,this.r=o||0}}class Me{constructor(e,t,i,l){this.x=e,this.y=t,this.width=i,this.height=l}}class ve extends class{constructor(e,t){this["font-size"]=e.size,this["font-style"]=e.fontStyle.toLowerCase(),this["font-family"]=e.fontFamily,this["font-weight"]=e.fontWeight.toLowerCase(),this.fill=t||""}}{constructor(e,t,i,l){super(i,l),this.transform="",this["dominant-baseline"]="auto",this.labelRotation=0,this.baseline="auto",this.id=e,this.x=t.x,this.y=t.y,this["text-anchor"]=t["text-anchor"],this.text=t.text,this.transform=t.transform,this.labelRotation=t.labelRotation,this["dominant-baseline"]=t["dominant-baseline"],this.baseline=t.baseline,this.dy=t.dy}}class fe{constructor(e,t,i,l,a,s,n,o){this.transform="",this["dominant-baseline"]="auto",this.labelRotation=0,this.baseline="auto",this.x=e||0,this.y=t||0,this["text-anchor"]=i||"start",this.text=l||"",this.transform=s||"",this.labelRotation=a,this["dominant-baseline"]=n||"auto",this.baseline=n||"",this.dy=o||""}}class we{constructor(e,t,i,l){this.x1=e,this.y1=t,this.x2=i,this.y2=l}}class Re extends me{constructor(e,t,i,l,a,s){super(e,null,l,i,a,s,null),this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2}}class Le extends me{constructor(e,t,i,l,a,s,n){super(e,i,a,n,s,null),this.d=t.d,this.x=t.x,this.y=t.y}}class Te{constructor(e,t,i,l,a,s,n,o,h,r,d,c){this.d=e,this.innerR=t,this.cx=n,this.cy=o,this.x=i,this.y=l,this.x1=a,this.y1=s,this.start=h,this.end=r,this.radius=d,this.counterClockWise=c}}function Oe(e){let t=0;for(const i of e)t+=i;return t}function je(e,t,i){const l=new H.e("heatmapMeasureRotateText"),a=l.createSvg({id:"heatmapMeasureRotateText_svg",width:100,height:100}),s={"font-size":e.size,"font-style":e.fontStyle.toLowerCase(),"font-family":e.fontFamily,"font-weight":e.fontWeight.toLowerCase(),transform:"rotate("+i+", 0, 0)","text-anchor":"middle"},n=l.createText(s,t);a.appendChild(n),document.body.appendChild(a);const o=n.getBoundingClientRect();return Object(B.z)(a),new be(o.right-o.left,o.bottom-o.top)}class Ae{constructor(e){this.heatMap=e}drawRectangle(e,t,i){this.heatMap.enableCanvasRendering?this.drawCanvasRectangle(this.heatMap.canvasRenderer,e,i):(delete e.d,t.appendChild(this.heatMap.renderer.drawRectangle(e)))}drawCircle(e,t){this.heatMap.enableCanvasRendering?this.drawCanvasCircle(this.heatMap.canvasRenderer,e):(delete e.d,t.appendChild(this.heatMap.renderer.drawCircle(e)))}drawPath(e,t,i){this.heatMap.enableCanvasRendering?this.drawCanvasPath(this.heatMap.canvasRenderer,e,t):(delete e.x,delete e.y,i.appendChild(this.heatMap.renderer.drawPath(e)))}createText(e,t,i){this.heatMap.enableCanvasRendering?this.canvasDrawText(e,i):(delete e.labelRotation,delete e.baseline,delete e.text,t.appendChild(this.heatMap.renderer.createText(e,i)),e.text=i)}createWrapText(e,t,i){let l,a,s,n={};n={id:e.id,x:e.x,y:e.y,fill:e.fill,"font-size":t.size,"font-style":t.fontStyle,"font-family":t.fontFamily,"font-weight":t.fontWeight.toLowerCase(),"text-anchor":e["text-anchor"],transform:e.transform,"dominant-baseline":e["dominant-baseline"]};const o=e.text[0];if(this.heatMap.enableCanvasRendering?this.heatMap.canvasRenderer.createText(e,o):l=this.heatMap.renderer.createText(n,o),"string"!=typeof e.text&&e.text.length>1)for(let h=1,r=e.text.length;h<r;h++)s=ge(e.text[h],t).height,this.heatMap.enableCanvasRendering?(e.id=e.id+h,e.y+=s,this.heatMap.canvasRenderer.createText(e,e.text[h])):(a=this.heatMap.renderer.createTSpan({x:e.x,id:e.id+h,y:e.y+h*s},e.text[h]),l.appendChild(a));this.heatMap.enableCanvasRendering||i.appendChild(l)}drawLine(e,t){this.heatMap.enableCanvasRendering?this.heatMap.canvasRenderer.drawLine(e):(delete e.d,t.appendChild(this.heatMap.renderer.drawLine(e)))}canvasDrawText(e,t,i,l){const a=this.heatMap.canvasRenderer.ctx;i||(i=e.x),l||(l=e.y);let s=this.getOptionValue(e,"font-weight");Object(B.u)(s)||"regular"!==s.toLowerCase()||(s="normal");const n=this.getOptionValue(e,"font-family"),o=-1===e["font-size"].toString().indexOf("px")?e["font-size"]+"px":e["font-size"];let h=this.getOptionValue(e,"text-anchor");const r=this.getOptionValue(e,"font-style").toLowerCase()+" "+s+" "+o+" "+n;"middle"===h&&(h="center"),a.save(),a.fillStyle=e.fill,a.font=r,a.textAlign=h,e.baseline&&(a.textBaseline=e.baseline),a.translate(i,l),a.rotate(e.labelRotation*Math.PI/180),a.fillText(t,e.x-i,e.y-l),a.restore()}getOptionValue(e,t){return e[t]}setAttributes(e,t){e.ctx.lineWidth=t["stroke-width"];const i=t["stroke-dasharray"];if(!Object(B.u)(i)){const t=i.split(",");e.ctx.setLineDash([parseInt(t[0],10),parseInt(t[1],10)])}e.ctx.strokeStyle=t.stroke}drawCanvasRectangle(e,t,i){const l=e.ctx;e.ctx.save(),e.ctx.beginPath(),e.ctx.globalAlpha=t.opacity,this.setAttributes(e,t),this.drawCornerRadius(e,t),(t["stroke-width"]&&0!==t["stroke-width"]||i)&&e.ctx.stroke(),e.ctx.restore(),e.ctx=l}drawCornerRadius(e,t){let i=t.rx;const l=t.x,a=t.y,s=t.width,n=t.height;"none"===t.fill&&(t.fill="transparent"),e.ctx.fillStyle=t.fill,s<2*i&&(i=s/2),n<2*i&&(i=n/2),e.ctx.beginPath(),e.ctx.moveTo(l+s-i,a),e.ctx.arcTo(l+s,a,l+s,a+n,i),e.ctx.arcTo(l+s,a+n,l,a+n,i),e.ctx.arcTo(l,a+n,l,a,i),e.ctx.arcTo(l,a,l+s,a,i),e.ctx.closePath(),e.ctx.fill()}drawCanvasCircle(e,t){e.ctx.save(),e.ctx.beginPath(),e.ctx.arc(t.cx,t.cy,t.r,0,2*Math.PI),e.ctx.fillStyle=t.fill,e.ctx.globalAlpha=t.opacity,e.ctx.fill(),this.setAttributes(e,t),t["stroke-width"]&&0!==t["stroke-width"]&&e.ctx.stroke(),e.ctx.restore()}drawCanvasPath(e,t,i){const l=t.d.split(" ");e.ctx.save(),e.ctx.beginPath(),e.ctx.globalAlpha=t.opacity,e.ctx.fillStyle=t.fill,this.setAttributes(e,t);for(let a=0;a<l.length;a+=3){const t=parseFloat(l[a+1]),s=parseFloat(l[a+2]);switch(l[a]){case"M":e.ctx.moveTo(t,s);break;case"L":e.ctx.lineTo(t,s);break;case"A":case"a":e.ctx.arc(i.x,i.y,i.radius,.0174533*i.start,.0174533*i.end,!1),a="a"===l[a]?a+13:a+5;break;case"Z":e.ctx.closePath()}}e.ctx.fill(),t["stroke-width"]&&0!==t["stroke-width"]&&e.ctx.stroke(),e.ctx.restore()}}function Ie(e,t,i){let l=[];switch(t.textOverflow){case"Wrap":l=Ve(e,i,t);break;case"Trim":l.push(De(i,e,t));break;default:l.push(function(e,t,i){let l=t,a=ge(t,i).width;if(a>e)for(let s=t.length-1;s>=0;--s)if(l=t.substring(0,s),a=ge(l,i).width,a<=e)return l;return l}(i,e,t))}return l}function Ve(e,t,i){const l=e.split(" ");let a="";const s=[];let n;for(let o=0,h=l.length;o<h;o++)n=l[o],ge(a.concat(n),i).width<t?a=a.concat((""===a?"":" ")+n):""!==a?(s.push(De(t,a,i)),a=n):(s.push(De(t,n,i)),n=""),a&&o===h-1&&s.push(De(t,a,i));return s}function De(e,t,i){let l=t,a=ge(t,i).width;if(a>e)for(let s=t.length-1;s>=0;--s)if(l=t.substring(0,s)+"...",a=ge(l,i).width,a<=e)return l;return l}class ze{constructor(e,t,i,l,a){this.id=e,this.x1=t,this.x2=i,this.y1=l,this.y2=a}}class Pe{constructor(e,t){this.color=e,this.colorStop=t}}function Ee(e,t,i,l,a,s,n,o){let h=document.getElementById(a);const r=ge(e,{fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"Regular"}),d=r.width+5;t=(t=t+d>l?t-d:t)<0?5:t,h?(h.innerText=e,h.style.top=(i+15).toString()+"px",h.style.left=(t+15).toString()+"px"):(h=Object(B.p)("div",{id:a,styles:"top:"+(i+15).toString()+"px;left:"+(t+15).toString()+"px;background-color: rgb(255, 255, 255) !important; color:black !important; position:absolute;border:1px solid rgb(112, 112, 112); padding-left : 3px; padding-right : 2px;padding-bottom : 2px; padding-top : 2px; font-size:12px; font-family: Segoe UI"}),h.innerText=e,s.appendChild(h)),e===o.titleSettings.text?h.style.width=t+15+r.width+7>o.availableSize.width?(o.availableSize.width-(t+15)).toString()+"px":"":(h.style.left=t+15+r.width+7>o.availableSize.width?(o.availableSize.width-(r.width+7)).toString()+"px":t.toString()+"px",h.style.top=i+15+r.height+6>o.availableSize.height?(i-(r.height+6)-10).toString()+"px":h.style.top),n&&setTimeout(()=>{_e(a)},1500)}function _e(e){const t=Be(e);t&&Object(B.z)(t)}function Be(e){return document.getElementById(e)}function Ge(e,t,i,l){const a=new Date(e);switch(t=Math.ceil(t*l),i){case"Years":a.setFullYear(a.getFullYear()+t);break;case"Months":a.setMonth(a.getMonth()+t);break;case"Days":a.setDate(a.getDate()+t);break;case"Hours":a.setHours(a.getHours()+t);break;case"Minutes":a.setMinutes(a.getMinutes()+t)}return a}class Fe{constructor(e,t){this.region=new Me(0,0,0,0),this.text=e,this.region=t}}function Ne(e,t,i){const l=e.length;let a,s,n;for(let o=0;o<l;o++)if(a=e[o],s=a.region,t>=s.x&&t<=s.x+s.width&&i>=s.y&&i<=s.y+s.height){n=a.text;break}return n}class He{}class ke{constructor(e,t,i,l,a,s){this.pathX1=e,this.pathY1=t,this.pathX2=i,this.pathY2=l,this.pathX3=a,this.pathY3=s}}class We{constructor(e,t,i,l,a,s){this.x=e,this.y=t,this.width=i,this.height=l,this.label=a,this.id=s}}class Ye{constructor(e,t,i,l,a,s,n){this.x=e,this.y=t,this.width=i,this.height=l,this.value=a,this.visible=s,this.currentPage=n}}class Xe{constructor(e,t,i,l){this.visible=e,this.value=t,this.startValue=i,this.endValue=l}}function Ue(e){const t=e.toString(16);return 1===t.length?"0"+t:t}function Je(e,t,i,l){return e?t.replace("{value}",l(i)):l(i)}class $e{constructor(e,t){this.x=e,this.y=t}}var Qe=function(e,t,i,l){var a,s=arguments.length,n=s<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,l);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(s<3?a(n):s>3?a(t,i,n):a(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let qe=(()=>{class e extends B.d{constructor(){super(...arguments),this.multipleRow=[],this.rect=new Me(void 0,void 0,0,0),this.nearSizes=[],this.farSizes=[],this.maxLabelSize=new be(0,0),this.titleSize=new be(0,0),this.multilevel=[],this.axisLabels=[],this.tooltipLabels=[],this.labelValue=[],this.axisLabelSize=0,this.axisLabelInterval=0,this.dateTimeAxisLabelInterval=[],this.maxLength=0,this.min=0,this.max=0,this.isIntersect=!1,this.jsonCellLabel=[],this.multiLevelSize=[],this.xAxisMultiLabelHeight=[],this.yAxisMultiLabelHeight=[],this.multiLevelPosition=[]}computeSize(e,t,i){let l=new be(0,0);this.titleSize=e.getTitleSize(e,10),this.maxLabelSize=e.getMaxLabelSize(e,t),this.getMultilevelLabelsHeight(e,i,t);for(let a=0;a<this.multiLevelLabels.length;a++)l=e.multiLevelLabelSize(10,a),this.multiLevelSize.push(l)}multiPosition(e,t){const i="Horizontal"===e.orientation?10:20,l=new $e(0,0);if("Horizontal"===e.orientation){const a=e.maxLabelSize.height+i,s=this.xAxisMultiLabelHeight[t-1];l.x=e.isInversed?e.rect.x+e.rect.width:e.rect.x,l.y=0===t?e.rect.y+(e.opposedPosition?-a:a):e.multiLevelPosition[t-1].y+(e.opposedPosition?-s:s)}else{const a=e.maxLabelSize.width+i,s=0!==t&&this.multiLevelSize[t-1].width;l.x=0===t?e.rect.x-(e.opposedPosition?-a:a):e.multiLevelPosition[t-1].x-(e.opposedPosition?-(s+i):s+i),l.y=e.isInversed?e.rect.y:e.rect.y+e.rect.height}return l}multiLevelLabelSize(e,t){const i=new be(0,0),l=this.multiLevelLabels,a=l[t].categories;for(let n=0;n<a.length;n++){const e=ge(a[n].text,l[t].textStyle);i.width=i.width>e.width?i.width:e.width,i.height=i.height>e.height?i.height:e.height}const s="Horizontal"===this.orientation?this.xAxisMultiLabelHeight[t]:this.yAxisMultiLabelHeight[t];return this.opposedPosition?this.farSizes.push(s):this.nearSizes.push(s),i}getMultilevelLabelsHeight(e,t,i){let l,a,s;const n=[];let o,h,r,d;const c="Vertical"===e.orientation,p="Vertical"===e.orientation?20:10;this.multiLevelLabels.map((g,u)=>{g.categories.map(b=>{o="number"==typeof b.start?b.start:Number(new Date(b.start)),h="number"==typeof b.end?b.end:Number(new Date(b.end)),""!==b.text&&null!==b.start&&null!==b.end&&(l=ge(b.text,g.textStyle),s=c?l.width:l.height,r=i.heatMapAxis.calculateLeftPosition(e,o,b.start,t),d=i.heatMapAxis.calculateWidth(e,b.end,h,t),l=ge(b.text,g.textStyle),a=null===b.maximumTextWidth?Math.abs(d-r):b.maximumTextWidth,l.width>a-p&&"Wrap"===g.overflow&&!c&&(s*=Ve(b.text,a-p,g.textStyle).length),n[u]=n[u]?n[u]<s?s+p:n[u]:s+p)})}),c?this.yAxisMultiLabelHeight=n:this.xAxisMultiLabelHeight=n}getTitleSize(e,t){let i=new be(0,0);return this.title.text&&(i=ge(this.title.text,this.title.textStyle),i.height+=t),e.opposedPosition?this.farSizes.push(i.height):this.nearSizes.push(i.height),i}getMaxLabelSize(e,t){const i=new be(0,0),l=this.axisLabels,a=e.border.width>0||e.multiLevelLabels.length>0?10:0;let s=1;const n="DateTime"===e.valueType&&"None"!==e.showLabelOn?t.initialClipRect.width/e.axisLabelSize:t.initialClipRect.width/e.axisLabels.length;if(e.angle=e.labelRotation,e.isIntersect=!1,"Horizontal"===e.orientation&&("Rotate45"===e.labelIntersectAction||e.labelRotation%180==0&&"Trim"===e.labelIntersectAction||e.enableTrim)||"MultipleRows"===e.labelIntersectAction){let i,a,o=t.initialClipRect.x+(e.isInversed?t.initialClipRect.width:0);this.clearMultipleRow();for(let h=0,r=l.length;h<r;h++){const r=l[h],d=ge(r,e.textStyle),c="DateTime"===e.valueType&&"None"!==e.showLabelOn?e.dateTimeAxisLabelInterval[h]*n:n;let p=o+(e.isInversed?-(n+d.width)/2:(n-d.width)/2);p=p<t.initialClipRect.x?t.initialClipRect.x:p;const g=p+d.width;if(e.isInversed){if(Object(B.u)(a))a=p;else if(a<g&&"MultipleRows"!==e.labelIntersectAction){"Rotate45"!==e.labelIntersectAction||e.enableTrim?e.isIntersect=!0:e.angle=45;break}a=p}else{if(Object(B.u)(i))i=g;else if(p<i&&"MultipleRows"!==e.labelIntersectAction){"Rotate45"!==e.labelIntersectAction||e.enableTrim?e.isIntersect=!0:e.angle=45;break}i=g}o+=e.isInversed?-c:c,"Horizontal"===e.orientation&&"MultipleRows"===e.labelIntersectAction&&0===e.labelRotation&&this.multipleRow.push(new oe(p,g,s,r,1))}"Horizontal"===e.orientation&&"MultipleRows"===e.labelIntersectAction&&e.isInversed&&(this.multipleRow=this.multipleRow.reverse())}for(let o=0;o<l.length;o++){const a=this.multipleRow;let h;h=e.enableTrim?De(e.maxLabelLength,l[o],e.textStyle):l[o];const r=e.angle%180==0?ge(h,e.textStyle):je(e.textStyle,l[o],e.angle);if(i.width=i.width>r.width?i.width:r.width,"MultipleRows"===e.labelIntersectAction&&"Horizontal"===e.orientation&&o>0&&0===e.labelRotation){a[o].end>=t.initialClipRect.width&&o<l.length-1&&(a[o].row=a[o].row+1);for(let t=1;t<=e.multilevel.length;t++)if(a[o].start<a[o-1].end){if(e.multilevel[t]<a[o].start){s=t;break}if(t===e.multilevel.length-1){s=e.multilevel.length;break}}else if(r.width<n)for(let i=1;i<=e.multilevel.length;i++)if(e.multilevel[i]<a[o].start){s=i,a[i].row=s;break}i.height=i.height>r.height*s+.5*r.height/2*(s-1)?i.height:r.height*s+.5*r.height/2*s,this.multipleRow[o].index=s,e.multilevel[s]=a[o].end}else"Horizontal"===e.orientation&&"MultipleRows"===e.labelIntersectAction&&0===o&&0===e.labelRotation&&(e.multilevel[1]=a[o].end),i.height=i.height>r.height?i.height:r.height}return t.cellSettings.border.width>=20&&"Horizontal"!==e.orientation&&(i.width=i.width+t.cellSettings.border.width/4),e.opposedPosition?this.farSizes.push("Horizontal"===e.orientation?i.height:i.width+a):this.nearSizes.push("Horizontal"===e.orientation?i.height:i.width+a),i}calculateNumericAxisLabels(e){let t=0,i=0;const l=this.interval?this.interval:1;let a,s,n;e.adaptorModule&&e.isCellData&&(a="Horizontal"===this.orientation?e.adaptorModule.adaptiveXMinMax.min:e.adaptorModule.adaptiveYMinMax.min,s="Horizontal"===this.orientation?e.adaptorModule.adaptiveXMinMax.max:e.adaptorModule.adaptiveYMinMax.max),t=Object(B.u)(this.minimum)?a||0:this.minimum,i=Object(B.u)(this.maximum)?s||this.maxLength*this.increment:this.maximum,this.minimum&&this.maximum&&t>i&&(n=t,t=i,i=n),i=Object(B.u)(this.maximum)?s||i+t:i;const o=this.labelFormat,h=null!==o.match("{value}");this.format=e.intl.getNumberFormat({format:h?"":o});for(let r=t;r<=i;r+=l*this.increment){const e=Je(h,o,r,this.format);this.axisLabels.push(e)}this.min=0,this.axisLabelSize=Math.floor((i-t)/this.increment+1),this.max=this.axisLabelSize-1,this.axisLabelInterval=l;for(let r=t;r<=i;r+=this.increment){const e=Je(h,o,r,this.format);this.tooltipLabels.push(e),this.labelValue.push(r)}this.labelValue=this.isInversed?this.labelValue.reverse():this.labelValue}calculateCategoryAxisLabels(){let e=this.labels?this.labels:[];e=e.length>0?e:this.jsonCellLabel;let t=Object(B.u)(this.minimum)||this.minimum instanceof Date?0:this.minimum,i=Object(B.u)(this.maximum)||this.maximum instanceof Date?this.maxLength:this.maximum;const l=this.interval?this.interval:1;let a;if(!Object(B.u)(this.minimum)&&!Object(B.u)(this.maximum)&&t>i&&(a=t,t=i,i=a),e&&e.length>0)for(let s=t;s<=i;s+=l){const t=e[s]?e[s].toString():s.toString();this.axisLabels.push(t)}else for(let s=t;s<=i;s+=l)this.axisLabels.push(s.toString());for(let s=t;s<=i;s++)this.tooltipLabels.push(e[s]?e[s].toString():s.toString()),this.labelValue.push(e[s]?e[s].toString():s.toString());this.min=t,this.max=i,this.axisLabelSize=i-t+1,this.axisLabelInterval=l,this.labelValue=this.isInversed?this.labelValue.reverse():this.labelValue}calculateDateTimeAxisLabel(e){let t=this.interval?this.interval:1;const i={skeleton:"full",type:"dateTime"},l=e.intl.getDateParser(i),a=e.intl.getDateFormat(i);let s,n,o=null,h=null;e.adaptorModule&&e.isCellData&&(o="Horizontal"===this.orientation?e.adaptorModule.adaptiveXMinMax.min:e.adaptorModule.adaptiveYMinMax.min,h="Horizontal"===this.orientation?e.adaptorModule.adaptiveXMinMax.max:e.adaptorModule.adaptiveYMinMax.max);const r=this.minimum?this.minimum:o||null,d=this.maximum?this.maximum:h||null;if(null===r&&null===d){s=0,n=this.maxLength*this.increment;for(let e=s;e<=n;e+=t*this.increment)this.axisLabels.push(e.toString()),this.tooltipLabels.push(e.toString()),this.labelValue.push(e.toString());this.min=0,this.max=this.maxLength,this.axisLabelSize=(n-s)/this.increment+1,this.axisLabelInterval=t}else{null!==r&&null===d?(s=Date.parse(l(a(new Date(k.b.parse.parseJson({val:r}).val)))),n=Ge(s,this.maxLength,this.intervalType,this.increment).getTime()):null===r&&null!==d?(n=Date.parse(l(a(new Date(k.b.parse.parseJson({val:d}).val)))),s=Ge(n,-this.maxLength,this.intervalType,this.increment).getTime()):(s=Date.parse(l(a(new Date(k.b.parse.parseJson({val:r}).val)))),n=Date.parse(l(a(new Date(k.b.parse.parseJson({val:d}).val))))),this.format=e.intl.getDateFormat({format:this.labelFormat,skeleton:this.getSkeleton()});let i=s;for(;i<=n;){const e=this.format(new Date(i));this.axisLabels.push(e),"None"!==this.showLabelOn&&(t=this.calculateLabelInterval(i),this.dateTimeAxisLabelInterval.push(t)),i=Ge(i,t,this.intervalType,this.increment).getTime()}for(this.min=0,this.axisLabelInterval=t,this.axisLabelSize=this.getTotalLabelLength(s,n),this.max=this.axisLabelSize-1,i=s;i<=n;){const e=this.format(new Date(i));this.tooltipLabels.push(e),this.labelValue.push(new Date(i)),i=Ge(i,1,this.intervalType,this.increment).getTime()}}this.labelValue=this.isInversed?this.labelValue.reverse():this.labelValue}calculateLabelInterval(e){const t=new Date(e).getFullYear(),i=new Date(e).getMonth()+1,l=new Date(e).getDate();let a,s;if("Years"===this.showLabelOn||"Months"===this.showLabelOn)"Years"===this.showLabelOn&&"Months"===this.intervalType?s=Math.ceil(12/this.increment):(a="Years"===this.showLabelOn?t%4==0?366:365:new Date(t,i,0).getDate(),a+=1-l,s="Days"===this.intervalType?Math.ceil(a/this.increment):"Hours"===this.intervalType?Math.ceil(24*a/this.increment):"Minutes"===this.intervalType?Math.ceil(24*a*60/this.increment):1);else if("Days"===this.showLabelOn)s="Hours"===this.intervalType?Math.ceil(24/this.increment):"Minutes"===this.intervalType?Math.ceil(1440/this.increment):1;else if("Hours"===this.showLabelOn){const t=new Date(e).getMinutes();s="Minutes"===this.intervalType?Math.ceil((60-t)/this.increment):1}else s=1;return s}getSkeleton(){let e;return e="Years"===this.intervalType?"yMMM":"Months"===this.intervalType?"MMMd":"Days"===this.intervalType?"yMd":"Hours"===this.intervalType?"EHm":"Hms",e}getTotalLabelLength(e,t){let i=0;const l=new Date(e),a=new Date(t);let s,n;switch(this.intervalType){case"Years":const e=(a.getFullYear()-l.getFullYear())/this.increment+1;i=Math.floor(e);break;case"Months":let t=12*(a.getFullYear()-l.getFullYear());t-=l.getMonth(),t+=a.getMonth(),i=t<=0?1:Math.floor(t/this.increment+1);break;case"Days":s=Math.abs(l.getTime()-a.getTime()),n=Math.floor(s/864e5),i=Math.floor(n/this.increment+1);break;case"Hours":s=Math.abs(l.getTime()-a.getTime());const o=Math.floor(s/36e5);i=Math.floor(o/this.increment)+1;break;case"Minutes":s=Math.abs(l.getTime()-a.getTime());const h=Math.floor(s/6e4);i=Math.floor(h/this.increment)+1}return i}clearAxisLabel(){this.axisLabels=[],this.tooltipLabels=[],this.dateTimeAxisLabelInterval=[],this.labelValue=[]}clearMultipleRow(){this.multipleRow=[],this.multilevel=[]}}return Qe([Object(B.f)({text:"",textStyle:N.axisTitleFont},q)],e.prototype,"title",void 0),Qe([Object(B.l)(!1)],e.prototype,"opposedPosition",void 0),Qe([Object(B.l)(null)],e.prototype,"labels",void 0),Qe([Object(B.f)(N.axisLabelFont,X)],e.prototype,"textStyle",void 0),Qe([Object(B.l)(0)],e.prototype,"labelRotation",void 0),Qe([Object(B.l)(!1)],e.prototype,"isInversed",void 0),Qe([Object(B.l)("Category")],e.prototype,"valueType",void 0),Qe([Object(B.l)(1)],e.prototype,"increment",void 0),Qe([Object(B.l)("None")],e.prototype,"showLabelOn",void 0),Qe([Object(B.l)(null)],e.prototype,"minimum",void 0),Qe([Object(B.l)(null)],e.prototype,"maximum",void 0),Qe([Object(B.l)(null)],e.prototype,"interval",void 0),Qe([Object(B.l)("")],e.prototype,"labelFormat",void 0),Qe([Object(B.l)("Days")],e.prototype,"intervalType",void 0),Qe([Object(B.l)("Trim")],e.prototype,"labelIntersectAction",void 0),Qe([Object(B.l)(!1)],e.prototype,"enableTrim",void 0),Qe([Object(B.l)(35)],e.prototype,"maxLabelLength",void 0),Qe([Object(B.f)({color:"#b5b5b5",width:0,type:"Rectangle"},ee)],e.prototype,"border",void 0),Qe([Object(B.e)([],le)],e.prototype,"multiLevelLabels",void 0),e})();class Ke{constructor(e){this.heatMap=e,this.padding=10,this.drawSvgCanvas=new Ae(e)}renderAxes(){this.initialClipRect=this.heatMap.initialClipRect;const e=this.heatMap;let t,i;e.enableCanvasRendering||(t=this.heatMap.renderer.createGroup({id:e.element.id+"AxisCollection"}));const l=this.heatMap.axisCollections;for(let a=0,s=l.length;a<s;a++){const s=l[a];"Horizontal"===s.orientation?(e.enableCanvasRendering||(i=this.heatMap.renderer.createGroup({id:e.element.id+"XAxisGroup"})),this.drawXAxisLine(i,s),this.drawXAxisTitle(s,i,s.rect),this.drawXAxisLabels(s,i,s.rect)):(i=e.renderer.createGroup({id:e.element.id+"YAxisGroup"}),this.drawYAxisLine(i,s),this.drawYAxisTitle(s,i,s.rect),this.drawYAxisLabels(s,i,s.rect)),s.multiLevelLabels.length>0&&this.drawMultiLevels(i,s),e.enableCanvasRendering||t.appendChild(i)}e.enableCanvasRendering||this.heatMap.svgObject.appendChild(t)}drawXAxisLine(e,t){const i=this.initialClipRect.y+(t.opposedPosition?0:this.initialClipRect.height),l=new Re(this.heatMap.element.id+"_XAxisLine",new we(this.initialClipRect.x,i,this.initialClipRect.x+this.initialClipRect.width,i),"transparent",0);this.drawSvgCanvas.drawLine(l,e)}drawYAxisLine(e,t){const i=this.initialClipRect.x+(t.opposedPosition?this.initialClipRect.width:0),l=new Re(this.heatMap.element.id+"_YAxisLine",new we(i,this.initialClipRect.y,i,this.initialClipRect.height+this.initialClipRect.y),"transparent",0);this.drawSvgCanvas.drawLine(l,e)}drawXAxisTitle(e,t,i){const l="0px"===e.textStyle.size?0:10,a=i.y+(e.opposedPosition?-(e.maxLabelSize.height+l+Oe(e.xAxisMultiLabelHeight)):e.maxLabelSize.height+l+Oe(e.xAxisMultiLabelHeight));if(e.title.text){const l=this.heatMap,s=e.title,n=ge(s.text,s.textStyle);let o=this.padding;const h="Near"===s.textStyle.textAlignment?"start":"Far"===s.textStyle.textAlignment?"end":"middle";o=e.opposedPosition?-(o+n.height/4):o+3*n.height/4;const r=new ve(l.element.id+"_XAxisTitle",new fe(i.x+ue(i.width,0,0,s.textStyle),a+o,h,s.text),s.textStyle,s.textStyle.color||l.themeStyle.axisTitle);this.drawSvgCanvas.createText(r,t,s.text)}}drawYAxisTitle(e,t,i){if(e.title.text){const l=e.title,a=this.heatMap,s=e.opposedPosition?90:-90,n="Near"===l.textStyle.textAlignment?"start":"Far"===l.textStyle.textAlignment?"end":"middle";let o=10;o=e.opposedPosition?o:-o;const h=i.x+("0px"===e.textStyle.size?0:o)+(e.opposedPosition?e.maxLabelSize.width+Oe(e.yAxisMultiLabelHeight):-(e.maxLabelSize.width+Oe(e.yAxisMultiLabelHeight))),r=i.y+function(e,t,i,l){let a;return a="Near"===l.textAlignment?e.height-0:"Center"===l.textAlignment?e.height/2:0,a}(i,0,0,l.textStyle)+(e.opposedPosition?this.padding:-this.padding),d=new ve(a.element.id+"_YAxisTitle",new fe(h,r-this.padding,n,l.text,s,"rotate("+s+","+h+","+r+")","auto"),l.textStyle,l.textStyle.color||a.themeStyle.axisTitle);this.heatMap.enableCanvasRendering?this.drawSvgCanvas.canvasDrawText(d,l.text,h,r):this.drawSvgCanvas.createText(d,t,l.text)}}calculateVisibleLabels(){let e;const t=this.heatMap.axisCollections,i=this.heatMap.dataSourceSettings,l=!(i&&i.isJsonData&&"Cell"===i.adaptorType);for(let a=0,s=t.length;a<s;a++)e=t[a],"Numeric"===e.valueType&&l?(e.clearAxisLabel(),e.calculateNumericAxisLabels(this.heatMap)):"DateTime"===e.valueType&&l?(e.clearAxisLabel(),e.calculateDateTimeAxisLabel(this.heatMap)):"Category"===e.valueType&&(e.clearAxisLabel(),e.calculateCategoryAxisLabels()),e.tooltipLabels=e.isInversed?e.tooltipLabels.reverse():e.tooltipLabels}measureAxis(e){const t=this.heatMap;let i;const l=t.axisCollections;for(let a=l.length-1;a>=0;a--){i=l[a];const s="0px"===i.textStyle.size?0:this.padding;i.nearSizes=[],i.farSizes=[],i.computeSize(i,t,e),i.opposedPosition?"Horizontal"===i.orientation?(e.y+=Oe(i.farSizes)+s,e.height-=Oe(i.farSizes)+s):e.width-=Oe(i.farSizes)+s:"Horizontal"===i.orientation?e.height-=Oe(i.nearSizes)+s:(e.x+=Oe(i.nearSizes)+s,e.width-=Oe(i.nearSizes)+s)}}calculateAxisSize(e){const t=this.heatMap.axisCollections;for(let i=0,l=t.length;i<l;i++){const l=t[i];l.rect=Object(B.q)({},e,null,!0),"Horizontal"!==l.orientation||l.opposedPosition||(l.rect.y=e.y+e.height,l.rect.height=0),"Vertical"===l.orientation&&l.opposedPosition&&(l.rect.x=e.x+e.width,l.rect.width=0),l.multiLevelPosition=[];for(let e=0;e<l.multiLevelLabels.length;e++){const t=l.multiPosition(l,e);l.multiLevelPosition.push(t)}}}drawXAxisLabels(e,t,i){const l=this.heatMap;let a=e.axisLabels;const s=(i.width-(this.heatMap.cellSettings.border.width>5?this.heatMap.cellSettings.border.width/2:0))/e.axisLabelSize;let n,o=0,h=e.interval?e.interval:1,r=i.width/(e.axisLabelSize/e.axisLabelInterval),d=e.axisLabelInterval;if(r>0)for(;r<parseInt(e.textStyle.size,10);)d+=1,r=i.width/(e.axisLabelSize/d);else d=e.tooltipLabels.length;e.axisLabelInterval<d&&(o=d,a=e.tooltipLabels,h=d);let c,p,g,u=10,b=i.x+(e.isInversed?i.width:0),m=e.angle;u=this.padding,l.enableCanvasRendering||(p=this.heatMap.renderer.createGroup({id:l.element.id+"XAxisLabels"}),g=this.heatMap.renderer.createGroup({id:l.element.id+"XAxisLabelBorder"})),e.isInversed&&"MultipleRows"===e.labelIntersectAction&&e.multipleRow.reverse();for(let x=0,S=a.length;x<S;x++){const t=new Me(b,i.y,s,i.height);let r="Trim"===e.labelIntersectAction&&e.isIntersect?De("DateTime"!==e.valueType||"None"===e.showLabelOn?s*h:e.dateTimeAxisLabelInterval[x]*s,a[x],e.textStyle):a[x];r=e.enableTrim?De(e.maxLabelLength,a[x],e.textStyle):r;const d=ge(r,e.textStyle);let S;c=e.opposedPosition?-u:u+(m%360==0?d.height/2:0);let C=t.x+(e.isInversed?-(t.width/2+d.width/2):t.width/2-d.width/2);if("Trim"===e.labelIntersectAction?C=e.isInversed?C>b-s?C:b-s:C>=t.x?C:t.x:m%180==0&&(C=C<i.x?i.x:C,C=C+d.width>i.x+i.width?i.x+i.width-d.width:C),"MultipleRows"===e.labelIntersectAction&&0===e.labelRotation){const t=e.opposedPosition?-(e.multipleRow[x].index-1):e.multipleRow[x].index-1;n=e.multipleRow[x].index>1?i.y+c+d.height*t+(e.opposedPosition?-.5*d.height/2*e.multipleRow[x].index:.5*d.height/2*e.multipleRow[x].index):i.y+c+(e.opposedPosition?-.5*d.height/2:.5*d.height/2)}else n=i.y+c;if(this.drawXAxisBorder(e,g,e.rect,C,d.width,x),m%360!=0){m=m>360?m%360:m;const i=je(e.textStyle,r,m);C=t.x+(e.isInversed?-t.width/2:t.width/2),n+=e.opposedPosition?-i.height/2:m%360==180||m%360==-180?0:i.height/2,S="rotate("+m+","+C+","+n+")"}this.heatMap.cellSettings.border.width>5&&e.opposedPosition&&(n-=this.heatMap.cellSettings.border.width/2),this.heatMap.yAxis.opposedPosition&&this.heatMap.cellSettings.border.width>5&&(C+=this.heatMap.cellSettings.border.width/2),this.heatMap.xAxis.isInversed&&this.heatMap.cellSettings.border.width>5&&(C-=this.heatMap.cellSettings.border.width/2);const y=new ve(l.element.id+"_XAxis_Label"+x,new fe(C,n,m%360==0?"start":"middle",r,m,S),e.textStyle,e.textStyle.color||l.themeStyle.axisLabel);if(0!==m&&this.heatMap.enableCanvasRendering?this.drawSvgCanvas.canvasDrawText(y,r):this.drawSvgCanvas.createText(y,p,r),0===o){const t="DateTime"===e.valueType&&"None"!==e.showLabelOn?e.dateTimeAxisLabelInterval[x]:e.axisLabelInterval;b+=e.isInversed?-t*s:t*s}else b+=e.isInversed?-o*s:o*s;-1!==r.indexOf("...")&&this.heatMap.tooltipCollection.push(new Fe(a[x],new Me(C,n-d.height,d.width,d.height))),0!==o&&(x+=o-1)}l.enableCanvasRendering||(t.appendChild(p),t.appendChild(g))}drawYAxisLabels(e,t,i){const l=this.heatMap;let a=e.axisLabels;const s=i.height/e.axisLabelSize;let n,o=0,h=i.height/(e.axisLabelSize/e.axisLabelInterval),r=e.axisLabelInterval;if(h>0)for(;h<parseInt(e.textStyle.size,10);)r+=1,h=i.height/(e.axisLabelSize/r);else r=e.tooltipLabels.length;e.axisLabelInterval<r&&(o=r,a=e.tooltipLabels);let d=10,c=i.y+(e.isInversed?0:i.height);const p=e.opposedPosition?"start":"end";let g,u;d=e.opposedPosition?d:-d,l.enableCanvasRendering||(g=this.heatMap.renderer.createGroup({id:l.element.id+"YAxisLabels"}),u=this.heatMap.renderer.createGroup({id:l.element.id+"YAxisLabelBorder"}));for(let b=0,m=a.length;b<m;b++){const t=new Me(i.x,c,i.width,s),h=t.height/2,r=this.heatMap.cellSettings.border.width>=20?this.heatMap.cellSettings.border.width/2:0,x=t.x+d+(e.opposedPosition?r:-r),S=t.y-(this.heatMap.cellSettings.border.width>5?this.heatMap.cellSettings.border.width/2/m*(e.isInversed?b:m-b):0)+(e.isInversed?h:-h);n=e.enableTrim?De(e.maxLabelLength,a[b],e.textStyle):a[b];const C=new ve(l.element.id+"_YAxis_Label"+b,new fe(x,S,p,n,0,"rotate(0,"+x+","+S+")","middle"),e.textStyle,e.textStyle.color||l.themeStyle.axisLabel);if(B.c.isIE&&!l.enableCanvasRendering&&(C.dy="1ex"),this.drawSvgCanvas.createText(C,g,n),0===o){const t="DateTime"===e.valueType&&"None"!==e.showLabelOn?e.dateTimeAxisLabelInterval[b]:e.axisLabelInterval;c+=e.isInversed?t*s:-t*s}else c+=e.isInversed?o*s:-o*s,b+=o-1;const y=ge(n,e.textStyle);this.drawYAxisBorder(e,u,e.rect,S,y.height,b),-1!==n.indexOf("...")&&this.heatMap.tooltipCollection.push(new Fe(a[b],new Me(e.opposedPosition?x:x-y.width,S-y.height,y.width,y.height)))}l.enableCanvasRendering||(t.appendChild(g),t.appendChild(u))}drawXAxisBorder(e,t,i,l,a,s){const n=i.width/e.axisLabelSize;let o="";const h=10,r=e.interval?e.interval:1,d=e.isInversed?i.x+i.width-n*s*r:i.x+n*s*r,c=i.y;let p,g;g=c+(e.opposedPosition?-(e.maxLabelSize.height+h):e.maxLabelSize.height+h),p=e.isInversed?d-n:d+n;const u=e.isInversed?l+a+h:l-h,b=e.isInversed?l-h:l+a+h;switch(e.border.type){case"Rectangle":o="M "+d+" "+c+" L "+d+" "+g+" L "+p+" "+g+" L "+p+" "+c+" L "+d+" "+c;break;case"WithoutTopBorder":o="M "+d+" "+c+" L "+d+" "+g+" L "+p+" "+g+" L "+p+" "+c+" ";break;case"WithoutBottomBorder":o="M "+d+" "+g+" L "+d+" "+c+" L "+p+" "+c+" L "+p+" "+g+" ";break;case"WithoutTopandBottomBorder":o="M "+d+" "+c+" L "+d+" "+g+" M "+p+" "+c+" L "+p+" "+g+" ";break;case"Brace":g=c+(g-c)/2+(e.opposedPosition?0:5),o="M "+d+" "+c+" L "+d+" "+g+" L "+u+" "+g+" M "+b+" "+g+" L "+p+" "+g+" L "+p+" "+c+" "}e.border.width>0&&"WithoutBorder"!==e.border.type&&this.createAxisBorderElement(e,o,t,s)}drawYAxisBorder(e,t,i,l,a,s){const n=i.height/e.axisLabelSize;let o="";const h=e.interval?e.interval:1,r=i.x,d=e.isInversed?i.y+n*s*h:i.y+i.height-n*s*h;let c,p;c=r+(e.opposedPosition?e.maxLabelSize.width+20:-(e.maxLabelSize.width+20)),p=e.isInversed?d+n:d-n;const g=e.isInversed?l-a/2:l+a/2,u=e.isInversed?l+a/2:l-a/2;switch(e.border.type){case"Rectangle":o="M "+r+" "+d+" L "+r+" "+p+" L "+c+" "+p+" L "+c+" "+d+" L "+r+" "+d;break;case"WithoutTopBorder":o="M "+r+" "+d+" L "+c+" "+d+" L "+c+" "+p+" L "+r+" "+p+" ";break;case"WithoutBottomBorder":o="M "+c+" "+d+" L "+r+" "+d+" L "+r+" "+p+" L "+c+" "+p+" ";break;case"WithoutTopandBottomBorder":o="M "+r+" "+d+" L "+c+" "+d+" M "+c+" "+p+" L "+r+" "+p+" ";break;case"Brace":c=r-(r-c)/2,o="M "+r+" "+d+" L "+c+" "+d+" L "+c+" "+g+" M "+c+" "+u+" L "+c+" "+p+" L "+r+" "+p}e.border.width>0&&"WithoutBorder"!==e.border.type&&this.createAxisBorderElement(e,o,t,s)}createAxisBorderElement(e,t,i,l){const a=new me(this.heatMap.element.id+("Horizontal"===e.orientation?"_XAxis_Label_Border":"_YAxis_Label_Border")+l,"transparent",e.border.width,e.border.color,1,"none",t);if(this.heatMap.enableCanvasRendering)this.heatMap.canvasRenderer.drawPath(a,void 0);else{const e=this.heatMap.renderer.drawPath(a);i.appendChild(e)}}drawMultiLevels(e,t){let i;this.heatMap.enableCanvasRendering||(i=this.heatMap.renderer.createGroup({id:this.heatMap.element.id+"_"+t.orientation+"_MultiLevelLabel"})),"Horizontal"===t.orientation?this.renderXAxisMultiLevelLabels(t,i):this.renderYAxisMultiLevelLabels(t,i),this.heatMap.enableCanvasRendering||e.appendChild(i)}renderXAxisMultiLevelLabels(e,t){let i,l=0;const a=10;let s,n,o,h,r,d,c,p=0;const g=e.isInversed;let u;const b=e.opposedPosition;let m,x,S="";const C=(g?e.rect.width:0)+e.rect.x;e.multiLevelLabels.map((y,M)=>{u=this.heatMap.renderer.createGroup({id:this.heatMap.element.id+"_XAxisMultiLevelLabel"+M}),y.categories.map((v,f)=>{"Tailwind"!==this.heatMap.theme&&"TailwindDark"!==this.heatMap.theme||y.setProperties({textStyle:{fontFamily:"Inter"}},!0),"Bootstrap5"!==this.heatMap.theme&&"Bootstrap5Dark"!==this.heatMap.theme||y.setProperties({textStyle:{fontFamily:"system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'"}},!0),o=!1,h="number"==typeof v.start?v.start:Number(new Date(v.start)),r="number"==typeof v.end?v.end:Number(new Date(v.end)),s=C+this.calculateLeftPosition(e,h,v.start,e.rect),n=e.multiLevelPosition[M].y,p=C+this.calculateWidth(e,v.end,r,e.rect),d=ge(v.text,y.textStyle),m=(null===v.maximumTextWidth?Math.abs(p-s):v.maximumTextWidth)-a,i=n+(b?-(e.xAxisMultiLabelHeight[M]-d.height):d.height),l=g?s-m:s+a,"Center"===y.alignment?(l=(p-s)/2+s,l-=(d.width>m?m:d.width)/2):"Far"===y.alignment?(l=g?s-a:p-a,l-=d.width>m?m:d.width):l=g?p+a:s+a,"None"===y.overflow&&d.width>Math.abs(p-s)&&(l=g?s-d.width-a:s+a,c="start");const w=new fe(l,i,c,v.text,0,"translate(0,0)"),R=new ve(this.heatMap.element.id+"_XAxis_MultiLevel"+M+"_Text"+f,w,y.textStyle,y.textStyle.color||this.heatMap.themeStyle.axisLabel);if("Wrap"===y.overflow?(R.text=Ve(v.text,m,y.textStyle),x=R.text.length):"Trim"===y.overflow&&(R.text=De(m,v.text,y.textStyle),x=1),"Wrap"===y.overflow&&R.text.length>1){this.drawSvgCanvas.createWrapText(R,y.textStyle,u);for(let e=0;e<R.text.length;e++)if(-1!==R.text[e].indexOf("...")){o=!0;break}}else this.drawSvgCanvas.createText(R,u,R.text);this.heatMap.enableCanvasRendering||t.appendChild(u),(-1!==R.text.indexOf("...")||-1!==R.text[0].indexOf("...")||o)&&this.heatMap.tooltipCollection.push(new Fe(v.text,new Me(l,i-d.height,m,d.height*x))),y.border.width>0&&"WithoutBorder"!==y.border.type&&(S=this.renderXAxisLabelBorder(M,e,s,n,p,S,M,d,m,l))}),""!==S&&(this.createBorderElement(M,e,S,t),S="")}),this.heatMap.enableCanvasRendering||t.appendChild(u)}renderXAxisLabelBorder(e,t,i,l,a,s,n,o,h,r){let d,c;const p=l+(t.opposedPosition?-t.xAxisMultiLabelHeight[e]:t.xAxisMultiLabelHeight[e]);switch(t.multiLevelLabels[n].border.type){case"Rectangle":s+="M "+i+" "+l+" L "+i+" "+p+" L "+a+" "+p+" L "+a+" "+l+" L "+i+" "+l+" ";break;case"WithoutTopBorder":s+="M "+i+" "+l+" L "+i+" "+p+" L "+a+" "+p+" L "+a+" "+l+" ";break;case"WithoutBottomBorder":s+="M "+i+" "+p+" L "+i+" "+l+" L "+a+" "+l+" L "+a+" "+p+" ";break;case"WithoutTopandBottomBorder":s+="M "+i+" "+l+" L "+i+" "+p+" M "+a+" "+l+" L "+a+" "+p+" ";break;case"Brace":d=t.isInversed?(o.width>h?h:o.width)+r+3:r-3,c=t.isInversed?r-3:(o.width>h?h:o.width)+r+3,s+="M "+i+" "+l+" L "+i+" "+(l+(p-l)/2)+" L "+d+" "+(l+(p-l)/2)+" M "+c+" "+(l+(p-l)/2)+" L "+a+" "+(l+(p-l)/2)+" L "+a+" "+l+" "}return s}renderYAxisMultiLevelLabels(e,t){let i,l,a,s,n,o,h,r=0;const d=e.isInversed;let c,p,g,u="";const b=(d?0:e.rect.height)+e.rect.y;e.multiLevelLabels.map((m,x)=>{a=e.multiLevelPosition[x].y,c=this.heatMap.renderer.createGroup({id:this.heatMap.element.id+"_YAxisMultiLevelLabel"+x}),m.categories.map((S,C)=>{"Tailwind"!==this.heatMap.theme&&"TailwindDark"!==this.heatMap.theme||m.setProperties({textStyle:{fontFamily:"Inter"}},!0),"Bootstrap5"!==this.heatMap.theme&&"Bootstrap5Dark"!==this.heatMap.theme||m.setProperties({textStyle:{fontFamily:"system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'"}},!0),n="number"==typeof S.start?S.start:Number(new Date(S.start)),o="number"==typeof S.end?S.end:Number(new Date(S.end)),a=b+this.calculateLeftPosition(e,n,S.start,e.rect),l=e.multiLevelPosition[x].x,s=b+this.calculateWidth(e,S.start,o,e.rect),h=ge(S.text,m.textStyle),p=(null===S.maximumTextWidth?Math.abs(l):S.maximumTextWidth)-10;const y=Math.abs(l-(l-e.multiLevelSize[x].width-20))/2-h.width/2;r=(e.opposedPosition?l:l-e.multiLevelSize[x].width-20)+y,i=a+10,"None"!==m.overflow&&(g="Wrap"===m.overflow?Ve(S.text,p,m.textStyle):De(p,S.text,m.textStyle)),"Center"===m.alignment?i+=(s-a)/2-g.length*h.height/2:i="Far"===m.alignment?d?s-h.height/2:i-h.height:d?i+h.height/2:s+h.height,m.border.width>0&&"WithoutBorder"!==m.border.type&&(u=this.renderYAxisLabelBorder(x,e,l,a,s,u,x,h,p,i));const M=new fe(r,i,"start",S.text,0,"translate(0,0)"),v=new ve(this.heatMap.element.id+"_YAxis_MultiLevel"+x+"_Text"+C,M,m.textStyle,m.textStyle.color||this.heatMap.themeStyle.axisLabel);v.text=g,this.drawSvgCanvas.createText(v,c,v.text),-1!==v.text.indexOf("...")&&this.heatMap.tooltipCollection.push(new Fe(S.text,new Me(r,i-h.height,p,h.height))),this.heatMap.enableCanvasRendering||t.appendChild(c)}),""!==u&&(this.createBorderElement(x,e,u,t),u="")}),this.heatMap.enableCanvasRendering||t.appendChild(c)}renderYAxisLabelBorder(e,t,i,l,a,s,n,o,h,r){let d,c,p=20;const g=i-(t.opposedPosition?-(t.multiLevelSize[e].width+p):t.multiLevelSize[e].width+p);switch(t.multiLevelLabels[n].border.type){case"Rectangle":s+="M "+i+" "+l+" L "+g+" "+l+" L "+g+" "+a+" L "+i+" "+a+" L "+i+" "+l+" ";break;case"WithoutTopBorder":s+="M "+i+" "+l+" L "+g+" "+l+" L "+g+" "+a+" L "+i+" "+a+" ";break;case"WithoutBottomBorder":s+="M "+g+" "+l+" L "+i+" "+l+" L "+i+" "+a+" L "+g+" "+a+" ";break;case"WithoutTopandBottomBorder":s+="M "+i+" "+l+" L "+g+" "+l+" M "+i+" "+a+" L "+g+" "+a+" ";break;case"Brace":p=10,d=t.isInversed?r-p-5:r+o.height-p,c=t.isInversed?r+o.height-p:r-p-5,s+="M "+i+" "+l+" L "+(i+(g-i)/2)+" "+l+" L "+(i+(g-i)/2)+" "+d+" M "+(i+(g-i)/2)+" "+c+" L "+(i+(g-i)/2)+" "+a+" L "+i+" "+a+" "}return s}createBorderElement(e,t,i,l){const a=new me(this.heatMap.element.id+"_"+("Horizontal"===t.orientation?"XAxis":"YAxis")+"_MultiLevel_Rect_"+e,"Transparent",t.multiLevelLabels[e].border.width,t.multiLevelLabels[e].border.color,1,"",i),s=this.heatMap.renderer.drawPath(a);this.heatMap.enableCanvasRendering?this.heatMap.canvasRenderer.drawPath(a,void 0):l.appendChild(s)}calculateLeftPosition(e,t,i,l){let a,s;return"number"==typeof i?("Numeric"===e.valueType&&(e.minimum||e.maximum)&&(t-=e.minimum?e.minimum:0),s=("Horizontal"===e.orientation?l.width:l.height)/(e.axisLabelSize*e.increment),a=(e.isInversed?-1:1)*t*s,a="Horizontal"===e.orientation?a:-a):(s=this.calculateNumberOfDays(t,e,!0,l),a=e.isInversed?-s:s,a="Horizontal"===e.orientation?a:-a),a}calculateWidth(e,t,i,l){let a,s;return"number"==typeof t?("Numeric"===e.valueType&&(e.minimum||e.maximum)&&(i-=e.minimum?e.minimum:0),a=("Horizontal"===e.orientation?l.width:l.height)/(e.axisLabelSize*e.increment),s=(e.isInversed?-1:1)*(i+1)*a,s="Horizontal"===e.orientation?s:-s):(a=this.calculateNumberOfDays(i,e,!1,l),s=a,s=e.isInversed?-s:s,s="Horizontal"===e.orientation?s:-s),s}calculateNumberOfDays(e,t,i,l){const a=864e5;let s,n;const o=t.labelValue;let h;const r=("Horizontal"===t.orientation?l.width:l.height)/t.axisLabelSize,d=new Date(Number(e));let c=0;for(let p=0;p<t.axisLabelSize;p++){if(s=new Date(Number(o[p])),n=t.isInversed?new Date(Number(o[p-1])):new Date(Number(o[p+1])),p===(t.isInversed?0:t.axisLabelSize-1))if(n=new Date(Number(o[p])),"Hours"===t.intervalType)n=new Date(Number(n.setHours(n.getHours()+1)));else if("Minutes"===t.intervalType)n=new Date(Number(n.setMinutes(n.getMinutes()+1)));else if("Days"===t.intervalType)n=new Date(Number(n.setDate(n.getDate()+1)));else{const e="Months"===t.intervalType?new Date(n.getFullYear(),n.getMonth()+1,0).getDate():n.getFullYear()%4==0?366:365;n=new Date(Number(n.setDate(n.getDate()+e)))}if(Number(s)<=e&&Number(n)>=e){if("Minutes"===t.intervalType||"Hours"===t.intervalType){c=r/Math.round(Math.abs((s.getTime()-n.getTime())/6e4))*Math.abs((s.getTime()-d.getTime())/6e4),p=t.isInversed?t.axisLabelSize-1-p:p,h=p*r+c;break}{const e=Math.round(Math.abs((s.getTime()-n.getTime())/a));i?d.getDate():d.setDate(d.getDate()+1),0!==e&&(c=r/e*Math.abs((s.getTime()-d.getTime())/a)),p=t.isInversed?t.axisLabelSize-1-p:p,h=p*r+c;break}}}return h}}var Ze=function(e,t,i,l){var a,s=arguments.length,n=s<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,l);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(s<3?a(n):s>3?a(t,i,n):a(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let et=(()=>{class e extends B.d{}return Ze([Object(B.l)(!0)],e.prototype,"showLabel",void 0),Ze([Object(B.l)("")],e.prototype,"format",void 0),Ze([Object(B.l)(!0)],e.prototype,"enableCellHighlighting",void 0),Ze([Object(B.f)({},te)],e.prototype,"bubbleSize",void 0),Ze([Object(B.f)({},J)],e.prototype,"border",void 0),Ze([Object(B.f)(N.rectLabelFont,X)],e.prototype,"textStyle",void 0),Ze([Object(B.l)("Rect")],e.prototype,"tileType",void 0),Ze([Object(B.l)("Color")],e.prototype,"bubbleType",void 0),Ze([Object(B.l)(!1)],e.prototype,"isInversedBubbleSize",void 0),e})();class tt{constructor(e){this.heatMap=e,this.drawSvgCanvas=new Ae(this.heatMap),this.cellColor=new ce(this.heatMap)}renderRectSeries(){this.createSeriesGroup();const e=this.heatMap;let t=!1;e.xLength=e.axisCollections[0].axisLabelSize,e.yLength=e.axisCollections[1].axisLabelSize;let i=Math.round(100*e.initialClipRect.x)/100,l=Math.round(100*e.initialClipRect.y)/100,a=0,s=0;const n=e.cellSettings,o=Math.round((e.initialClipRect.width-n.border.width/2)/e.xLength*100)/100,h=Math.round((e.initialClipRect.height-n.border.width/2)/e.yLength*100)/100;let r=0,d=[];const c=n.border;let p,g;this.rectPositionCollection=[],this.color="",this.bubbleColorValue=[],e.yAxis.opposedPosition&&(i=Math.round(100*(e.initialClipRect.x+parseFloat(c.width.toString())/2))/100);const u=this.getBubbleRadius(o,h);for(let b=0;b<e.xLength*e.yLength;b++){"Column"===e.paletteSettings.colorGradientMode&&"Gradient"===this.heatMap.paletteSettings.type?(this.heatMap.dataSourceMinValue=this.heatMap.dataMin[s],this.heatMap.dataSourceMaxValue=this.heatMap.dataMax[s]):"Row"===e.paletteSettings.colorGradientMode&&"Gradient"===this.heatMap.paletteSettings.type&&(this.heatMap.dataSourceMinValue=this.heatMap.dataMin[a],this.heatMap.dataSourceMaxValue=this.heatMap.dataMax[a]),this.setTextAndColor(a,s);const m=new xe(0,0,0,0,0,"",0,0,0,0,!0,"","",!0);if(p=c.color,this.updateRectDetails(m,i,l,o,h,this.heatMap.bubbleSizeWithColor?Object(B.q)("",this.bubbleColorValue,null,!0):this.text,b,s,a),g=n.showLabel?this.getFormatedText(this.text,n.format):"",m.displayText=g,Object(B.u)(this.heatMap.cellRender)||(g=this.cellRendering(m,g)),("Canvas"===e.renderingMode&&0===parseFloat(c.width.toString())||!p&&"Bubble"===n.tileType&&"Sector"===n.bubbleType)&&(p=this.color),"Rect"===n.tileType)this.renderTileCell(m,c,b,this.color,p),this.updateLabelVisibleStatus(o,h,g);else if("Color"===n.bubbleType)this.renderBubbleCell(m,c,b,this.color,p,u),this.updateLabelVisibleStatus(2*u-12,2*u-6,g);else if(Object(B.u)(this.text)||"Size"!==n.bubbleType&&"SizeAndColor"!==n.bubbleType||""===this.text.toString())"Sector"!==n.bubbleType||Object(B.u)(this.text)||""===this.text.toString()||(this.renderSectorCell(m,c,b.toString(),this.color,p,u,this.text),this.checkLabelXDisplay=!1,this.checkLabelYDisplay=!1);else{"Table"!==this.heatMap.paletteSettings.colorGradientMode&&"Gradient"===this.heatMap.paletteSettings.type&&(this.heatMap.minColorValue=isFinite(this.heatMap.minColorValue)?this.heatMap.minColorValue:this.heatMap.dataSourceMinValue,this.heatMap.maxColorValue=isFinite(this.heatMap.maxColorValue)?this.heatMap.maxColorValue:this.heatMap.dataSourceMaxValue);const t=this.getRadiusBypercentage(parseFloat(this.text.toString()),e.dataSourceMinValue,e.dataSourceMaxValue,u);this.renderBubbleCell(m,c,b,this.color,p,t),this.updateLabelVisibleStatus(2*t-12,2*t-6,g)}if(d.push(m),e.rangeSelection&&"Fixed"===e.paletteSettings.type&&(t=this.isCellValueInRange(a,s),m.visible=t),n.showLabel&&this.checkLabelYDisplay&&this.checkLabelXDisplay){const a=n.textStyle,s=new ve(e.element.id+"_HeatMapRectLabels_"+b,new fe(Math.round(100*(i+o/2))/100,Math.round(100*(l+h/2))/100,"middle",g,null,null,"middle"),a,a.color||this.getSaturatedColor(this.color));m.textId=s.id,e.rangeSelection&&"Fixed"===e.paletteSettings.type&&(s.fill=t?s.fill:this.heatMap.themeStyle.toggledColor),B.c.isIE&&!e.enableCanvasRendering&&(s.dy="Bubble"===this.heatMap.cellSettings.tileType?"0.5ex":"1ex"),this.drawSvgCanvas.createText(s,this.containerTextObject,g)}r===e.xLength-1?(l=Math.round(100*(l+h))/100,r=0,s=0,i=e.yAxis.opposedPosition?Math.round(100*(e.initialClipRect.x+parseFloat(c.width.toString())/2))/100:Math.round(100*e.initialClipRect.x)/100,this.rectPositionCollection.push(d),d=[],a++):(i=Math.round(100*(i+o))/100,r++,s++)}e.enableCanvasRendering||(e.svgObject.appendChild(this.containerRectObject),!n.showLabel||"Bubble"===n.tileType&&"Sector"===n.bubbleType||e.svgObject.appendChild(this.containerTextObject))}isCellValueInRange(e,t){let i=!1;for(let l=0;l<this.heatMap.toggleValue.length;l++){let a;const s=0!==l||this.heatMap.isColorRange?this.heatMap.isColorRange?this.heatMap.toggleValue[l].startValue:this.heatMap.toggleValue[l].value:this.heatMap.dataSourceMinValue;a="Bubble"===this.heatMap.cellSettings.tileType&&"SizeAndColor"===this.heatMap.cellSettings.bubbleType?l===this.heatMap.toggleValue.length-1?this.heatMap.maxColorValue:this.heatMap.toggleValue[l+1].value-.01:l!==this.heatMap.toggleValue.length-1||this.heatMap.isColorRange?this.heatMap.isColorRange?this.heatMap.toggleValue[l].endValue:this.heatMap.toggleValue[l+1].value-.01:this.heatMap.dataSourceMaxValue;const n=this.heatMap.clonedDataSource,o=Object(B.u)(n[e][t][1])||""===n[e][t][1].toString()?"":n[e][t][1],h=parseFloat("Bubble"===this.heatMap.cellSettings.tileType&&"SizeAndColor"===this.heatMap.cellSettings.bubbleType?o.toString():this.text.toString());if(isNaN(h))i=!0;else{if(!isNaN(h)&&h>=s&&h<=a){if(this.heatMap.toggleValue[l].visible){i=!0;break}i=!1;break}if(this.heatMap.isColorRange&&a>=this.heatMap.toggleValue[l].endValue&&l===this.heatMap.toggleValue.length-1){i=!0;break}}}return i}cellRendering(e,t){const i=this.heatMap.axisCollections[0],l=this.heatMap.axisCollections[1],a=i.tooltipLabels,s=l.tooltipLabels.slice().reverse(),n=l.labelValue.slice().reverse(),o={heatmap:this.heatMap,cancel:!1,name:"cellRender",value:e.value,xLabel:a[e.xIndex].toString(),yLabel:s[e.yIndex].toString(),displayText:t,xValue:i.labelValue[e.xIndex],yValue:n[e.yIndex],cellColor:this.color};return this.heatMap.trigger("cellRender",o),this.color=o.cellColor,o.displayText}setTextAndColor(e,t){this.bubbleColorValue=[];const i=this.heatMap.dataSourceSettings,l=this.heatMap.clonedDataSource;if(this.heatMap.bubbleSizeWithColor){this.text=Object(B.u)(l[e][t][0])||""===l[e][t][0].toString()?"":l[e][t][0],this.color=Object(B.u)(l[e][t][1])||""===l[e][t][1].toString()?this.heatMap.isColorValueExist?this.heatMap.emptyPointColor:this.cellColor.getColorByValue(this.text):this.cellColor.getColorByValue(l[e][t][1]);const a=new se(i.isJsonData&&"Cell"===i.adaptorType?i.bubbleDataMapping.size:null,this.text,"Size");this.bubbleColorValue.push(a),this.bubbleColorValue.push({mappingName:i.isJsonData&&"Cell"===i.adaptorType?i.bubbleDataMapping.color:null,bubbleData:Object(B.u)(l[e][t][1])||""===l[e][t][1].toString()?"":l[e][t][1],valueType:"Color"})}else this.text=l[e][t],this.color=this.cellColor.getColorByValue(this.text)}createSeriesGroup(){this.heatMap.enableCanvasRendering||(this.containerRectObject=this.heatMap.renderer.createGroup({id:this.heatMap.element.id+"_Container_RectGroup"}),!this.heatMap.cellSettings.showLabel||"Bubble"===this.heatMap.cellSettings.tileType&&"Sector"===this.heatMap.cellSettings.bubbleType||(this.containerTextObject=this.heatMap.renderer.createGroup({id:this.heatMap.element.id+"_Container_TextGroup",transform:"translate( 0, 0)"})))}updateRectDetails(e,t,i,l,a,s,n,o,h){e.x=t,e.y=i,e.width=l,e.height=a,e.value=s,e.id=this.heatMap.element.id+"_HeatMapRect_"+n,e.xIndex=o,e.yIndex=h}renderTileCell(e,t,i,l,a){const s=new Ce(this.heatMap.element.id+"_HeatMapRect_"+i,l,t,1,new Me(e.x,e.y,e.width,e.height),a||this.heatMap.themeStyle.cellBorder,t.radius,t.radius);this.drawSvgCanvas.drawRectangle(s,this.containerRectObject,!0)}getBubbleRadius(e,t){let i=e/2-2;return t/2<e/2&&(i=t/2-2),i<0?0:i}renderSectorCell(e,t,i,l,a,s,n){let o,h,r,d,c,p,g,u,b,m;const x=Math.round(100*(e.x+e.width/2))/100,S=Math.round(100*(e.y+e.height/2))/100;let C=l;const y=this.getRadiusBypercentage(n,this.heatMap.dataSourceMinValue,this.heatMap.dataSourceMaxValue,360);for(let M=0;M<2;M++){m=parseFloat(t.width.toString()),0===M?(o=y>=180?1:0,h=-90,r=0===y?270:y-90,d=Math.round(100*(x+s*Math.cos((y-90)*(Math.PI/180))))/100,c=Math.round(100*(S+s*Math.sin((y-90)*(Math.PI/180))))/100,p=Math.round(100*x)/100,g=Math.round(100*(S-s))/100,0===y&&(C=this.heatMap.emptyPointColor)):(o=y>=180?0:1,h=r,r=270,C=this.heatMap.emptyPointColor,i+="_Unfilled",u=d,b=c,d=p,c=g,p=u,g=b,0===y&&(m=1,a=l));const e=new Te("",!1,x,S,p,g,d,c,h,r,s,!0),n=new Le(this.heatMap.element.id+"_HeatMapRect_"+i,e,C,t,m,1,a);if(this.calculateShapes(n,e,y,o),this.drawSvgCanvas.drawPath(n,e,this.containerRectObject),360===y)break}}calculateShapes(e,t,i,l){let a;switch(i){case 360:case 0:0===i&&t.start===t.end?a="M "+e.x+" "+e.y+" L "+t.x+" "+(t.y-t.radius):(a=this.heatMap.enableCanvasRendering?"":"M "+e.x+" "+e.y+" ",a=a+"m "+-t.radius+" 0 a "+t.radius+" "+t.radius+" 0 1 0 "+2*t.radius+" 0 a "+t.radius+" "+t.radius+" 0 1 0 "+-2*t.radius+" 0 "),Object(B.x)(e,{d:a});break;default:a="M "+e.x+" "+e.y+" L "+t.x1+" "+t.y1+" A "+t.radius+" "+t.radius+" 0 "+l+" 1 "+t.cx+" "+t.cy+" Z",Object(B.x)(e,{d:a})}}renderBubbleCell(e,t,i,l,a,s){const n=new ye(this.heatMap.element.id+"_HeatMapRect_"+i,l,t,1,a||this.heatMap.themeStyle.cellBorder,Math.round(100*(e.x+e.width/2))/100,Math.round(100*(e.y+e.height/2))/100,s);this.drawSvgCanvas.drawCircle(n,this.containerRectObject)}updateLabelVisibleStatus(e,t,i){this.heatMap.cellSettings.showLabel&&(this.checkLabelYDisplay=t>parseInt(this.heatMap.cellSettings.textStyle.size,10),this.checkLabelXDisplay=e>i.length*(parseInt(this.heatMap.cellSettings.textStyle.size,10)/2))}getRadiusBypercentage(e,t,i,l){let a=parseInt(this.heatMap.cellSettings.bubbleSize.minimum,10),s=parseInt(this.heatMap.cellSettings.bubbleSize.maximum,10);(a<0||a>100||isNaN(a))&&(a=0),(s<0||s>100||isNaN(s))&&(s=100);let n=(e-t)/(i-t)*100;return n=isNaN(n)?100:n,(this.heatMap.bubbleSizeWithColor||"Bubble"===this.heatMap.cellSettings.tileType&&"Size"===this.heatMap.cellSettings.bubbleType)&&(this.heatMap.cellSettings.isInversedBubbleSize&&(n=100-n),n=n*(s-a)/100+a),l*=n/100,Math.round(100*l)/100<0?0:Math.round(100*l)/100}getSaturatedColor(e){let t=e;t="transparent"===t?window.getComputedStyle(document.body,null).backgroundColor:t;const i=function(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?new de(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)):new de(255,255,255)}(function(e){e="transparent"===e?"white":e;const t=document.getElementById("heatmapmeasuretext");t.style.color=e,e=window.getComputedStyle(t).color;const i=/^(rgb|hsl)(a?)[(]\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*(?:,\s*([\d.]+)\s*)?[)]$/.exec(e);return"#"+Ue((l=new de(parseInt(i[3],10),parseInt(i[4],10),parseInt(i[5],10))).R)+Ue(l.G)+Ue(l.B);var l}(t));return Math.round((299*i.R+587*i.G+114*i.B)/1e3)>=128?"black":"white"}highlightSvgRect(e){if(-1===e.indexOf("Celltooltip"))if(-1!==e.indexOf("_HeatMapRect")){if(-1!==e.indexOf("_HeatMapRectLabels_")){const t=e.indexOf("_HeatMapRectLabels_")+19;e=this.heatMap.element.id+"_HeatMapRect_"+e.slice(t)}const t=document.getElementById(e);if(this.heatMap.tempRectHoverClass!==e){if(this.heatMap.cellSettings.enableCellHighlighting){let e;this.heatMap.tempRectHoverClass&&(e=document.getElementById(this.heatMap.tempRectHoverClass)),e&&!this.heatMap.rectSelected&&e.setAttribute("opacity","1"),t&&!this.heatMap.rectSelected&&t.setAttribute("opacity","0.65")}this.heatMap.tempRectHoverClass=e}}else if(this.heatMap.cellSettings.enableCellHighlighting){let e;this.heatMap.tempRectHoverClass&&(e=document.getElementById(this.heatMap.tempRectHoverClass)),e&&!this.heatMap.rectSelected&&(e.setAttribute("opacity","1"),this.heatMap.tempRectHoverClass="")}}getFormatedText(e,t){const i=t,l=null!==i.match("{value}");this.format=this.heatMap.intl.getNumberFormat({format:l?"":i});let a="";return""!==e.toString()&&(a=Je(l,i,e,this.format)),a}getCurrentRect(e,t){let i;const l=[];l.push(this.heatMap.heatMapSeries.rectPositionCollection[0][0]);let a=Math.ceil((e-l[0].x)/l[0].width)<this.heatMap.axisCollections[0].axisLabelSize?Math.ceil((e-l[0].x)/l[0].width):this.heatMap.axisCollections[0].axisLabelSize;const s=Math.floor((t-l[0].y)/l[0].height)<this.heatMap.axisCollections[1].axisLabelSize?Math.floor((t-l[0].y)/l[0].height):this.heatMap.axisCollections[1].axisLabelSize-1;return a=0===a?1:a,i=this.heatMap.heatMapSeries.rectPositionCollection[s][a-1],this.hoverXAxisLabel=this.heatMap.axisCollections[0].tooltipLabels[a-1],this.hoverXAxisValue=this.heatMap.axisCollections[0].labelValue[a-1],this.hoverYAxisLabel=this.heatMap.axisCollections[1].tooltipLabels[this.heatMap.axisCollections[1].tooltipLabels.length-1-s],this.hoverYAxisValue=this.heatMap.axisCollections[1].labelValue[this.heatMap.axisCollections[1].labelValue.length-1-s],i}}var it=function(e,t,i,l){var a,s=arguments.length,n=s<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,l);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(s<3?a(n):s>3?a(t,i,n):a(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let lt=(()=>{class e extends B.d{}return it([Object(B.l)("")],e.prototype,"template",void 0),it([Object(B.l)("")],e.prototype,"fill",void 0),it([Object(B.f)({},$)],e.prototype,"border",void 0),it([Object(B.f)(N.tooltipFont,X)],e.prototype,"textStyle",void 0),e})();class at{constructor(e){this.heatMap=e}processDataSource(e){const t=Object(B.q)([],e,null,!0);this.heatMap.clonedDataSource=[],this.completeDataSource=[];const i=this.heatMap.axisCollections;let l,a,s=i[0].maxLength+1,n=i[0].axisLabelSize+(i[0].min>0?i[0].min:0),o=s>n?s:n;s=i[1].maxLength+1,n=i[1].axisLabelSize+(i[1].min>0?i[1].min:0);const h=s>n?s:n;let r,d=0;const c=[];this.tempSizeArray=[],this.tempColorArray=[],this.heatMap.minColorValue=null,this.heatMap.maxColorValue=null,this.heatMap.dataMax=[],this.heatMap.dataMin=[],"Column"===this.heatMap.paletteSettings.colorGradientMode&&o<h&&(o=h);for(let p="Category"===i[1].valueType?i[1].min:0;p<("Column"===this.heatMap.paletteSettings.colorGradientMode?o:h);p++){let e="Category"===i[0].valueType?i[0].min:0;for(this.completeDataSource.push([]);e<o;)e>=i[0].min&&e<=i[0].max&&this.processDataArray(t,e,p,d),e++;if("Column"===this.heatMap.paletteSettings.colorGradientMode&&"Gradient"===this.heatMap.paletteSettings.type){r=Object(B.q)([],t[d],null,!0);for(let e=0;e<r.length;e++)"object"==typeof r[e]&&null!==r[e]&&(r[e]=r[e][0])}else r=Object(B.q)([],this.completeDataSource[d],null,!0);const s=this.getMinMaxValue(l,a,r);"Column"!==this.heatMap.paletteSettings.colorGradientMode&&"Row"!==this.heatMap.paletteSettings.colorGradientMode||"Gradient"!==this.heatMap.paletteSettings.type||(this.heatMap.dataMax[p]=s[1],this.heatMap.dataMin[p]=s[0]),l=s[0],a=s[1],this.heatMap.xAxis.isInversed&&(this.completeDataSource[d]=this.completeDataSource[d].reverse()),p>=this.heatMap.axisCollections[1].min&&p<=this.heatMap.axisCollections[1].max&&c.push(this.completeDataSource[d]),d++}"Row"!==this.heatMap.paletteSettings.colorGradientMode||this.heatMap.yAxis.isInversed||"Gradient"!==this.heatMap.paletteSettings.type||(this.heatMap.dataMax=this.heatMap.dataMax.reverse(),this.heatMap.dataMin=this.heatMap.dataMin.reverse()),"Column"===this.heatMap.paletteSettings.colorGradientMode&&this.heatMap.xAxis.isInversed&&"Gradient"===this.heatMap.paletteSettings.type&&(this.heatMap.dataMax=this.heatMap.dataMax.reverse(),this.heatMap.dataMin=this.heatMap.dataMin.reverse()),this.heatMap.yAxis.isInversed||(this.completeDataSource.reverse(),c.reverse()),this.heatMap.clonedDataSource=c,this.heatMap.dataSourceMinValue=Object(B.u)(l)?0:parseFloat(l.toString()),this.heatMap.dataSourceMaxValue=Object(B.u)(a)?0:parseFloat(a.toString()),this.heatMap.isColorValueExist=!Object(B.u)(this.heatMap.minColorValue),this.heatMap.minColorValue=Object(B.u)(this.heatMap.minColorValue)?this.heatMap.dataSourceMinValue:parseFloat(this.heatMap.minColorValue.toString()),this.heatMap.maxColorValue=Object(B.u)(this.heatMap.maxColorValue)?this.heatMap.dataSourceMaxValue:parseFloat(this.heatMap.maxColorValue.toString())}processDataArray(e,t,i,l){if(this.heatMap.bubbleSizeWithColor)if(e[t]&&!Object(B.u)(e[t][i])&&"object"==typeof e[t][i]){const a=e[t][i];for(let e=0;e<a.length;e++)if((Object(B.u)(a[e])||isNaN(a[e]))&&(a[e]=""),0===e)this.tempSizeArray.push(a[e]);else if(1===e){this.tempColorArray.push(a[e]);break}this.completeDataSource[l].push(a)}else!Object(B.u)(e[t])&&(e[t][i]||0===e[t][i]&&""!==e[t][i].toString())?(this.completeDataSource[l].push([e[t][i]]),this.tempSizeArray.push(e[t][i])):this.completeDataSource[l].push("");else e[t]&&(e[t][i]||0===e[t][i]&&""!==e[t][i].toString())?"object"==typeof e[t][i]?e[t][i].length>0&&!Object(B.u)(e[t][i][0])?this.completeDataSource[l].push(e[t][i][0]):this.completeDataSource[l].push(""):this.completeDataSource[l].push(e[t][i]):this.completeDataSource[l].push("")}getMinMaxValue(e,t,i){const l=[];return this.heatMap.bubbleSizeWithColor?("Column"===this.heatMap.paletteSettings.colorGradientMode&&"Gradient"===this.heatMap.paletteSettings.type&&(this.tempSizeArray=i),l.push(this.getMinValue(e,this.tempSizeArray)),l.push(this.getMaxValue(t,this.tempSizeArray)),this.heatMap.minColorValue=this.getMinValue(this.heatMap.minColorValue,this.tempColorArray),this.heatMap.maxColorValue=this.getMaxValue(this.heatMap.maxColorValue,this.tempColorArray)):(l.push(this.getMinValue(e,i)),l.push(this.getMaxValue(t,i))),l}getMinValue(e,t){return Object(B.u)(e)||this.performSort(t)<e?e=this.performSort(t):"Row"!==this.heatMap.paletteSettings.colorGradientMode&&"Column"!==this.heatMap.paletteSettings.colorGradientMode||"Gradient"!==this.heatMap.paletteSettings.type||(e=this.performSort(t)),Object(B.u)(e)?e:parseFloat(e.toString())}getMaxValue(e,t){return Object(B.u)(e)&&t.length>0||Math.max(...t)>e?e=Math.max(...t):"Row"!==this.heatMap.paletteSettings.colorGradientMode&&"Column"!==this.heatMap.paletteSettings.colorGradientMode||"Gradient"!==this.heatMap.paletteSettings.type||(e=Math.max(...t)),Object(B.u)(e)?e:parseFloat(e.toString())}performSort(e){return e.sort((e,t)=>e-t).filter(this.checkmin)[0]}checkmin(e){return!Object(B.u)(e)&&""!==e.toString()}}var st=function(e,t,i,l){var a,s=arguments.length,n=s<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,l);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(s<3?a(n):s>3?a(t,i,n):a(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let nt=(()=>{class e extends B.d{}return st([Object(B.l)("")],e.prototype,"height",void 0),st([Object(B.l)("")],e.prototype,"width",void 0),st([Object(B.f)({text:"",textStyle:N.titleFont},q)],e.prototype,"title",void 0),st([Object(B.l)("Right")],e.prototype,"position",void 0),st([Object(B.l)(!0)],e.prototype,"visible",void 0),st([Object(B.l)("Center")],e.prototype,"alignment",void 0),st([Object(B.l)(!0)],e.prototype,"showLabel",void 0),st([Object(B.l)(!0)],e.prototype,"showGradientPointer",void 0),st([Object(B.l)(!1)],e.prototype,"enableSmartLegend",void 0),st([Object(B.l)("All")],e.prototype,"labelDisplayType",void 0),st([Object(B.f)(N.legendLabelFont,X)],e.prototype,"textStyle",void 0),st([Object(B.l)("")],e.prototype,"labelFormat",void 0),st([Object(B.l)(!0)],e.prototype,"toggleVisibility",void 0),e})();var ot=function(e,t,i,l){var a,s=arguments.length,n=s<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,l);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(s<3?a(n):s>3?a(t,i,n):a(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let ht=(()=>{class e extends B.d{}return ot([Object(B.l)(!1)],e.prototype,"isJsonData",void 0),ot([Object(B.l)("None")],e.prototype,"adaptorType",void 0),ot([Object(B.l)("")],e.prototype,"xDataMapping",void 0),ot([Object(B.l)("")],e.prototype,"yDataMapping",void 0),ot([Object(B.l)("")],e.prototype,"valueMapping",void 0),ot([Object(B.f)({},Q)],e.prototype,"bubbleDataMapping",void 0),e})();class rt{}class dt{constructor(e){this.control=e}export(e,t,i){const l=this.getControlsValue(),a=l.width,s=l.height;let n=this.control.svgObject;const o=this.control.enableCanvasRendering;let h;o||(n=Object(B.p)("canvas",{id:"ej2-canvas",attrs:{width:a.toString(),height:s.toString()}}));const r=!(B.c.userAgent.toString().indexOf("HeadlessChrome")>-1);i=Object(B.u)(i)?W.l.Landscape:i;const d=window.URL.createObjectURL(new Blob("SVG"===e?['<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+l.svg.outerHTML+"</svg>"]:[(new XMLSerializer).serializeToString(l.svg)],{type:"image/svg+xml"}));if("SVG"===e)if("msie"===B.c.info.name){const i=new Blob([(new XMLSerializer).serializeToString(l.svg)],{type:"application/octet-stream"});window.navigator.msSaveOrOpenBlob(i,t+"."+e.toLocaleLowerCase())}else this.triggerDownload(t,e,d,r);else if("msie"===B.c.info.name){let l=n;o||(l=this.createCanvas()),h=l.toDataURL(e),"PDF"===e?this.exportPdf(l,i,a,s,r,t):this.doExport(e,h,t)}else{const l=new Image,o=n.getContext("2d");l.onload=()=>{o.drawImage(l,0,0),window.URL.revokeObjectURL(d),"PDF"===e?this.exportPdf(n,i,a,s,r,t):window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(n.msToBlob(),t+"."+e.toLocaleLowerCase()):this.triggerDownload(t,e,n.toDataURL("image/png").replace("image/png","image/octet-stream"),r)},l.src=d}o||_e(document.getElementById(this.control.element.id)+"_canvas")}triggerDownload(e,t,i,l){Object(B.p)("a",{attrs:{download:e+"."+t.toLocaleLowerCase(),href:i}}).dispatchEvent(new MouseEvent(l?"click":"move",{view:window,bubbles:!1,cancelable:!0}))}getControlsValue(){let e=0,t=0;const i=this.control.enableCanvasRendering,l=new H.e("").createSvg({id:"Svg_Export_Element",width:200,height:200}),a=this.control.svgObject.cloneNode(!0),s=this.control.renderer.createGroup({style:"transform: translateY("+t+"px)"});return i||s.appendChild(a),e=Math.max(this.control.availableSize.width,e),t+=this.control.availableSize.height,i||l.appendChild(s),i||(l.setAttribute("width",e+""),l.setAttribute("height",t+"")),{width:e,height:t,svg:l}}createCanvas(){const e=this.control,t=e.renderingMode;e.renderingMode="Canvas",e.refresh();const i=e.svgObject;return e.renderingMode=t,e.refresh(),i}exportPdf(e,t,i,l,a,s){const n=new W.e,o=n.pageSettings.margins,h=n.pageSettings.width,r=n.pageSettings.height;let d=e.toDataURL("image/jpeg").replace("image/jpeg","image/octet-stream");n.pageSettings.orientation=t,n.pageSettings.size=new W.y(h<i?i+o.left+o.right:h,r<l?l+o.top+o.bottom:r),d=d.slice(d.indexOf(",")+1),n.pages.add().graphics.drawImage(new W.a(d),0,0,i,l),a&&(n.save(s+".pdf"),n.destroy())}doExport(e,t,i){let l=[];l=[t],this.exportImage(l,i,e||"JPG",t)}exportImage(e,t,i,l){const a=[],s=e instanceof HTMLElement?0:e.length;for(let n=0;n<s;n++){const t=e[n].replace(/^data:[a-z]*;,/,"").split(","),i=atob(t[1]),l=new ArrayBuffer(i.length),s=new Uint8Array(l);for(let e=0;e<i.length;e++)s[e]=i.charCodeAt(e);a.push(l)}for(let n=0;n<a.length;n++){const e=new Blob([a[n]],{type:"application/octet-stream"});"msie"===B.c.info.name&&window.navigator.msSaveOrOpenBlob(e,t+"."+i.toLocaleLowerCase())}}print(){if(this.printWindow=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no"),this.printWindow.moveTo(0,0),this.printWindow.resizeTo(screen.availWidth,screen.availHeight),"SVG"===this.control.renderingMode)Object(B.y)(this.getHTMLContent(),this.printWindow);else{const e=this.control.svgObject,t=e.toDataURL(),i=new Image,l=e.getContext("2d");i.onload=()=>{l.drawImage(i,0,0)},i.src=t,Object(B.y)(i,this.printWindow)}}getHTMLContent(){const e=Object(B.p)("div");return e.appendChild(this.control.element.cloneNode(!0)),e}}var ct=function(e,t,i,l){var a,s=arguments.length,n=s<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,l);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(s<3?a(n):s>3?a(t,i,n):a(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n};let pt=(()=>{let e=class extends B.g{constructor(){super(...arguments),this.enableCanvasRendering=!1,this.isColorRange=!1,this.isCellTapHold=!1,this.selectedCellCount=0,this.toggleValue=[],this.legendOnLoad=!0,this.resizing=!1,this.rendering=!0,this.multiSelection=!1,this.rectSelected=!1,this.previousSelectedCellsRect=[],this.multiCellCollection=[],this.selectedMultiCellCollection=[],this.tempMultiCellCollection=[],this.tooltipCollection=[],this.isCellData=!1}preRender(){this.initPrivateVariable(),this.unWireEvents(),this.wireEvents()}export(e,t,i){new dt(this).export(e,t,i)}initPrivateVariable(){this.renderer=new H.e(this.element.id),this.canvasRenderer=new H.a(this.element.id),this.secondaryCanvasRenderer=new H.a(this.element.id+"_secondary"),this.heatMapAxis=new Ke(this),this.heatMapSeries=new tt(this),this.drawSvgCanvas=new Ae(this),this.twoDimensional=new at(this),this.cellColor=new ce(this),this.tempRectHoverClass="",this.tempTooltipRectId="",this.setCulture()}setCulture(){this.intl=new B.j}render(){if(this.horizontalGradient="Bottom"===this.legendSettings.position||"Top"===this.legendSettings.position,this.updateBubbleHelperProperty(),this.trigger("load",{heatmap:this}),"TailwindDark"===this.theme||"Tailwind"===this.theme){let e={title:{textStyle:{size:"12px",fontFamily:"Inter",fontWeight:"500"}},textStyle:{size:"12px",fontFamily:"Inter"}};this.setProperties({titleSettings:{textStyle:{size:"14px",fontFamily:"Inter"}}},!0),this.setProperties({legendSettings:e},!0),this.setProperties({xAxis:e},!0),this.setProperties({yAxis:e},!0),this.setProperties({cellSettings:{textStyle:{fontFamily:"Inter"}}},!0)}if("Bootstrap5"===this.theme||"Bootstrap5Dark"===this.theme){let e={title:{textStyle:{size:"12px",fontFamily:"system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'",fontWeight:"500"}},textStyle:{size:"12px",fontFamily:"system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'"}};this.setProperties({titleSettings:{textStyle:{size:"16px",fontFamily:"system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'"}}},!0),this.setProperties({legendSettings:e},!0),this.setProperties({xAxis:e},!0),this.setProperties({yAxis:e},!0),this.setProperties({cellSettings:{textStyle:{fontFamily:"system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'"}}},!0)}this.initAxis(),this.processInitData(),this.setTheme(),this.calculateMaxLength(),this.heatMapAxis.calculateVisibleLabels(),this.twoDimensional.processDataSource(this.completeAdaptDataSource),this.createSvg(),this.cellColor.getColorCollection(),this.calculateBounds(),this.renderElements(),this.appendSvgObject(),this.tooltipModule&&this.tooltipModule.showHideTooltip(!1),this.renderComplete()}reRenderDatasource(){this.dataSourceMinValue=null,this.dataSourceMaxValue=null,this.processInitData(),this.calculateMaxLength(),this.heatMapAxis.calculateVisibleLabels(),this.twoDimensional.processDataSource(this.completeAdaptDataSource),this.cellColor.getColorCollection(),this.calculateBounds()}processInitData(){this.adaptorModule?this.adaptorModule.constructDatasource(this.dataSource,this.dataSourceSettings):this.completeAdaptDataSource=this.dataSource}setRenderMode(){this.enableCanvasRendering="Canvas"===this.renderingMode||"Auto"===this.renderingMode&&this.axisCollections[0].axisLabelSize*this.axisCollections[1].axisLabelSize>=1e4}updateBubbleHelperProperty(){"Bubble"!==this.cellSettings.tileType||"Size"!==this.cellSettings.bubbleType&&"Sector"!==this.cellSettings.bubbleType?this.legendModule&&this.legendSettings.visible&&(this.legendVisibilityByCellType=!0):this.legendVisibilityByCellType=!1,this.bubbleSizeWithColor="Bubble"===this.cellSettings.tileType&&"SizeAndColor"===this.cellSettings.bubbleType}renderElements(){this.tooltipCollection=[],this.renderSecondaryElement(),this.renderBorder(),this.renderTitle(),this.heatMapAxis.renderAxes(),this.tooltipModule&&this.showTooltip&&(this.tooltipModule.tooltipObject=null,this.tooltipModule.createTooltipDiv(this)),this.heatMapSeries.renderRectSeries(),this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType&&(this.legendModule.renderLegendItems(),"Fixed"===this.paletteSettings.type&&this.legendSettings.enableSmartLegend&&"None"===this.legendSettings.labelDisplayType&&this.legendModule.createTooltipDiv())}getModuleName(){return"heatmap"}getPersistData(){return""}onPropertyChanged(e,t){let i=!1,l=!1,a=!0;for(const s of Object.keys(e))switch(s){case"renderingMode":this.rendering=!1,a=!1,i=!0;break;case"cellSettings":this.updateBubbleHelperProperty(),!this.legendModule||e.cellSettings.tileType===(void 0!==t.cellSettings&&t.cellSettings.tileType)&&e.cellSettings.bubbleType===t.cellSettings.bubbleType||(this.legendOnLoad=!0,this.legendModule.updateLegendRangeCollections()),"Bubble"===this.cellSettings.tileType&&(a=!1),this.reRenderDatasource(),l=!0;break;case"showTooltip":l=!0;break;case"dataSource":case"dataSourceSettings":this.isCellData=!1,this.paletteCellSelectionUpdation(),this.reRenderDatasource(),a=!1,i=!0;break;case"titleSettings":case"width":case"height":case"margin":l=!0;break;case"legendSettings":this.updateBubbleHelperProperty(),!this.legendVisibilityByCellType||e.legendSettings.visible===(void 0!==t.legendSettings&&t.legendSettings.visible)&&e.legendSettings.enableSmartLegend===t.legendSettings.enableSmartLegend?this.legendOnLoad=!1:(this.legendOnLoad=!0,this.legendModule.updateLegendRangeCollections()),l=!0;break;case"yAxis":case"xAxis":this.paletteCellSelectionUpdation(),this.reRenderDatasource(),a=!1,l=!0;break;case"paletteSettings":this.paletteCellSelectionUpdation(),this.twoDimensional.processDataSource(this.completeAdaptDataSource),this.cellColor.getColorCollection(),this.calculateBounds(),i=!0;break;case"theme":this.setTheme(),i=!0;break;case"tooltipSettings":this.tooltipModule&&(this.tooltipModule.tooltipObject.fill=this.tooltipSettings.fill,this.tooltipModule.tooltipObject.border=this.tooltipSettings.border,this.tooltipModule.tooltipObject.textStyle=this.tooltipSettings.textStyle,this.tooltipModule.tooltipObject.template=this.tooltipSettings.template,this.tooltipModule.tooltipObject.refresh())}!l&&i?(this.createSvg(),this.renderElements(),this.appendSvgObject(),this.trigger("created"),a||this.clearSelection()):l&&(this.createSvg(),this.refreshBound(),this.appendSvgObject(),this.trigger("created")),this.allowSelection&&this.rectSelected&&(a?this.updateCellSelection():this.clearSelection()),this.rendering=!0}paletteCellSelectionUpdation(){this.updateBubbleHelperProperty(),this.legendVisibilityByCellType&&(this.legendOnLoad=!0,this.legendModule.updateLegendRangeCollections())}createSvg(){this.removeSvg(),this.setRenderMode(),this.calculateSize(),this.enableCanvasRendering?(this.svgObject=this.canvasRenderer.createCanvas({id:this.element.id+"_canvas",width:this.availableSize.width,height:this.availableSize.height}),this.allowSelection&&this.createMultiCellDiv(!0)):(this.svgObject=this.renderer.createSvg({id:this.element.id+"_svg",width:this.availableSize.width,height:this.availableSize.height}),"0"===this.cellSettings.border.width.toString()&&"Rect"===this.cellSettings.tileType&&this.svgObject.setAttribute("shape-rendering","crispEdges"))}removeSvg(){if(document.getElementById(this.element.id+"_Secondary_Element")&&Object(B.z)(document.getElementById(this.element.id+"_Secondary_Element")),document.getElementById(this.element.id+"Celltooltipcontainer")&&Object(B.z)(document.getElementById(this.element.id+"Celltooltipcontainer")),document.getElementById(this.element.id+"legendLabelTooltipContainer")&&Object(B.z)(document.getElementById(this.element.id+"legendLabelTooltipContainer")),document.getElementById(this.element.id+"_Multi_CellSelection_Canvas")&&Object(B.z)(document.getElementById(this.element.id+"_Multi_CellSelection_Canvas")),document.getElementById(this.element.id+"_CellSelection_Container")&&Object(B.z)(document.getElementById(this.element.id+"_CellSelection_Container")),this.svgObject&&document.getElementById(this.svgObject.id)){for(;this.svgObject.childNodes.length;)this.svgObject.removeChild(this.svgObject.firstChild);Object(B.z)(this.svgObject)}}renderSecondaryElement(){const e=this.createElement("div");e.id=this.element.id+"_Secondary_Element",this.element.appendChild(e);const t=this.createElement("div",{id:this.element.id+"_CellSelection_Container",styles:"position:absolute; z-index: 2 ; top:"+this.initialClipRect.y+"px; left:"+this.initialClipRect.x+"px"});this.element.appendChild(t)}requiredModules(){const e=[];return this.showTooltip&&e.push({member:"Tooltip",args:[this]}),this.legendSettings&&e.push({member:"Legend",args:[this]}),this.dataSource&&e.push({member:"Adaptor",args:[this]}),e}destroy(){this.unWireEvents(),super.destroy(),this.element.innerHTML="",this.element.classList.remove("e-heatmap")}refresh(){super.refresh(),this.element.classList.add("e-heatmap")}appendSvgObject(){this.enableCanvasRendering&&this.allowSelection?this.createMultiCellDiv(!1):this.element.appendChild(this.svgObject)}renderBorder(){this.border={width:0};const e=new Ce(this.element.id+"_HeatmapBorder",this.themeStyle.background,this.border,1,new Me(0,0,this.availableSize.width-0,this.availableSize.height-0));this.drawSvgCanvas.drawRectangle(e,this.svgObject)}calculateSize(){const e=pe(this.width,this.element.offsetWidth)||this.element.offsetWidth||600,t=pe(this.height,this.element.offsetHeight)||this.element.offsetHeight||450;this.availableSize=new be(e,t);let i=this.element;for(;i.parentNode&&"BODY"!==i.tagName;){if("center"===i.align){const e=this.availableSize.width.toString();this.element.style.width=e+"px",this.element.style.margin="0 auto";break}i=i.parentElement}}renderTitle(){if(this.titleSettings.text){const e=this.titleSettings.textStyle,t="Near"===e.textAlignment?"start":"Far"===e.textAlignment?"end":"middle";this.elementSize=ge(this.titleCollection[0],e);const i=new ve(this.element.id+"_HeatmapTitle",new fe(ue(this.availableSize.width-this.margin.left-this.margin.right,this.margin.left,0,e),this.margin.top+3*this.elementSize.height/4,t,this.titleCollection),e,e.color||this.themeStyle.heatMapTitle);this.titleCollection.length>1?this.drawSvgCanvas.createWrapText(i,e,this.svgObject):(this.drawSvgCanvas.createText(i,this.svgObject,this.titleCollection[0]),-1!==this.titleCollection[0].indexOf("...")&&this.enableCanvasRendering&&this.tooltipCollection.push(new Fe(this.titleSettings.text,new Me(this.margin.left,this.margin.top,this.elementSize.width,this.elementSize.height))))}}titleTooltip(e,t,i,l){e.target.id===this.element.id+"_HeatmapTitle"&&e.target.textContent.indexOf("...")>-1?Ee(this.titleSettings.text,t,i,this.element.offsetWidth,this.element.id+"_Title_Tooltip",Be(this.element.id+"_Secondary_Element"),l,this):_e(this.element.id+"_Title_Tooltip")}axisTooltip(e,t,i,l){const a=e.target.id;if(-1!==a.indexOf(this.element.id+"_XAxis_Label")||-1!==a.indexOf(this.element.id+"_YAxis_Label")||-1!==a.indexOf(this.element.id+"_XAxis_MultiLevel")||-1!==a.indexOf(this.element.id+"_YAxis_MultiLevel")){const e=Ne(this.tooltipCollection,t,i);e?Ee(e,t,i,this.element.offsetWidth,this.element.id+"_axis_Tooltip",Be(this.element.id+"_Secondary_Element"),this.isTouch,this):_e(this.element.id+"_axis_Tooltip")}else _e(this.element.id+"_axis_Tooltip")}isHeatmapRect(e,t){const i=[],l=[];let a;if(i.push(this.heatMapSeries.rectPositionCollection[0][0]),l.push(this.heatMapSeries.rectPositionCollection[this.yLength-1][this.xLength-1]),this.cellSettings.border.width>5&&e>=i[0].x&&t>=i[0].y&&e<=l[0].x+l[0].width&&t<=l[0].y+l[0].height&&"Rect"===this.cellSettings.tileType){const i=this.heatMapSeries.getCurrentRect(e,t),s=l[0].height,n=l[0].width,o=this.cellSettings.border.width/2;e>=i.x+o&&t>=i.y+o&&e<=i.x+(n-o)&&t<=i.y+(s-o)?(a=!0,this.isRectBoundary=!0):(a=!1,this.isRectBoundary=!1)}else a=e>=i[0].x&&t>=i[0].y&&e<=l[0].x+l[0].width&&t<=l[0].y+l[0].height,this.isRectBoundary=a;return a}setTheme(){this.themeStyle=function(e){let t;switch(e.toLowerCase()){case"highcontrastlight":case"highcontrast":t={heatMapTitle:"#ffffff",axisTitle:"#ffffff",axisLabel:"#ffffff",cellBorder:"#EEEEEE",background:"#000000",cellTextColor:"#000000",toggledColor:"#000000",emptyCellColor:"#EEEEEE",legendLabel:"#ffffff",palette:[{color:"#BEE7EE"},{color:"#85c4cf"},{color:"#4CA1AF"}]};break;case"materialdark":case"fabricdark":case"bootstrapdark":t={heatMapTitle:"#ffffff",axisTitle:"#ffffff",axisLabel:"#DADADA",cellBorder:"#EEEEEE",background:"#000000",cellTextColor:"#000000",toggledColor:"#000000",emptyCellColor:"#EEEEEE",legendLabel:"#ffffff",palette:[{color:"#BEE7EE"},{color:"#85c4cf"},{color:"#4CA1AF"}]};break;case"bootstrap4":t={heatMapTitle:"#212529",axisTitle:"#212529",axisLabel:"#212529",cellBorder:"#E9ECEF",background:"#FFFFFF",cellTextColor:"#212529",toggledColor:"#ffffff",emptyCellColor:"#E9ECEF",legendLabel:"#212529",palette:[{color:"#BEE7EE"},{color:"#85c4cf"},{color:"#4CA1AF"}]};break;case"tailwind":t={heatMapTitle:"#374151",axisTitle:"#374151",axisLabel:"#6B7280",cellBorder:"#E5E7EB",background:"transparent",cellTextColor:"#111827",toggledColor:"transparent",emptyCellColor:"#E5E7EB",legendLabel:"#374151",palette:[{color:"#5A61F6"},{color:"#65A30D"},{color:"#14B8A6"}]};break;case"tailwinddark":t={heatMapTitle:"#D1D5DB",axisTitle:"#D1D5DB",axisLabel:"#9CA3AF",cellBorder:"#4B5563",background:"transparent",cellTextColor:"#FFFFFF",toggledColor:"transparent",emptyCellColor:"#374151",legendLabel:"#D1D5DB",palette:[{color:"#8B5CF6"},{color:"#22D3EE"},{color:"#F87171"}]};break;case"bootstrap5":t={heatMapTitle:"#343A40",axisTitle:"#343A40",axisLabel:"#495057",cellBorder:"#D1D5DB",background:"transparent",cellTextColor:"#111827",toggledColor:"transparent",emptyCellColor:"#E5E7EB",legendLabel:"#343A40",palette:[{color:"#668E1F"},{color:"#262E0B"},{color:"#AF6E10"}]};break;case"bootstrap5dark":t={heatMapTitle:"#E9ECEF",axisTitle:"#E9ECEF",axisLabel:"#CED4DA",cellBorder:"#4B5563",background:"transparent",cellTextColor:"#FFFFFF",toggledColor:"transparent",emptyCellColor:"#343A40",legendLabel:"#E9ECEF",palette:[{color:"#A860F1"},{color:"#5ECB9B"},{color:"#557EF7"}]};break;default:t={heatMapTitle:"#424242",axisTitle:"#424242",axisLabel:"#686868",cellBorder:"#EEEEEE",cellTextColor:"#000000",toggledColor:"#ffffff",background:"#FFFFFF",emptyCellColor:"#EEEEEE",legendLabel:"#353535",palette:[{color:"#BEE7EE"},{color:"#85c4cf"},{color:"#4CA1AF"}]}}return t}(this.theme)}calculateBounds(){const e=this.margin;let t=0;const i=this.legendModule&&"Top"===this.legendSettings.position&&this.legendVisibilityByCellType||"0px"===this.titleSettings.textStyle.size?0:16,l=e.left,a=this.availableSize.width-l-e.right;if(("Column"===this.paletteSettings.colorGradientMode||"Row"===this.paletteSettings.colorGradientMode)&&"Gradient"===this.paletteSettings.type)if(0===this.paletteSettings.palette.length)this.legendVisibilityByCellType=!1;else for(let o=0;o<this.paletteSettings.palette.length;o++)if(null!==this.paletteSettings.palette[o].value)this.legendVisibilityByCellType=!0;else if(null===this.paletteSettings.palette[o].value){this.legendVisibilityByCellType=!1;break}this.titleSettings.text&&(this.titleCollection=Ie(this.titleSettings.text,this.titleSettings.textStyle,a),t=ge(this.titleSettings.text,this.titleSettings.textStyle).height*this.titleCollection.length+i);const s=e.top+t;this.titleRect=new Me(e.left,e.top,this.availableSize.width-e.left-e.right,t),this.initialClipRect=new Me(l,s,a,this.availableSize.height-s-e.bottom);const n=this.initialClipRect.y;this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType&&this.legendModule.calculateLegendBounds(this.initialClipRect),this.heatMapAxis.measureAxis(this.initialClipRect),this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType&&this.legendModule.calculateLegendSize(this.initialClipRect,n),this.heatMapAxis.calculateAxisSize(this.initialClipRect)}refreshBound(){this.updateBubbleHelperProperty(),this.calculateBounds(),this.renderElements()}initAxis(){let e;const t=[this.xAxis,this.yAxis];this.axisCollections=[];for(let i=0,l=t.length;i<l;i++)e=t[i],e.orientation=0===i?"Horizontal":"Vertical",e.jsonCellLabel=[],this.axisCollections.push(e)}wireEvents(){const e=B.c.touchStartEvent,t=B.c.touchEndEvent,i=B.c.touchMoveEvent,l=B.c.isPointer?"pointerleave":"mouseleave";B.i.add(this.element,B.c.isDevice?e:"click",this.heatMapMouseClick,this),B.i.add(this.element,e,this.heatMapMouseMove,this),B.i.add(this.element,t,this.heatMapMouseLeave,this),B.i.add(this.element,i,this.heatMapMouseMove,this),B.i.add(this.element,l,this.heatMapMouseLeave,this),window.addEventListener(B.c.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.heatMapResize.bind(this));const a=this;new B.m(this.element,{tapHold:()=>{a.isCellTapHold=!0,a.getDataCollection(),a.currentRect.allowCollection=!1,a.setCellOpacity(),a.trigger("cellSelected",{heatmap:a,cancel:!1,name:"cellSelected",data:a.multiCellCollection})},tap:()=>{let e=!1;a.isCellTapHold||(e=!0),a.tooltipOnMouseMove(null,a.currentRect,e)}}),this.setStyle(this.element)}setStyle(e){e.style.touchAction="element",e.style.touchAction="element",e.style.zoom="none",e.style.userSelect="none",e.style.webkitUserSelect="none",e.style.position="relative",e.style.display="block"}print(){new dt(this).print()}unWireEvents(){const e=B.c.touchStartEvent,t=B.c.touchMoveEvent,i=B.c.isPointer?"pointerleave":"mouseleave";B.i.remove(this.element,B.c.isDevice?e:"click",this.heatMapMouseClick),B.i.remove(this.element,e,this.heatMapMouseMove),B.i.remove(this.element,t,this.heatMapMouseLeave),B.i.remove(this.element,t,this.heatMapMouseMove),B.i.remove(this.element,i,this.heatMapMouseLeave),window.removeEventListener(B.c.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.heatMapResize)}heatMapResize(e){this.resizing=!0;const t={heatmap:this,cancel:!1,name:"resized",currentSize:new be(0,0),previousSize:new be(this.availableSize.width,this.availableSize.height)};return this.resizeTimer&&clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(()=>{this.isDestroyed?clearTimeout(this.resizeTimer):(this.createSvg(),t.currentSize=this.availableSize,this.trigger("resized",t),this.refreshBound(),this.appendSvgObject(),this.allowSelection&&this.updateCellSelection(),this.trigger("loaded",{heatmap:this}),this.resizing=!1)},500),!1}updateCellSelection(){const e=this.initialClipRect.width/this.axisCollections[0].axisLabelSize,t=this.initialClipRect.height/this.axisCollections[1].axisLabelSize,i=this.initialClipRect.x,l=this.initialClipRect.y;if(this.enableCanvasRendering){if(this.enableCanvasRendering){const a=this.multiCellCollection,s=document.getElementById(this.element.id+"_canvas"),n=document.getElementById(this.element.id+"_secondary_canvas"),o=this.initialClipRect,h=o.y+o.height,r=o.x+o.width;for(let u=0;u<this.multiCellCollection.length;u++){this.multiCellCollection[u].width=a[u].width=e,this.multiCellCollection[u].height=a[u].height=t,this.multiCellCollection[u].x=a[u].x=i+e*this.multiCellCollection[u].xPosition,this.multiCellCollection[u].y=a[u].y=l+t*this.multiCellCollection[u].yPosition;const o=s.getContext("2d").getImageData(a[u].x,a[u].y,a[u].width,a[u].height);n.getContext("2d").putImageData(o,a[u].x,a[u].y),s.style.opacity="0.3"}const d=s.getContext("2d").getImageData(0,0,this.availableSize.width,o.y);n.getContext("2d").putImageData(d,0,0);const c=s.getContext("2d").getImageData(0,h,this.availableSize.width,this.availableSize.height-h);n.getContext("2d").putImageData(c,0,o.y+o.height);const p=s.getContext("2d").getImageData(r,0,this.availableSize.width-r,this.availableSize.height);n.getContext("2d").putImageData(p,r,0);const g=s.getContext("2d").getImageData(0,0,o.x,this.availableSize.height);n.getContext("2d").putImageData(g,0,0),_e(this.element.id+"_selectedCells")}}else if(0!==this.multiCellCollection.length){const e=document.getElementById(this.element.id+"_Container_RectGroup"),t=document.getElementById(this.element.id+"_Container_TextGroup");for(let i=0;i<e.childNodes.length;i++)e.childNodes[i].setAttribute("opacity","0.3"),this.cellSettings.showLabel&&t.childNodes[i]&&t.childNodes[i].setAttribute("opacity","0.3");for(let i=0;i<this.multiCellCollection.length;i++){const l=this.multiCellCollection[i].cellElement.id.replace(this.element.id+"_HeatMapRect_",""),a=parseInt(l,10);if(e.childNodes[a].setAttribute("opacity","1"),this.cellSettings.showLabel&&t.childNodes[i]){const t=document.getElementById(this.element.id+"_HeatMapRectLabels_"+a);t&&t.setAttribute("opacity","1"),this.addSvgClass(e.childNodes[a])}}}}clearSVGSelection(){const e=document.getElementById(this.element.id+"_Container_RectGroup"),t=document.getElementById(this.element.id+"_Container_TextGroup");for(let i=0;i<e.childNodes.length;i++){const l=e.childNodes[i].getAttribute("class");l===this.element.id+"_selected"&&this.removeSvgClass(e.childNodes[i],l),e.childNodes[i].setAttribute("opacity","1"),this.cellSettings.showLabel&&t.childNodes[i]&&t.childNodes[i].setAttribute("opacity","1")}}calculateMaxLength(){const e=this.completeAdaptDataSource;if(e&&e.length>0){const t=e.length-1;let i=0;for(let l=0;l<=t;l++){const t=e[l].length;i=i>t?i:t}this.axisCollections[0].maxLength=t,this.axisCollections[1].maxLength=i-1}else this.axisCollections[0].maxLength=0,this.axisCollections[1].maxLength=0}setMouseXY(e,t){const i=this.element.getBoundingClientRect();let l;l=this.enableCanvasRendering?document.getElementById(this.element.id+"_canvas").getBoundingClientRect():document.getElementById(this.element.id+"_svg").getBoundingClientRect(),this.mouseX=e-i.left-Math.max(l.left-i.left,0),this.mouseY=t-i.top-Math.max(l.top-i.top,0)}heatMapMouseClick(e){let t,i,l;const a=this.element.getBoundingClientRect();if("touchstart"===e.type?(this.isTouch=!0,l=e,i=l.changedTouches[0].clientY,t=l.changedTouches[0].clientX):(this.isTouch=!1,i=e.clientY,t=e.clientX),t-=a.left,i-=a.top,this.isHeatmapRect(t,i)){const l=this.heatMapSeries.getCurrentRect(t,i);this.trigger("cellClick",{heatmap:this,value:l.value,x:l.x,y:l.y,xLabel:this.heatMapSeries.hoverXAxisLabel,yLabel:this.heatMapSeries.hoverYAxisLabel,xValue:this.heatMapSeries.hoverXAxisValue,yValue:this.heatMapSeries.hoverYAxisValue,cellElement:this.enableCanvasRendering?null:document.getElementById(l.id),event:e})}if(this.notify("click",e),"Gradient"!==this.paletteSettings.type&&this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType){const e=this.legendModule.navigationCollections;e.length&&t>e[0].x&&t<e[0].x+e[0].width&&i>e[0].y&&i<e[0].y+e[0].height?this.legendModule.translatePage(this,this.legendModule.currentPage,!0):e.length&&t>e[1].x&&t<e[1].x+e[1].width&&i>e[1].y&&i<e[1].y+e[1].height&&this.legendModule.translatePage(this,this.legendModule.currentPage,!1);const l=this.legendModule.legendRange,a=this.legendModule.legendTextRange;let s=!0;for(let n=0;n<l.length;n++)this.legendModule&&this.legendSettings.toggleVisibility&&this.legendModule.currentPage===l[n].currentPage&&(s&&t>=l[n].x&&t<=l[n].width+l[n].x&&i>=l[n].y&&i<=l[n].y+l[n].height||this.legendSettings.showLabel&&"None"!==this.legendSettings.labelDisplayType&&t>=a[n].x&&t<=a[n].width+a[n].x&&i>=a[n].y&&i<=a[n].y+a[n].height)&&(this.legendModule.legendRangeSelection(n),s=!1)}return!1}heatMapMouseMove(e){let t,i,l;const a=this.element.getBoundingClientRect();return"touchmove"===e.type||"touchstart"===e.type?(this.isTouch=!0,l=e,t=l.changedTouches[0].clientX,i=l.changedTouches[0].clientY):(this.isTouch=!1,t=e.clientX,i=e.clientY),t-=a.left,i-=a.top,this.setMouseXY(t,i),this.mouseAction(e,t,i,l,a),!0}mouseAction(e,t,i,l,a){let s;if(e.target&&e.target.id){const l=this.isHeatmapRect(t,i);let a,n;if(this.legendModule&&(l?"Gradient"===this.paletteSettings.type&&this.legendSettings.showGradientPointer&&this.legendSettings.visible&&this.legendVisibilityByCellType&&this.legendModule.renderGradientPointer(e,t,i):this.legendModule.removeGradientPointer(),this.renderMousePointer(t,i)),a=!(!this.showTooltip||!this.tooltipModule)&&l,l&&(n=this.heatMapSeries.getCurrentRect(t,i),2!==e.which&&3!==e.which&&(a=this.cellSelectionOnMouseMove(e,n,t,i,a))),this.tooltipOnMouseMove(e,n,a,l),this.legendModule&&this.legendSettings.visible&&"Fixed"===this.paletteSettings.type&&this.legendSettings.enableSmartLegend&&"None"===this.legendSettings.labelDisplayType&&this.legendModule.createTooltip(t,i),this.enableCanvasRendering){this.element.getBoundingClientRect();const e="Fixed"!==this.paletteSettings.type||!this.legendSettings.enableSmartLegend||"None"!==this.legendSettings.labelDisplayType;s=Ne(this.tooltipCollection,t,i)||this.legendModule&&e&&(Ne(this.legendModule.legendLabelTooltip,t,i)||Ne(this.legendModule.legendTitleTooltip,t,i)),s?Ee(s,t,i,this.element.offsetWidth,this.element.id+"_canvas_Tooltip",Be(this.element.id+"_Secondary_Element"),this.isTouch,this):_e(this.element.id+"_canvas_Tooltip")}else this.titleSettings.text&&"Trim"===this.titleSettings.textStyle.textOverflow&&this.titleTooltip(e,t,i,this.isTouch),this.axisTooltip(e,t,i,this.isTouch),this.legendModule&&this.legendSettings.visible&&this.legendSettings.showLabel&&this.legendVisibilityByCellType&&this.legendModule.renderLegendLabelTooltip(e,t,i),this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType&&this.legendModule.renderLegendTitleTooltip(e,t,i)}return!0}cellSelectionOnMouseMove(e,t,i,l,a){return("Rect"===this.cellSettings.tileType&&"mousedown"===e.type||"touchstart"===e.type||"pointerdown"===e.type)&&this.allowSelection&&(this.previousRect=t,this.multiSelection=!0,this.rectSelected=!0,this.initialCellX=i,this.initialCellY=l,e.preventDefault()),"Rect"===this.cellSettings.tileType&&this.multiSelection&&t&&(a=!1,this.highlightSelectedCells(this.previousRect,t,i,l,e)),a}tooltipOnMouseMove(e,t,i,l){if(i&&t)this.tempTooltipRectId!==t.id&&(this.showTooltip&&((this.cellSettings.enableCellHighlighting||this.tooltipModule&&this.showTooltip)&&!this.enableCanvasRendering&&this.heatMapSeries.highlightSvgRect(t.id),this.tooltipModule.renderTooltip(t),this.isTouch&&(this.tooltipTimer&&window.clearTimeout(this.tooltipTimer),this.tooltipTimer=setTimeout(()=>{this.tooltipModule.tooltipObject.fadeOut(),this.tooltipModule.isFadeout=!0},1500),e&&"touchmove"===e.type&&e.preventDefault())),this.tempTooltipRectId=t.id);else{if(null!==e){const t=5;l?!this.showTooltip&&this.cellSettings.border.width>t&&this.heatMapSeries.highlightSvgRect(e.target.id):((this.cellSettings.enableCellHighlighting||this.showTooltip)&&!this.enableCanvasRendering&&this.cellSettings.border.width<t&&this.heatMapSeries.highlightSvgRect(e.target.id),this.tooltipModule&&this.showTooltip&&this.tooltipModule.showHideTooltip(!1,!0))}this.tempTooltipRectId=""}}highlightSelectedCells(e,t,i,l,a){const s=e.xIndex,n=e.yIndex,o=t.xIndex,h=t.yIndex;this.currentRect=t,this.selectedCellsRect=new Me(0,0,0,0),this.selectedCellsRect.x=e.x>t.x?t.x:e.x,this.selectedCellsRect.y=e.y>t.y?t.y:e.y,this.selectedCellsRect.width=(1+(e.x>t.x?s-o:o-s))*t.width,this.selectedCellsRect.height=(1+(e.y>t.y?n-h:h-n))*t.height,this.isCellTapHold="touchstart"===a.type,a.preventDefault(),!1===a.ctrlKey&&"touchstart"!==a.type&&"touchmove"!==a.type&&this.removeSelectedCellsBorder();const r=this.initialCellX>i?i:this.initialCellX,d=this.initialCellY>l?l:this.initialCellY,c=document.getElementById(this.element.id+"_CellSelection_Container"),p=this.renderer.createSvg({id:this.element.id+"_CellSelection_Container_svg",width:this.initialClipRect.width,height:this.initialClipRect.height});c.appendChild(p);const g=document.getElementById(this.element.id+"_CellSelection_Container_svg"),u=new Me(r-this.initialClipRect.x,d-this.initialClipRect.y,Math.abs(i-this.initialCellX),Math.abs(l-this.initialCellY)),b=new Ce(this.element.id+"_selectedCells","#87ceeb",{color:"transparent",width:1},1,u,"#0000ff");g.appendChild(this.renderer.drawRectangle(b)),document.getElementById(this.element.id+"_selectedCells").style.opacity="0.5"}getDataCollection(){const e=this.previousRect.xIndex,t=this.previousRect.yIndex,i=this.currentRect.xIndex,l=this.currentRect.yIndex,a=i>e?e:i,s=i>e?i:e,n=l>t?t:l,o=l>t?l:t;let h=a,r=n,d=this.previousRect.x,c=this.previousRect.y;this.getCellCollection(this.currentRect,this.previousRect,!0,h,r,s,o,a,d,c),h=a,r=n,d=this.previousRect.x,c=this.previousRect.y,this.checkSelectedCells(),this.getCellCollection(this.currentRect,this.previousRect,!1,h,r,s,o,a,d,c),this.selectedMultiCellCollection=[],this.canvasSelectedCells=new Me(0,0,0,0),this.selectedCellCount=0}getCellCollection(e,t,i,l,a,s,n,o,h,r){const d=Math.abs(e.xIndex===t.xIndex?0:e.xIndex-t.xIndex)+1,c=Math.abs(e.yIndex===t.yIndex?0:e.yIndex-t.yIndex)+1;for(let p=0;p<d*c;p++)this.getSelectedCellData(h,r,!!i),l<s?(h+=e.xIndex>t.xIndex?e.width:-e.width,l++):a<n&&(r+=e.yIndex>t.yIndex?e.height:-e.height,h=t.x,l=o)}removeSelectedCellsBorder(){if(this.enableCanvasRendering){const e=this.secondaryCanvasRenderer.ctx;for(let t=0;t<this.previousSelectedCellsRect.length;t++){const i=this.previousSelectedCellsRect[t];e.save(),e.clearRect(i.x-1,i.y-1,i.width+2,i.height+2),e.restore()}for(let t=0;t<this.multiCellCollection.length;t++){const i=this.multiCellCollection[t];this.multiCellCollection.length>0&&(e.save(),e.clearRect(i.x-1,i.y-1,i.width+2,i.height+2))}}else{const e=document.getElementById(this.element.id+"_Container_RectGroup"),t=document.getElementById(this.element.id+"_Container_TextGroup");for(let i=0;i<e.childNodes.length;i++){const l=e.childNodes[i].getAttribute("class");e.childNodes[i].setAttribute("opacity","0.3"),this.cellSettings.showLabel&&t.childNodes[i]&&(t.childNodes[i].setAttribute("opacity","0.3"),this.removeSvgClass(e.childNodes[i],l))}}this.multiCellCollection=[]}highlightSelectedAreaInCanvas(e){if(e.x){const t=document.getElementById(this.element.id+"_canvas"),i=document.getElementById(this.element.id+"_secondary_canvas"),l=this.initialClipRect,a=t.getContext("2d").getImageData(e.x,e.y,e.width,e.height);i.getContext("2d").putImageData(a,e.x,e.y),t.style.opacity="0.3";const s=t.getContext("2d").getImageData(0,0,this.availableSize.width,l.y);i.getContext("2d").putImageData(s,0,0);const n=t.getContext("2d").getImageData(0,l.y+l.height,this.availableSize.width,this.availableSize.height-(l.y+l.height));i.getContext("2d").putImageData(n,0,l.y+l.height);const o=t.getContext("2d").getImageData(l.x+l.width,0,this.availableSize.width-(l.x+l.width),this.availableSize.height);i.getContext("2d").putImageData(o,l.x+l.width,0);const h=t.getContext("2d").getImageData(0,0,l.x,this.availableSize.height);i.getContext("2d").putImageData(h,0,0)}}getSelectedCellData(e,t,i){const l=this.axisCollections[0],a=this.axisCollections[1],s=l.tooltipLabels,n=a.tooltipLabels.slice().reverse(),o=this.heatMapSeries.getCurrentRect(e+1,t+1),h=document.getElementById(o.id),r=new Se(null,"","",0,0,null,0,0,0,0,0,0);if(r.value=o.value,r.xLabel=s[o.xIndex].toString(),r.yLabel=n[o.yIndex].toString(),r.xValue=l.labelValue[o.xIndex],r.yValue=a.labelValue.slice().reverse()[o.yIndex],r.cellElement=this.enableCanvasRendering?null:h,r.xPosition=o.xIndex,r.yPosition=o.yIndex,r.width=this.currentRect.width,r.height=this.currentRect.height,r.x=this.currentRect.x,r.y=this.currentRect.y,this.currentRect.allowCollection=!0,this.addSvgClass(h),i)this.selectedMultiCellCollection.push(r),this.currentRect.allowCollection=!1;else for(let d=0;d<this.multiCellCollection.length;d++)if(this.multiCellCollection[d].xPosition===r.xPosition&&this.multiCellCollection[d].yPosition===r.yPosition&&(this.currentRect.allowCollection=!1,this.selectedCellCount===this.selectedMultiCellCollection.length)){if(this.currentRect.allowCollection=!1,this.enableCanvasRendering){const e=this.secondaryCanvasRenderer.ctx,t=this.canvasSelectedCells;e.save(),e.clearRect(t.x-1,t.y-1,t.width+2,t.height+2),e.restore(),this.selectedCellsRect=new Me(0,0,0,0)}else for(let e=0;e<this.selectedMultiCellCollection.length;e++){const t=this.selectedMultiCellCollection[e].cellElement;if(t){const e=t.id.replace(this.element.id+"_HeatMapRect_",""),i=(document.getElementById(this.element.id+"_Container_TextGroup"),t.getAttribute("class"));t.setAttribute("opacity","0.3");const l=document.getElementById(this.element.id+"_HeatMapRectLabels_"+e);l&&l.setAttribute("opacity","0.3"),this.removeSvgClass(t,i)}}this.multiCellCollection.splice(d,1)}o.visible&&!Object(B.u)(o.value)&&!0===this.currentRect.allowCollection&&this.multiCellCollection.push(r)}addSvgClass(e){this.enableCanvasRendering||e.setAttribute("class",this.element.id+"_selected")}removeSvgClass(e,t){t&&e.setAttribute("class",t.replace(t,""))}clearSelection(){if(!this.enableCanvasRendering&&this.allowSelection&&this.clearSVGSelection(),this.enableCanvasRendering){const e=this.secondaryCanvasRenderer.ctx;for(let t=0;t<this.previousSelectedCellsRect.length;t++)e.save(),e.clearRect(this.previousSelectedCellsRect[t].x-1,this.previousSelectedCellsRect[t].y-1,this.previousSelectedCellsRect[t].width+2,this.previousSelectedCellsRect[t].height+2),e.restore();for(let t=0;t<this.multiCellCollection.length;t++){const i=this.multiCellCollection[t];this.multiCellCollection.length>0&&(e.save(),e.clearRect(i.x-1,i.y-1,i.width+2,i.height+2))}document.getElementById(this.element.id+"_canvas").style.opacity="1"}this.tempMultiCellCollection=[],this.multiCellCollection=[],this.rectSelected=!1}renderMousePointer(e,t){const i=this.legendModule.legendRange,l=this.legendModule.legendTextRange;let a=!0;for(let s=0;s<i.length;s++)this.legendSettings.toggleVisibility&&this.legendModule.currentPage===i[s].currentPage&&(a&&e>=i[s].x&&e<=i[s].width+i[s].x&&t>=i[s].y&&t<=i[s].y+i[s].height||this.legendSettings.showLabel&&"None"!==this.legendSettings.labelDisplayType&&e>=l[s].x&&e<=l[s].width+l[s].x&&t>=l[s].y&&t<=l[s].y+l[s].height?(this.enableCanvasRendering?document.getElementById(this.element.id+"_canvas").style.cursor="Pointer":document.getElementById(this.element.id+"_svg").style.cursor="Pointer",a=!1):a&&(this.enableCanvasRendering?document.getElementById(this.element.id+"_canvas").style.cursor="":document.getElementById(this.element.id+"_svg").style.cursor=""))}heatMapMouseLeave(e){if(e.target&&e.target.id&&(this.cellSettings.enableCellHighlighting||this.tooltipModule&&this.showTooltip)&&!this.enableCanvasRendering&&this.heatMapSeries.highlightSvgRect(this.tempTooltipRectId),this.allowSelection&&this.multiSelection&&(this.multiSelection=!1,"mouseup"===e.type||"touchend"===e.type||"pointerup"===e.type?2!==e.which&&3!==e.which&&(!1===this.isCellTapHold?(this.getDataCollection(),this.currentRect.allowCollection=!1,this.setCellOpacity(),this.trigger("cellSelected",{heatmap:this,cancel:!1,name:"cellSelected",data:this.multiCellCollection})):this.isCellTapHold=!1):"mouseleave"===e.type&&_e(this.element.id+"_selectedCells")),this.tooltipModule&&this.showTooltip&&"mouseleave"===e.type&&this.tooltipModule.showHideTooltip(!1),this.tempTooltipRectId="",this.legendModule&&this.legendSettings.visible&&this.legendModule.tooltipObject&&this.legendModule.tooltipObject.element){const t=this.legendModule.tooltipObject.element.firstChild;"mouseleave"===e.type?t.setAttribute("opacity","0"):(this.legendTooltipTimer&&window.clearTimeout(this.legendTooltipTimer),this.legendTooltipTimer=setTimeout(()=>{t.setAttribute("opacity","0")},1500))}if("Gradient"===this.paletteSettings.type&&this.legendModule&&this.legendSettings.showGradientPointer&&this.legendSettings.visible&&this.legendVisibilityByCellType&&("mouseleave"===e.type?this.legendModule.removeGradientPointer():(this.gradientTimer&&window.clearTimeout(this.gradientTimer),this.gradientTimer=setTimeout(()=>{this.legendModule.removeGradientPointer()},1500))),this.enableCanvasRendering){const e=document.getElementById(this.element.id+"_hoverRect_canvas");e&&(e.style.visibility="hidden",this.tempRectHoverClass="")}return this.titleSettings.text&&-1!==this.titleCollection[0].indexOf("...")&&_e(this.enableCanvasRendering?this.element.id+"_canvas_Tooltip":this.element.id+"_Title_Tooltip"),!0}checkSelectedCells(){if(this.enableCanvasRendering){this.canvasSelectedCells=new Me(0,0,0,0),this.canvasSelectedCells.x=this.selectedCellsRect.x,this.canvasSelectedCells.y=this.selectedCellsRect.y,this.canvasSelectedCells.width=this.selectedCellsRect.width,this.canvasSelectedCells.height=this.selectedCellsRect.height;for(let e=0;e<this.multiCellCollection.length;e++)for(let t=0;t<this.selectedMultiCellCollection.length;t++)this.selectedMultiCellCollection[t].xPosition===this.multiCellCollection[e].xPosition&&this.selectedMultiCellCollection[t].yPosition===this.multiCellCollection[e].yPosition&&this.selectedCellCount++;this.rectSelected&&"Gradient"===this.paletteSettings.type&&this.legendModule.removeGradientPointer()}else for(let e=0;e<this.multiCellCollection.length;e++)for(let t=0;t<this.selectedMultiCellCollection.length;t++)this.selectedMultiCellCollection[t].cellElement.getAttribute("id")===this.multiCellCollection[e].cellElement.getAttribute("id")&&this.selectedCellCount++}removeOpacity(e,t){for(let i=0;i<e.childNodes.length;i++)e.childNodes[i].setAttribute("opacity","0.3"),this.cellSettings.showLabel&&t.childNodes[i]&&t.childNodes[i].setAttribute("opacity","0.3")}setCellOpacity(){if(this.enableCanvasRendering)this.previousSelectedCellsRect.push(this.selectedCellsRect),this.highlightSelectedAreaInCanvas(this.selectedCellsRect);else if(0!==this.multiCellCollection.length){this.tempMultiCellCollection.push(this.multiCellCollection);const e=document.getElementById(this.element.id+"_Container_RectGroup"),t=document.getElementById(this.element.id+"_Container_TextGroup");this.removeOpacity(e,t);for(let i=0;i<this.multiCellCollection.length;i++){const t=parseInt(this.multiCellCollection[i].cellElement.id.replace(this.element.id+"_HeatMapRect_",""),10);if(e.childNodes[t].setAttribute("opacity","1"),this.cellSettings.showLabel){const e=document.getElementById(this.element.id+"_HeatMapRectLabels_"+t);e&&e.setAttribute("opacity","1")}}}_e(this.element.id+"_selectedCells")}createMultiCellDiv(e){if(e){const e=this.createElement("div",{id:this.element.id+"_Multi_CellSelection_Canvas",styles:"position:relative"});this.element.appendChild(e),e.appendChild(this.svgObject),this.svgObject.style.position="absolute",this.svgObject.style.left="0px",this.svgObject.style.top="0px",this.svgObject.style.zIndex="0"}else{const e=document.getElementById(this.element.id+"_Multi_CellSelection_Canvas"),t=this.secondaryCanvasRenderer.createCanvas({width:this.availableSize.width,height:this.availableSize.height,x:0,y:0,style:"position: absolute; z-index: 1"});e.appendChild(t)}}};return ct([Object(B.l)(null)],e.prototype,"width",void 0),ct([Object(B.l)(null)],e.prototype,"height",void 0),ct([Object(B.l)(!0)],e.prototype,"showTooltip",void 0),ct([Object(B.h)()],e.prototype,"tooltipRender",void 0),ct([Object(B.h)()],e.prototype,"resized",void 0),ct([Object(B.h)()],e.prototype,"loaded",void 0),ct([Object(B.h)()],e.prototype,"cellRender",void 0),ct([Object(B.h)()],e.prototype,"cellSelected",void 0),ct([Object(B.l)("SVG")],e.prototype,"renderingMode",void 0),ct([Object(B.l)(null)],e.prototype,"dataSource",void 0),ct([Object(B.f)({},ht)],e.prototype,"dataSourceSettings",void 0),ct([Object(B.l)("Material")],e.prototype,"theme",void 0),ct([Object(B.l)(!1)],e.prototype,"allowSelection",void 0),ct([Object(B.f)({},U)],e.prototype,"margin",void 0),ct([Object(B.f)({text:"",textStyle:N.heatMapTitleFont},q)],e.prototype,"titleSettings",void 0),ct([Object(B.f)({},qe)],e.prototype,"xAxis",void 0),ct([Object(B.f)({position:"Right"},nt)],e.prototype,"legendSettings",void 0),ct([Object(B.f)({},re)],e.prototype,"paletteSettings",void 0),ct([Object(B.f)({},lt)],e.prototype,"tooltipSettings",void 0),ct([Object(B.f)({},qe)],e.prototype,"yAxis",void 0),ct([Object(B.f)({},et)],e.prototype,"cellSettings",void 0),ct([Object(B.h)()],e.prototype,"created",void 0),ct([Object(B.h)()],e.prototype,"load",void 0),ct([Object(B.h)()],e.prototype,"cellClick",void 0),ct([Object(B.h)()],e.prototype,"legendRender",void 0),e=ct([B.k],e),e})();var gt=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const ut=["cellClick","cellRender","cellSelected","created","legendRender","load","loaded","resized","tooltipRender"],bt=[""];let mt=(()=>{let e=class extends pt{constructor(e,t,i,l){super(),this.ngEle=e,this.srenderer=t,this.viewContainerRef=i,this.injector=l,this.tags=[""],this.element=this.ngEle.nativeElement,this.injectedModules=this.injectedModules||[];try{let e=this.injector.get("HeatMapLegend");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(a){}try{let e=this.injector.get("HeatMapTooltip");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(s){}try{let e=this.injector.get("HeatMapAdaptor");-1===this.injectedModules.indexOf(e)&&this.injectedModules.push(e)}catch(n){}this.registerEvents(ut),this.addTwoWay.call(this,bt),function(e,t,i){for(var l="currentInstance".replace(/\[/g,".").replace(/\]/g,"").split("."),a=i||{},s=0;s<l.length;s++){var n=l[s];s+1===l.length?a[n]=void 0===t?{}:t:void 0===a[n]&&(a[n]={}),a=a[n]}}(0,this,this.viewContainerRef),this.context=new G}ngOnInit(){this.context.ngOnInit(this)}ngAfterViewInit(){this.context.ngAfterViewInit(this)}ngOnDestroy(){this.context.ngOnDestroy(this)}ngAfterContentChecked(){this.context.ngAfterContentChecked(this)}};return e.\u0275fac=function(t){return new(t||e)(s.Qb(s.l),s.Qb(s.G),s.Qb(s.S),s.Qb(s.t))},e.\u0275cmp=s.Kb({type:e,selectors:[["ejs-heatmap"]],inputs:{allowSelection:"allowSelection",cellSettings:"cellSettings",dataSource:"dataSource",dataSourceSettings:"dataSourceSettings",enablePersistence:"enablePersistence",enableRtl:"enableRtl",height:"height",legendSettings:"legendSettings",locale:"locale",margin:"margin",paletteSettings:"paletteSettings",renderingMode:"renderingMode",showTooltip:"showTooltip",theme:"theme",titleSettings:"titleSettings",tooltipSettings:"tooltipSettings",width:"width",xAxis:"xAxis",yAxis:"yAxis"},outputs:{cellClick:"cellClick",cellRender:"cellRender",cellSelected:"cellSelected",created:"created",legendRender:"legendRender",load:"load",loaded:"loaded",resized:"resized",tooltipRender:"tooltipRender"},features:[s.Bb],decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0}),e=function(e,t,i,l){var a,s=arguments.length,n=s<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,l);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(s<3?a(n):s>3?a(t,i,n):a(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n}([(t=[G],function(e){!function(e,t){t.forEach(function(t){Object.getOwnPropertyNames(t.prototype).forEach(function(i){e.prototype.hasOwnProperty(i)&&!t.isFormBase||(e.prototype[i]=t.prototype[i])})})}(e,t)}),gt("design:paramtypes",[s.l,s.G,s.S,s.t])],e),e;var t})(),xt=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.Ob({type:e}),e.\u0275inj=s.Nb({imports:[[l.c]]}),e})();const St={provide:"HeatMapLegend",useValue:class{constructor(e){this.maxLegendLabelSize=new be(0,0),this.gradientScaleSize=10,this.segmentCollections=[],this.segmentCollectionsLabels=[],this.textWrapCollections=[],this.labelCollections=[],this.labelCollection=[],this.legendSize=10,this.previousOptions=new ke(0,0,0,0,0,0),this.listPerPage=0,this.numberOfPages=1,this.listWidth=0,this.fillRect=new Me(0,0,0,0),this.legendRect=new Me(0,0,0,0),this.currentPage=1,this.lastList=[],this.navigationCollections=[],this.pagingRect=new Me(0,0,0,0),this.listInterval=10,this.legendLabelTooltip=[],this.legendTitleTooltip=[],this.labelXCollections=[],this.labelYCollections=[],this.legendXCollections=[],this.legendYCollections=[],this.legendRectPositionCollection=[],this.legendRange=[],this.legendTextRange=[],this.visibilityCollections=[],this.heatMap=e,this.drawSvgCanvas=new Ae(e)}getModuleName(){return"Legend"}destroy(){}renderLegendItems(){const e=this.heatMap;e.toggleValue=[];const t={color:"transparent",width:0};this.legend=e.renderer.createGroup({id:e.element.id+"_Heatmap_Legend"});const i=new Ce(e.element.id+"_LegendBound","none",t,1,this.legendGroup);this.drawSvgCanvas.drawRectangle(i,this.legend);const l=this.legendRectScale,a=e.canvasRenderer.ctx,s=new Me(l.x,l.y,l.width,l.height);let n;if("Fixed"===e.paletteSettings.type){const t=e.legendSettings.enableSmartLegend?e.legendColorCollection:e.colorCollection;this.legendRange=e.resizing||!e.legendOnLoad&&e.rendering?[]:this.legendRange,this.legendTextRange=e.resizing||!e.legendOnLoad&&e.rendering?[]:this.legendTextRange,e.enableCanvasRendering&&(a.save(),a.clip());for(let i=0;i<t.length;i++){const l=!!Object(B.u)(this.visibilityCollections[i])||this.visibilityCollections[i];e.toggleValue.push(new Xe(l,t[i].value,t[i].startValue,t[i].endValue))}}if("Gradient"===e.paletteSettings.type||"Fixed"===e.paletteSettings.type&&!0===e.legendSettings.enableSmartLegend){if("Gradient"===e.paletteSettings.type){if(e.enableCanvasRendering){let t;const i=e.canvasRenderer.ctx;t=e.horizontalGradient?i.createLinearGradient(l.x,0,l.x+l.width,0):i.createLinearGradient(0,l.y,0,l.y+l.height),e.legendSettings.title.text&&i.clip();for(let l=0;l<e.legendColorCollection.length;l++){let i=((this.heatMap.isColorRange?e.legendColorCollection[l].startValue:e.legendColorCollection[l].value)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue);i=isNaN(i)?0:i,this.heatMap.isColorRange&&"Gradient"===this.heatMap.paletteSettings.type?this.calculateCanvasColorRange(l,t):t.addColorStop(i,e.legendColorCollection[l].color)}i.fillStyle=t,n=t.toString()}else{let t,i;const l=[];for(let s=0;s<e.legendColorCollection.length;s++){if(this.heatMap.isColorRange&&"Gradient"===this.heatMap.paletteSettings.type)this.calculateColorRange(s,l);else{let t=(e.legendColorCollection[s].value-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100;t=isNaN(t)?0:t,i=new Pe(e.legendColorCollection[s].color,t+"%"),l.push(i)}if(this.legendMaxValue===this.legendMinValue)break}t=e.horizontalGradient?new ze(e.element.id+"_lineargradient","0%","100%","0%","0%"):new ze(e.element.id+"_lineargradient","0%","0%","0%","100%");const a=e.renderer.drawGradient("linearGradient",t,l);this.legend.appendChild(a),n="url(#"+e.element.id+"_lineargradient)"}const i=new Ce(e.element.id+"_Gradient_Legend",n,t,1,s);this.drawSvgCanvas.drawRectangle(i,this.legend),this.renderElements(s)}else this.renderSmartLegend(),this.renderTitle(s);e.enableCanvasRendering||e.svgObject.appendChild(this.legend),e.enableCanvasRendering&&a.restore(),this.renderLegendLabel(s)}else{this.legendScale=e.renderer.createGroup({id:e.element.id+"Heatmap_GradientScale"});const i=new Ce(e.element.id+"_Gradient_Scale","none",t,1,this.legendRectScale);this.drawSvgCanvas.drawRectangle(i,this.legendScale),this.renderTitle(s),e.enableCanvasRendering||this.legend.appendChild(this.legendScale),this.translategroup=e.renderer.createGroup({id:e.element.id+"_translate"}),this.calculateListPerPage(s),this.numberOfPages>1&&(this.paginggroup=e.renderer.createGroup({id:e.element.id+"_navigation"})),this.renderListLegendMode(s,!0),e.enableCanvasRendering&&a.restore()}}renderElements(e){this.renderTitle(e),this.renderColorAxisGrid(e)}calculateCanvasColorRange(e,t){const i=this.heatMap;let l=((i.legendColorCollection[e].startValue<i.dataSourceMinValue&&i.legendColorCollection[e].endValue>i.dataSourceMinValue?i.dataSourceMinValue:i.legendColorCollection[e].startValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue);l=isNaN(l)?0:l;const a=((i.legendColorCollection[e].endValue>=this.heatMap.dataSourceMaxValue?this.heatMap.dataSourceMaxValue:i.legendColorCollection[e].endValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue);this.heatMap.legendColorCollection[0].startValue!==this.heatMap.dataSourceMinValue&&0===e&&this.heatMap.legendColorCollection[0].startValue>this.heatMap.dataSourceMinValue&&(l=(this.heatMap.legendColorCollection[0].startValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue),t.addColorStop(l/2,this.heatMap.paletteSettings.fillColor.minColor),t.addColorStop(l,this.heatMap.paletteSettings.fillColor.maxColor)),t.addColorStop(l,i.legendColorCollection[e].minColor),t.addColorStop(a,i.legendColorCollection[e].maxColor),this.heatMap.legendColorCollection[e].endValue!==(e===this.heatMap.legendColorCollection.length-1?this.heatMap.dataSourceMaxValue:this.heatMap.legendColorCollection[e+1].startValue)&&this.heatMap.legendColorCollection[e].endValue<this.heatMap.dataSourceMaxValue&&(l=(i.legendColorCollection[e].endValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue),t.addColorStop(l,this.heatMap.paletteSettings.fillColor.minColor),l=((e===this.heatMap.legendColorCollection.length-1?this.heatMap.dataSourceMaxValue:i.legendColorCollection[e+1].startValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue),t.addColorStop(l,this.heatMap.paletteSettings.fillColor.maxColor))}calculateColorRange(e,t=[]){const i=this.heatMap;let l,a,s,n;i.toggleValue=[],this.heatMap.legendColorCollection[0].startValue>this.heatMap.dataSourceMinValue&&0===e&&(l=(this.heatMap.dataSourceMinValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,l=isNaN(l)?0:l,a=new Pe(i.paletteSettings.fillColor.minColor,l+"%"),t.push(a),l=(i.legendColorCollection[0].startValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,a=new Pe(i.paletteSettings.fillColor.maxColor,l+"%"),t.push(a)),l=(i.legendColorCollection[e].startValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,l=isNaN(l)?0:l,a=new Pe(i.legendColorCollection[e].minColor,l+"%"),t.push(a),l=(i.legendColorCollection[e].endValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100;const o=new Pe(i.legendColorCollection[e].maxColor,l+"%");t.push(o),this.heatMap.legendColorCollection[e].endValue!==(e===this.heatMap.legendColorCollection.length-1?this.heatMap.dataSourceMaxValue:this.heatMap.legendColorCollection[e+1].startValue)&&(l=(i.legendColorCollection[e].endValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,s=new Pe(this.heatMap.paletteSettings.fillColor.minColor,l+"%"),t.push(s),l=((e===this.heatMap.legendColorCollection.length-1?this.heatMap.dataSourceMaxValue:i.legendColorCollection[e+1].startValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,n=new Pe(this.heatMap.paletteSettings.fillColor.maxColor,l+"%"),t.push(n))}renderTitle(e){const t=this.heatMap;if(t.legendSettings.title.text){const i=t.legendSettings.title,l=ge(i.text,i.textStyle);let a,s=t.legendSettings.showLabel?this.labelPadding:t.horizontalGradient?10:6;const n="start";let o,h,r,d,c=i.text;"Trim"===t.legendSettings.title.textStyle.textOverflow&&(o=this.width-10,c=De(o,c,i.textStyle)),t.horizontalGradient?(a=e.y+("Top"===t.legendSettings.position?0:-(10+l.height+s)),s="Top"===t.legendSettings.position?-(s+l.height/4):s+3*l.height/4,d="Bottom"===t.legendSettings.position?a:a-l.height,0!==c.length&&t.enableCanvasRendering&&this.legendTitleTooltip.push(new Fe(i.text,new Me(e.x,d,o,l.height))),l.width=e.width<l.width?e.width:l.width,r=new ve(t.element.id+"_legendTitle",new fe(e.x+e.width/2-l.width/2,a+s,n,c,0,"translate(0,0)",h),i.textStyle,i.textStyle.color||t.themeStyle.heatMapTitle)):(s=-(s+l.height/4),0!==c.length&&t.enableCanvasRendering&&this.legendTitleTooltip.push(new Fe(i.text,new Me(e.x,e.y-l.height,o,l.height))),r=new ve(t.element.id+"_legendTitle",new fe(e.x,e.y+s,n,c,0,"translate(0,0)",h),i.textStyle,i.textStyle.color||t.themeStyle.heatMapTitle)),this.drawSvgCanvas.createText(r,this.legend,c)}}renderSmartLegend(){const e=this.heatMap,t=e.colorCollection;let i;const l={color:"transparent",width:0},a=this.legendRectScale;let s,n,o,h;const r=a.width/t.length,d=a.height/t.length;this.legendRectPositionCollection=[],this.legendRange=[];for(let c=0;c<e.legendColorCollection.length;c++){const p=new We(0,0,0,0,"","");e.horizontalGradient?(s=a.x+c*r,n=a.y,o=r,h=a.height,this.segmentCollections.push("Edge"!==e.legendSettings.labelDisplayType||c!==e.legendColorCollection.length-1||e.legendColorCollection[c].isHidden?s:s+r)):(s=a.x,n=a.y+c*d,o=a.width,h=d,this.segmentCollections.push("Edge"!==e.legendSettings.labelDisplayType||c!==e.legendColorCollection.length-1||e.legendColorCollection[c].isHidden?n:n+d)),i=new Me(s,n,o,h);const g=new Ye(0,0,0,0,0,!0,0);if(g.x=s,g.y=n,g.width=o,g.height=h,g.value=this.heatMap.isColorRange?e.legendColorCollection[c].endValue:e.legendColorCollection[c].value,g.currentPage=this.currentPage,t.length!==e.legendColorCollection.length&&c===e.legendColorCollection.length-1&&(e.horizontalGradient?g.width=0:g.height=0,this.visibilityCollections[c]=this.visibilityCollections[c-1]),g.visible=!!Object(B.u)(this.visibilityCollections[c])||this.visibilityCollections[c],this.legendRange.push(g),!e.legendColorCollection[c].isHidden){const a=new Ce(e.element.id+"_Smart_Legend"+c,e.legendOnLoad||this.legendRange[c].visible?this.heatMap.isColorRange?t[c].minColor:t[c].color:"#D3D3D3",l,1,i);if(this.drawSvgCanvas.drawRectangle(a,this.legend),p.x=s,p.y=n,p.width=o,p.height=h,p.label=this.labelCollections[c],p.id=e.element.id+"_Smart_Legend"+c,this.legendRectPositionCollection.push(p),0!==Ie(this.labelCollections[c],e.legendSettings.textStyle,this.textWrapCollections[c]).length&&e.enableCanvasRendering){const t=ge(this.labelCollections[c],e.legendSettings.textStyle);this.legendLabelTooltip.push(new Fe(this.labelCollections[c],new Me(p.x,p.y,t.width,t.height)))}}}}colorRangeLegendPosition(e,t){if(this.segmentCollections.length!==this.segmentCollectionsLabels.length){for(let i=0;i<this.segmentCollections.length;i++)if(this.segmentCollectionsLabels[e]===this.segmentCollections[i]){t=this.segmentCollectionsLabels[e]+((i===this.segmentCollections.length-1?this.heatMap.horizontalGradient?this.width:this.height:this.segmentCollections[i+1])-this.segmentCollections[i])/2;break}}else t=this.segmentCollectionsLabels[e]+((e===this.segmentCollectionsLabels.length-1?this.heatMap.horizontalGradient?this.width:this.height:this.segmentCollectionsLabels[e+1])-this.segmentCollectionsLabels[e])/2;this.labelPosition=t}renderLegendLabel(e){const t=this.heatMap;if(this.legendTextRange=[],t.legendSettings.showLabel&&("Gradient"===t.paletteSettings.type||"Fixed"===t.paletteSettings.type&&"None"!==t.legendSettings.labelDisplayType)){let i,l,a,s,n="start",o=0;this.legendLabelTooltip=[];const h=t.isColorRange,r=t.legendColorCollection;if(t.enableCanvasRendering){const e=t.canvasRenderer.ctx;e.rect(this.legendGroup.x,this.legendGroup.y,this.legendGroup.width,this.legendGroup.height),e.save(),e.clip(),e.restore()}else l=t.renderer.createGroup({id:t.element.id+"_Heatmap_LegendLabel"});let d,c;for(let p=0;p<r.length;p++){const g=(r[p].value-Math.round(100*this.legendMinValue)/100)/(Math.round(100*this.legendMaxValue)/100-Math.round(100*this.legendMinValue)/100)*100;if(t.horizontalGradient?(this.heatMap.isColorRange&&"Gradient"===t.paletteSettings.type?(this.colorRangeLegendPosition(p,d),d=this.labelPosition):d=this.heatMap.legendSettings.enableSmartLegend&&this.heatMap.isColorRange&&"Fixed"===t.paletteSettings.type?this.segmentCollections[p]+e.width/r.length/2:this.segmentCollections[p],c=e.y+e.height+this.labelPadding,n=Math.round(100*g)/100==0&&!h||"Fixed"===t.paletteSettings.type&&0===p?"start":Math.round(100*g)/100==100&&"Gradient"===t.paletteSettings.type&&!h||Math.round(100*t.dataSourceMaxValue)/100===r[p].value&&t.legendSettings.enableSmartLegend||t.legendSettings.enableSmartLegend&&"Fixed"===t.paletteSettings.type&&"Edge"===t.legendSettings.labelDisplayType?"end":"middle",i="hanging"):(d=e.x+e.width+this.labelPadding,this.heatMap.isColorRange&&"Gradient"===t.paletteSettings.type?(this.colorRangeLegendPosition(p,c),c=this.labelPosition):c=this.heatMap.legendSettings.enableSmartLegend&&this.heatMap.isColorRange&&"Fixed"===t.paletteSettings.type?this.segmentCollections[p]+e.height/r.length/2:this.segmentCollections[p],i=Math.round(100*g)/100==0&&!h||0===p&&"Fixed"===t.paletteSettings.type?"hanging":Math.round(100*g)/100==100&&!h&&"Gradient"===t.paletteSettings.type||Math.round(100*t.dataSourceMaxValue)/100===r[p].value&&t.legendSettings.enableSmartLegend||t.legendSettings.enableSmartLegend&&"Edge"===t.legendSettings.labelDisplayType&&"Fixed"===t.paletteSettings.type?"auto":"middle"),o=t.horizontalGradient?this.textWrapCollections[p]:this.width-(this.legendRectScale.width+this.labelPadding+this.legendRectPadding),a=Ie(this.labelCollections[p],t.legendSettings.textStyle,o),s=ge(a[0],t.legendSettings.textStyle),"Fixed"===t.paletteSettings.type){const e=new Ye("end"===n?d-s.width:"middle"===n?d-s.width/2:d,"hanging"===i?c:"middle"===i?c-s.height/2:c-s.height,s.width,s.height,r[p].value,!0,this.currentPage);e.visible=!!Object(B.u)(this.visibilityCollections[p])||this.visibilityCollections[p],this.legendTextRange.push(e)}if(""!==this.labelCollections[p]){0!==a.length&&-1!==a[0].indexOf("...")&&t.enableCanvasRendering&&this.legendLabelTooltip.push(new Fe(this.labelCollections[p],new Me(d,c,s.width,s.height)));const e=new fe(d,c,n,a,0,"translate(0,0)",i),o=new ve(t.element.id+"_Legend_Label"+p,e,t.legendSettings.textStyle,t.legendSettings.textStyle.color||t.themeStyle.legendLabel);o.fill=t.legendOnLoad||"Fixed"!==t.paletteSettings.type||this.legendRange[p].visible?o.fill:"#D3D3D3",a.length>1?this.drawSvgCanvas.createWrapText(o,t.legendSettings.textStyle,l):this.drawSvgCanvas.createText(o,l,a[0]),B.c.isIE&&!t.enableCanvasRendering&&("middle"===i?l.lastChild.setAttribute("dy","0.6ex"):"hanging"===i&&l.lastChild.setAttribute("dy","1.5ex"))}if(this.legendMaxValue===this.legendMinValue&&"Gradient"===t.paletteSettings.type)break}if(!t.enableCanvasRendering){this.legendGroup.height=this.legendGroup.height>0?this.legendGroup.height:0,this.legendGroup.width=this.legendGroup.width>0?this.legendGroup.width:0,this.legend.appendChild(l);const e=t.renderer.createClipPath({id:t.element.id+"_clipPath"}),i=t.renderer.drawRectangle(this.legendGroup);e.appendChild(i),t.svgObject.appendChild(e),this.legend.setAttribute("style","clip-path:url(#"+e.id+")")}}}renderGradientPointer(e,t,i){const l=this.heatMap,a=l.heatMapSeries.getCurrentRect(t,i),s=l.bubbleSizeWithColor?""!==a.value[0].bubbleData.toString()?this.heatMap.isColorValueExist?a.value[1].bubbleData.toString():a.value[0].bubbleData.toString():"":a.value.toString(),n=this.legendRectScale;let o,h,r,d,c,p,g,u,b,m;if(""!==s.toString())if(l.horizontalGradient?(o=n.width/100,d=o*((Number(s)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue))*100,d=isNaN(d)?0:d,c=n.x+d,p=n.y+n.height,g=n.x-5+d,u=m=n.y+n.height+8,b=n.x+5+d):(o=n.height/100,d=o*((Number(s)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue))*100,d=isNaN(d)?0:d,c=n.x-1,p=n.y+d,g=b=n.x-8,u=n.y-5+d,m=n.y+5+d),h="M "+c+" "+p+" L "+g+" "+u+" L "+b+" "+m+" Z",r=new me(l.element.id+"_Gradient_Pointer","gray",.01,"#A0A0A0",1,"0,0",h),l.enableCanvasRendering){let e;this.removeGradientPointer(),l.canvasRenderer.drawPath(r,e),this.previousOptions.pathX1=c,this.previousOptions.pathY1=p,this.previousOptions.pathX2=g,this.previousOptions.pathY2=u,this.previousOptions.pathX3=b,this.previousOptions.pathY3=m}else this.gradientPointer=l.renderer.drawPath(r),this.gradientPointer.style.visibility="visible",this.legend.appendChild(this.gradientPointer);else this.removeGradientPointer()}removeGradientPointer(){const e=this.heatMap;this.gradientPointer&&!e.enableCanvasRendering?this.gradientPointer.style.visibility="hidden":e.enableCanvasRendering&&(0!==Object.keys(this.previousOptions).length&&(e.horizontalGradient?(this.fillRect.x=this.previousOptions.pathX2-1,this.fillRect.y=this.previousOptions.pathY1,this.fillRect.width=this.previousOptions.pathX3-this.previousOptions.pathX2+2,this.fillRect.height=this.previousOptions.pathY2+1-this.previousOptions.pathY1):(this.fillRect.x=this.previousOptions.pathX2-1,this.fillRect.y=this.previousOptions.pathY2-1,this.fillRect.width=this.previousOptions.pathX1-this.previousOptions.pathX2+1,this.fillRect.height=this.previousOptions.pathY3-this.previousOptions.pathY2+2)),e.canvasRenderer.ctx.fillStyle=e.themeStyle.background,e.canvasRenderer.ctx.fillRect(this.fillRect.x,this.fillRect.y,this.fillRect.width,this.fillRect.height))}calculateLegendBounds(e){const t=this.heatMap,i=t.legendSettings;this.labelCollection=[],this.labelCollections=[];const l=t.legendColorCollection;"Bottom"!==i.position&&"Top"!==i.position&&"Right"!==i.position&&"Left"!==i.position&&(i.position="Right");const a=t.legendSettings.title,s=ge(a.text,a.textStyle);t.horizontalGradient="Bottom"===i.position||"Top"===i.position,this.legendRectPadding=t.horizontalGradient?t.legendSettings.title.text?s.height+16:16:10,this.labelPadding=i.showLabel?this.heatMap.horizontalGradient?10:6:0,this.legendHeight=i.height,this.legendWidth=i.width;const n=t.legendSettings.labelFormat,o=null!==n.match("{value}");if(this.format=t.intl.getNumberFormat({format:o?"":n}),"Fixed"===t.paletteSettings.type)for(let h=0;h<l.length;h++){const e=l[h].label?l[h].label:this.heatMap.isColorRange?l[h].startValue.toString()+"-"+l[h].endValue.toString():Je(o,n,l[h].value,this.format).toString(),i={cancel:!1,text:e,name:"legendRender"};this.labelCollection.push(e),this.heatMap.trigger("legendRender",i),this.labelCollections.push(t.legendRender?t.legendSettings.enableSmartLegend&&"Edge"===t.legendSettings.labelDisplayType&&h>0&&h<l.length-1||i.cancel?"":i.text:t.legendSettings.enableSmartLegend&&"Edge"===t.legendSettings.labelDisplayType&&h>0&&h<l.length-1?"":e)}else for(let h=0;h<l.length;h++){const e=l[h].isHidden?"":l[h].label?l[h].label:this.heatMap.isColorRange?l[h].startValue.toString()+"-"+l[h].endValue.toString():Je(o,n,l[h].value,this.format).toString(),i={cancel:!1,text:e,name:"legendRender"};l[h].isHidden||this.heatMap.trigger("legendRender",i),this.labelCollections.push(t.legendRender?i.cancel||h>0&&h<l.length-1&&"Edge"===t.legendSettings.labelDisplayType||i.cancel?"":i.text:h>0&&h<l.length-1&&"Edge"===t.legendSettings.labelDisplayType?"":e)}"Gradient"===t.paletteSettings.type||"Fixed"===t.paletteSettings.type&&t.legendSettings.enableSmartLegend?(this.maxLegendLabelSize=this.getMaxLabelSize(),t.horizontalGradient&&""===i.height?this.legendHeight=(2*this.legendRectPadding+this.legendSize+this.maxLegendLabelSize.height).toString():!t.horizontalGradient&&""===i.width&&("None"===i.textStyle.textOverflow||"Fixed"===t.paletteSettings.type&&t.legendSettings.enableSmartLegend&&"None"===t.legendSettings.labelDisplayType)&&(this.legendWidth=(2*this.legendRectPadding+this.legendSize+this.maxLegendLabelSize.width).toString()),this.calculateTitleBounds()):this.calculateListLegendBounds(e),this.legendHeight=this.legendHeight?this.legendHeight:t.horizontalGradient?"50":"100%",this.legendWidth=this.legendWidth?this.legendWidth:t.horizontalGradient?"100%":"Fixed"!==t.paletteSettings.type||t.legendSettings.enableSmartLegend?"50":"70",this.height=pe(this.legendHeight,e.height),this.width=pe(this.legendWidth,e.width),t.horizontalGradient?(this.height=("Gradient"===t.paletteSettings.type||t.legendSettings.enableSmartLegend)&&this.height<50?50:this.height,"Top"===i.position&&(e.y+=this.height),e.height-=this.height):(this.width=("Gradient"===t.paletteSettings.type||t.legendSettings.enableSmartLegend)&&this.width<50?50:this.width,"Left"===i.position&&(e.x+=this.width),e.width-=this.width)}calculateTitleBounds(){const e=this.heatMap,t=e.legendSettings.title,i=ge(t.text,t.textStyle);e.legendSettings.title.text&&("Top"!==e.legendSettings.position&&"Bottom"!==e.legendSettings.position||""!==e.legendSettings.height||(this.legendHeight=(2*this.legendRectPadding-i.height+this.legendSize+this.maxLegendLabelSize.height).toString()),""===e.legendSettings.width&&("None"===e.legendSettings.textStyle.textOverflow||"Fixed"===e.paletteSettings.type&&e.legendSettings.enableSmartLegend&&"None"===e.legendSettings.labelDisplayType)&&("Right"===e.legendSettings.position?this.legendWidth=(2*this.legendRectPadding+i.width+this.legendSize+this.maxLegendLabelSize.width).toString():"Left"===e.legendSettings.position&&(i.width=i.width>this.maxLegendLabelSize.width?i.width:this.maxLegendLabelSize.width,this.legendWidth=(2*this.legendRectPadding+i.width+this.legendSize).toString())))}calculateListLegendBounds(e){const t=this.heatMap;this.listWidth=0,this.listHeight=0,this.currentPage=1;const i=t.legendSettings.title,l=ge(i.text,i.textStyle),a=(l.height+50).toString();if(t.horizontalGradient){for(let e=0;e<t.colorCollection.length;e++){let i=0;t.legendSettings.showLabel&&(i=ge(this.labelCollections[e],t.legendSettings.textStyle).width),this.listWidth+=this.legendSize+this.labelPadding+i+this.listInterval}this.listWidth+=this.listInterval+10,""===this.legendWidth&&(this.legendWidth=this.listWidth>e.width?e.width.toString():this.listWidth.toString()),""===this.legendHeight&&(this.numberOfRows=Math.ceil(this.listWidth/pe(this.legendWidth,e.width)),this.numberOfRows=this.numberOfRows>3?3:this.numberOfRows,this.legendHeight=(this.listWidth>e.width||this.listWidth>pe(this.legendWidth,e.width))&&this.numberOfRows>3?((this.legendSize+this.listInterval)*this.numberOfRows+this.legendRectPadding+parseInt(t.legendSettings.textStyle.size,10)+10).toString():((this.legendSize+this.listInterval)*this.numberOfRows+this.legendRectPadding).toString())}else this.listHeight=(this.legendSize+this.listInterval)*t.colorCollection.length+this.listInterval+(t.legendSettings.title.text?l.height:0),""===this.legendHeight&&(this.legendHeight=this.listHeight>e.height?e.height.toString():this.listHeight.toString()),""===this.legendWidth&&"Trim"!==t.legendSettings.textStyle.textOverflow&&(this.maxLegendLabelSize=this.getMaxLabelSize(),this.maxLegendLabelSize.width=l.width>this.maxLegendLabelSize.width?l.width:this.maxLegendLabelSize.width,this.legendWidth=(2*this.legendRectPadding+this.legendSize+this.labelPadding+this.maxLegendLabelSize.width).toString());pe(this.legendHeight,e.height)<50&&(this.legendHeight=a),pe(this.legendWidth,e.width)<70&&(this.legendWidth="70")}getMaxLabelSize(){const e=this.heatMap;if(this.maxLegendLabelSize=new be(0,0),!e.legendSettings.showLabel||e.horizontalGradient&&"Fixed"===e.paletteSettings.type&&!e.legendSettings.enableSmartLegend||"Fixed"===e.paletteSettings.type&&"None"===e.legendSettings.labelDisplayType)return this.maxLegendLabelSize;{const t=this.maxLegendLabelSize;for(let i=0;i<e.legendColorCollection.length;i++){const l=ge(this.labelCollections[i],e.legendSettings.textStyle);t.width=t.width>l.width?t.width:l.width,t.height=t.height>l.height?t.height:l.height}return t}}calculateLegendSize(e,t){const i=this.heatMap,l=i.legendSettings;let a,s;const n=l.alignment;let o,h=pe(this.legendHeight,e.height);o=i.legendSettings.title.text?this.width:pe(this.legendWidth,e.width);const r=i.axisCollections;let d=0;if(i.horizontalGradient){o=o>e.width?e.width:o,h="Gradient"===i.paletteSettings.type||i.legendSettings.enableSmartLegend?h>50?h:50:this.height,a="Near"===n?e.x:"Far"===n?e.x+e.width-o:e.x+e.width/2-o/2,""!==i.xAxis.title.text&&(d=ge(i.xAxis.title.text,i.xAxis.textStyle).height+10);const c=r[0].opposedPosition?0:Oe(r[0].xAxisMultiLabelHeight)+r[0].maxLabelSize.height+d+10;s="Top"===l.position?i.titleSettings.text?t:i.margin.top:e.y+e.height+c}else{h=h>e.height?e.height:h,o="Gradient"===i.paletteSettings.type||i.legendSettings.enableSmartLegend?o>50?o:50:o,s="Near"===n?e.y:"Far"===n?e.y+e.height-h:e.y+e.height/2-h/2,""!==i.yAxis.title.text&&(d=ge(i.yAxis.title.text,i.yAxis.textStyle).height+10);const t=r[1].opposedPosition?Oe(r[1].yAxisMultiLabelHeight)+r[1].maxLabelSize.width+d+20:0;a="Right"===l.position?e.x+e.width+t:i.margin.left}this.legendGroup=new Me(a,s,o,h),this.calculateGradientScale(this.legendGroup)}measureListLegendBound(e){const t=this.heatMap,i=t.legendSettings.title;this.numberOfPages=1;const l=ge(i.text,i.textStyle);if(t.horizontalGradient)this.listWidth>this.width?(this.numberOfRows=Math.ceil(this.listWidth/this.width),this.listHeight=(this.legendSize+this.listInterval)*this.numberOfRows,this.listPerPage=this.numberOfRows<=3?this.numberOfRows:Math.ceil((this.height-15-parseInt(t.legendSettings.textStyle.size,10)-this.legendRectPadding)/(this.legendSize+this.listInterval)),this.numberOfPages=Math.ceil(this.numberOfRows/this.listPerPage)):this.listPerPage=1;else if(this.listHeight>e.height||this.listHeight>this.height){let i=pe(this.legendHeight,e.height);i=i>e.height?e.height:i,i=t.legendSettings.title.text?i-l.height:i,this.listPerPage=Math.floor(i/(this.legendSize+this.listInterval)-1),this.numberOfPages=Math.max(1,Math.ceil(t.colorCollection.length/this.listPerPage))}else this.listPerPage=t.colorCollection.length,this.legendHeight=this.listHeight.toString()}renderPagingElements(){const e=this.heatMap;if(this.numberOfPages>1){this.navigationCollections=[],this.legend.appendChild(this.paginggroup);const t=10,i=this.legendGroup.x+this.legendGroup.width-t,l=this.legendGroup.y+this.legendGroup.height-t,a=this.currentPage+"/"+this.numberOfPages,s=ge(a,e.legendSettings.textStyle),n=i-s.width-15,o=new fe(n,l,"start",a,0,"translate(0,0)","middle"),h=new ve(e.element.id+"_paging",o,e.legendSettings.textStyle,e.legendSettings.textStyle.color||e.themeStyle.legendLabel);this.drawSvgCanvas.createText(h,this.paginggroup,a),B.c.isIE&&!e.enableCanvasRendering&&this.paginggroup.lastChild.setAttribute("dy","0.6ex"),this.pagingRect=new Me(n,l-s.height/2,s.width,s.height);const r=new Ce(e.element.id+"_pagingText","none",{color:"transparent",width:0},1,this.pagingRect);this.drawSvgCanvas.drawRectangle(r,this.paginggroup);const d=new Ce(e.element.id+"_rightArrow","none",{color:"transparent",width:0},1,new Me(i-t,l-t/2,t,t));this.drawSvgCanvas.drawRectangle(d,this.paginggroup);const c="M "+i+" "+l+" L "+(i-t)+" "+(l-t/2)+" L "+(i-t)+" "+(l+t/2)+"Z",p=n-15,g="M "+p+" "+l+" L "+(p+t)+" "+(l-t/2)+" L "+(p+t)+" "+(l+t/2)+"Z",u=new Ce(e.element.id+"_leftArrow","none",{color:"transparent",width:0},1,new Me(p,l-t/2,t,t));this.drawSvgCanvas.drawRectangle(u,this.paginggroup);const b=new me(e.element.id+"_Legend_leftarrow","gray",.01,"#A0A0A0",1,"0,0",g),m=new me(e.element.id+"_Legend_rightarrow","gray",.01,"#A0A0A0",1,"0,0",c);if(this.navigationCollections.push(d),this.navigationCollections.push(u),e.enableCanvasRendering){let t;e.canvasRenderer.drawPath(b,t),e.canvasRenderer.drawPath(m,t)}else{const t=e.renderer.drawPath(b),i=e.renderer.drawPath(m);this.paginggroup.appendChild(t),this.paginggroup.appendChild(i)}}}calculateGradientScale(e){const t=this.heatMap;let i,l,a,s;const n=t.legendSettings.title,o=ge(n.text,n.textStyle),h=t.legendSettings.title.text?o.height:0;"Fixed"!==t.paletteSettings.type||t.legendSettings.enableSmartLegend||this.measureListLegendBound(t.initialClipRect),t.horizontalGradient?(i=e.x+10,l=e.y+this.legendRectPadding,s="Fixed"!==t.paletteSettings.type||t.legendSettings.enableSmartLegend?e.width-20:e.width-2*this.listInterval,a="Fixed"!==t.paletteSettings.type||t.legendSettings.enableSmartLegend?this.gradientScaleSize:(this.legendSize+this.listInterval)*this.listPerPage-this.listInterval):(i=e.x+this.legendRectPadding,l=e.y+10+h,s="Fixed"!==t.paletteSettings.type||t.legendSettings.enableSmartLegend?this.gradientScaleSize:e.width-10,a="Fixed"!==t.paletteSettings.type||t.legendSettings.enableSmartLegend?e.height-20-h:(this.legendSize+this.listInterval)*this.listPerPage-this.listInterval),this.legendRectScale=new Me(i,l,s,a),("Gradient"===t.paletteSettings.type||"Fixed"===t.paletteSettings.type&&t.legendSettings.enableSmartLegend)&&this.calculateColorAxisGrid(this.legendRectScale)}calculateColorAxisGrid(e){const t=this.heatMap,i=this.legendRectScale;let l,a,s,n,o=0;this.segmentCollectionsLabels=[],this.segmentCollections=[],this.textWrapCollections=[];const h="Gradient"===t.paletteSettings.type?t.legendColorCollection:t.colorCollection,r=t.bubbleSizeWithColor?t.minColorValue:t.dataSourceMinValue,d=t.bubbleSizeWithColor?t.maxColorValue:t.dataSourceMaxValue;if(this.legendMinValue=this.heatMap.isColorRange?h[0].startValue>t.dataSourceMinValue?t.dataSourceMinValue:h[0].startValue:h[0].value>r?r:h[0].value,this.legendMaxValue=this.heatMap.isColorRange?h[h.length-1].endValue<t.dataSourceMaxValue?t.dataSourceMaxValue:h[h.length-1].endValue:h[h.length-1].value<d?d:h[h.length-1].value,"Gradient"===t.paletteSettings.type)for(let p=0;p<h.length;p++){let a;l=(this.heatMap.isColorRange&&t.horizontalGradient?i.width:i.height)/100,this.heatMap.isColorRange?(h[0].startValue!==this.heatMap.dataSourceMinValue&&0===p&&h[0].startValue>this.heatMap.dataSourceMinValue&&(a=(this.heatMap.dataSourceMinValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,n=(t.horizontalGradient?e.x:e.y)+l*a,this.segmentCollections.push(n)),a=((h[p].startValue<t.dataSourceMinValue&&h[p].endValue>t.dataSourceMaxValue?t.dataSourceMinValue:h[p].startValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,a=isNaN(a)?0:a,n=(t.horizontalGradient?e.x:e.y)+l*a,this.segmentCollections.push(n),this.segmentCollectionsLabels.push(n),h[p].endValue!==(p===h.length-1?this.heatMap.dataSourceMaxValue:h[p+1].startValue)&&this.heatMap.legendColorCollection[p].endValue<this.heatMap.dataSourceMaxValue&&(p===h.length-1&&(a=(h[p].endValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,n=(t.horizontalGradient?e.x:e.y)+l*a,this.segmentCollections.push(n)),a=((p===h.length-1?this.heatMap.dataSourceMaxValue:h[p].endValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,n=(t.horizontalGradient?e.x:e.y)+l*a,this.segmentCollections.push(n))):(a=(h[p].value-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,a=isNaN(a)?0:a,t.horizontalGradient?(l=i.width/100,s=e.x+l*a,this.segmentCollections.push(s)):(l=i.height/100,n=e.y+l*a,this.segmentCollections.push(n)))}let c;if(t.horizontalGradient){const i=this.heatMap.isColorRange?this.segmentCollectionsLabels:this.segmentCollections;for(let l=0;l<h.length;l++){if("Gradient"===t.paletteSettings.type){const t=(i[l]-i[l-1])/2,a=(i[l+1]-i[l])/2;c=l===h.length-1?this.heatMap.isColorRange?(e.width-i[l-1])/2:t:0===l?a:t<a&&!this.heatMap.isColorRange?t:a}else{const e=this.legendRectScale.width/t.colorCollection.length;c="Edge"===t.legendSettings.labelDisplayType?e:e/2}this.textWrapCollections.push(c),a=Ie(this.labelCollections[l],t.legendSettings.textStyle,c),o=a.length>o?a.length:o}"Bottom"===t.legendSettings.position?(t.initialClipRect.height-=this.maxLegendLabelSize.height*(o-1),this.legendGroup.y-=this.maxLegendLabelSize.height*(o-1),this.legendRectScale.y=this.legendGroup.y+this.legendRectPadding,this.legendGroup.height=parseInt(this.legendHeight,10)+this.maxLegendLabelSize.height*(o-1)):(t.initialClipRect.y+=this.maxLegendLabelSize.height*(o-1),t.initialClipRect.height-=this.maxLegendLabelSize.height*(o-1),this.legendRectScale.y=this.legendGroup.y+this.legendRectPadding,this.legendGroup.height=parseInt(this.legendHeight,10)+this.maxLegendLabelSize.height*(o-1))}}renderColorAxisGrid(e){const t=this.heatMap;let i,l,a,s,n;t.enableCanvasRendering||(i=this.heatMap.renderer.createGroup({id:t.element.id+"_ColorAxis_Grid"}));for(let o=0;o<(t.isColorRange?this.segmentCollections.length:t.legendColorCollection.length);o++){t.horizontalGradient?(l=s=this.segmentCollections[o],a=e.y,n=e.y+e.height):(l=e.x,a=n=this.segmentCollections[o],s=e.x+e.width);const h=new we(l,a,s,n),r=new Re(this.heatMap.element.id+"_ColorAxis_Grid"+o,h,"#EEEEEE",1);this.drawSvgCanvas.drawLine(r,i),t.enableCanvasRendering||this.legend.appendChild(i)}}renderLegendTitleTooltip(e,t,i){if(-1!==e.target.id.indexOf("_legendTitle")&&e.target.textContent.indexOf("...")>-1)Ee(this.heatMap.legendSettings.title.text,t,i,this.heatMap.element.offsetWidth,this.heatMap.element.id+"_legendTitle_Tooltip",Be(this.heatMap.element.id+"_Secondary_Element"),null,this.heatMap),document.getElementById(this.heatMap.element.id+"_legendTitle_Tooltip").style.visibility="visible";else{const e=document.getElementById(this.heatMap.element.id+"_legendTitle_Tooltip");e&&(e.style.visibility="hidden")}}renderLegendLabelTooltip(e,t,i){if(-1!==e.target.id.indexOf("_Legend_Label")&&e.target.textContent.indexOf("...")>-1){const l=e.target.id.split(this.heatMap.element.id+"_Legend_Label");if(2===l.length){let e;e=1===l[1].length||"Trim"===this.heatMap.legendSettings.textStyle.textOverflow?parseInt(l[1],10):parseInt(l[1].substring(0,l[1].length-1),10),Ee(this.labelCollections[e],t,i,this.heatMap.element.offsetWidth,this.heatMap.element.id+"_LegendLabel_Tooltip",Be(this.heatMap.element.id+"_Secondary_Element"),null,this.heatMap),document.getElementById(this.heatMap.element.id+"_LegendLabel_Tooltip").style.visibility="visible"}}else{const e=document.getElementById(this.heatMap.element.id+"_LegendLabel_Tooltip");e&&(e.style.visibility="hidden")}}calculateListPerPage(e){const t=this.heatMap;if(t.horizontalGradient){this.lastList=[];let i=e.x,l=e.y,a=0,s=0,n=0,o=0;const h=20;let r;const d=10,c=5;for(this.labelXCollections=[],this.labelYCollections=[],this.legendXCollections=[],this.legendYCollections=[],r=0;r<t.colorCollection.length;r++){t.legendSettings.showLabel&&(a=ge(this.labelCollections[r],t.legendSettings.textStyle).width),n=i+d+c,o=l+c;const p=t.legendSettings.showLabel?n+a:i+this.legendSize+this.listInterval;0!==r&&p>this.legendGroup.width+this.legendGroup.x-this.listInterval&&(s+=1,i=e.x,l=e.y+s*h,n=i+d+c,o=l+c,s%this.listPerPage==0&&(this.lastList.push(r),l=e.y,o=l+c,s=0)),this.labelXCollections.push(n),this.labelYCollections.push(o),this.legendXCollections.push(i),this.legendYCollections.push(l),i=i+this.legendSize+this.labelPadding+a+this.listInterval}this.lastList.push(r),this.numberOfPages=this.lastList.length}}renderListLegendMode(e,t){const i=this.heatMap,l={color:"transparent",width:0};let a;this.legendLabelTooltip=[];let s,n,o=new be(0,0),h=0,r=0,d=e.x,c=e.y;t&&this.renderPagingElements();const p=i.legendSettings.title.text?this.width-2*(this.legendSize+this.labelPadding):this.legendGroup.width-(this.legendSize+this.legendRectPadding+this.labelPadding);i.horizontalGradient?(s=1===this.currentPage?0:this.lastList[this.currentPage-2],n=this.lastList[this.currentPage-1]):(s=this.currentPage*this.listPerPage-this.listPerPage,n=s+this.listPerPage,n=n<i.colorCollection.length?n:i.colorCollection.length);for(let g=s;g<n;g++){i.legendSettings.showLabel&&(o=ge(this.labelCollections[g],i.legendSettings.textStyle));const e={cancel:!1,text:this.labelCollection[g],name:"legendRender"};if(i.horizontalGradient&&(d=this.legendXCollections[g],c=this.legendYCollections[g],h=this.labelXCollections[g],r=this.labelYCollections[g]),h=d+this.legendSize+this.labelPadding,r=c+5,this.heatMap.trigger("legendRender",e),t&&i.rendering&&this.legendRange.length<=i.colorCollection.length){const t=new Ye(d,c,10,10,i.colorCollection[g].value,!0,this.currentPage);if(t.visible=!!Object(B.u)(this.visibilityCollections[g])||this.visibilityCollections[g],e.cancel){const e=new Ye(d,c,0,0,i.colorCollection[g].value,!0,this.currentPage);this.legendRange.push(e)}else this.legendRange.push(t);if(i.legendSettings.showLabel){const e=new Ye(h,r-o.height/2,o.width,o.height,i.colorCollection[g].value,!0,this.currentPage);e.visible=!!Object(B.u)(this.visibilityCollections[g])||this.visibilityCollections[g],this.legendTextRange.push(e)}}if(!e.cancel){if(i.legendSettings.showLabel){const e=Ie(this.labelCollections[g],i.legendSettings.textStyle,p);-1!==e[0].indexOf("...")&&i.enableCanvasRendering&&this.legendLabelTooltip.push(new Fe(this.labelCollections[g],new Me(h,r,o.width,o.height)));const t=new fe(h,r,"start",e,0,"translate(0,0)","middle"),l=new ve(i.element.id+"_Legend_Label"+g,t,i.legendSettings.textStyle,i.legendSettings.textStyle.color||i.themeStyle.legendLabel);l.fill=i.legendOnLoad||this.legendRange[g].visible?l.fill:"#D3D3D3",this.drawSvgCanvas.createText(l,this.translategroup,e[0]),B.c.isIE&&!i.enableCanvasRendering&&this.translategroup.lastChild.setAttribute("dy","0.6ex")}a=new Me(d,c,10,10);const e=new Ce(i.element.id+"_legend_list"+g,i.legendOnLoad||this.legendRange[g].visible?this.heatMap.isColorRange?i.colorCollection[g].minColor:i.colorCollection[g].color:"#D3D3D3",l,1,a);this.drawSvgCanvas.drawRectangle(e,this.translategroup),i.horizontalGradient?d=d+this.legendSize+this.labelPadding+o.width+this.listInterval:c+=this.legendSize+this.listInterval}}if(!i.enableCanvasRendering){this.legendGroup.height=this.legendGroup.height>0?this.legendGroup.height:0,this.legendGroup.width=this.legendGroup.width>0?this.legendGroup.width:0;const e=i.renderer.createClipPath({id:i.element.id+"_LegendScale_ClipPath"}),t=i.renderer.drawRectangle(this.legendGroup);e.appendChild(t),this.translategroup.appendChild(e),this.legend.setAttribute("style","clip-path:url(#"+e.id+")"),this.legendScale.appendChild(this.translategroup),i.svgObject.appendChild(this.legend)}}translatePage(e,t,i){if(i&&t>=1&&t<this.numberOfPages||!i&&t>1&&t<=this.numberOfPages){if(i?(this.currentPage+=1,this.legendRect.y+=this.legendRect.height):(this.currentPage-=1,this.legendRect.y-=this.legendRect.height),e.enableCanvasRendering){const t=e.canvasRenderer.ctx;t.fillRect(this.legendRectScale.x-5,this.legendRectScale.y-5,this.legendRectScale.width+5,this.legendRectScale.height+10),t.fillRect(this.pagingRect.x,this.pagingRect.y,this.pagingRect.width,this.pagingRect.height)}else for(this.paginggroup.removeChild(this.paginggroup.firstChild);this.translategroup.childNodes.length;)this.translategroup.removeChild(this.translategroup.firstChild);this.renderListLegendMode(this.legendRectScale,!0)}if(e.enableCanvasRendering&&e.allowSelection&&e.rectSelected){const t=e.secondaryCanvasRenderer.ctx,i=e.legendSettings.position,l=e.initialClipRect,a="Right"===i?l.x+l.width:0,s="Bottom"===i?l.y+l.height:0,n="Right"===i?e.availableSize.width-(l.x+l.width):"Left"===i?l.x:e.availableSize.width,o="Top"===i?l.y:"Bottom"===i?e.availableSize.height-(l.y+l.height):e.availableSize.height;t.save(),t.clearRect(a,s,n,o),t.restore();const h=document.getElementById(e.element.id+"_canvas"),r=document.getElementById(e.element.id+"_secondary_canvas"),d=h.getContext("2d").getImageData(a,s,n,o);r.getContext("2d").putImageData(d,a,s),h.style.opacity="0.3"}}createTooltipDiv(){const e=Object(B.p)("div",{id:this.heatMap.element.id+"legendLabelTooltipContainer",styles:"position:absolute"});this.heatMap.element.appendChild(e)}renderTooltip(e){const t=this.heatMap,i=[e.label];let l=null;l=parseInt(t.legendSettings.textStyle.size,10)/2,this.tooltipObject=new H.g({offset:l,theme:t.theme,content:i,location:{x:e.x+e.width/2,y:e.y+e.height/2},inverted:!t.horizontalGradient,areaBounds:{height:this.legendGroup.height+this.legendGroup.y,width:this.legendGroup.width+this.legendGroup.x,x:"Right"===t.legendSettings.position?0:this.legendGroup.x,y:"Top"===t.legendSettings.position?""===t.titleSettings.text?this.legendGroup.height-this.legendGroup.y:this.legendGroup.y:0}},"#"+this.heatMap.element.id+"legendLabelTooltipContainer"),this.tooltipObject.element.style.visibility="visible"}createTooltip(e,t){let i;for(let a=0;a<this.heatMap.colorCollection.length;a++){const l=this.legendRectPositionCollection[a];if(l&&e>l.x&&e<l.width+l.x&&t>l.y&&t<l.height+l.y){i=this.legendRectPositionCollection[a];break}}const l=document.getElementById(this.heatMap.element.id+"legendLabelTooltipContainer");l&&"visible"===l.style.visibility&&this.tooltipObject&&!this.heatMap.isTouch&&(this.tooltipObject.fadeOut(),l.style.visibility="hidden"),i&&this.renderTooltip(i)}legendRangeSelection(e){const t=this.heatMap,i=this.legendRange,l=t.horizontalGradient?10:0,a=this.legendRectScale,s=t.canvasRenderer.ctx;if(t.rangeSelection=!0,t.enableCanvasRendering){const e=t.canvasRenderer.ctx;t.legendSettings.enableSmartLegend?e.fillRect(a.x-5,a.y-5,a.width+this.labelPadding+this.maxLegendLabelSize.width+5,a.height+2*(5+l)):e.fillRect(a.x-5,a.y-5,a.width+5,a.height+10)}else{if(t.legendSettings.enableSmartLegend)for(;this.legend&&this.legend.childNodes.length;)this.legend.removeChild(this.legend.firstChild);else for(;this.translategroup&&this.translategroup.childNodes.length;)this.translategroup.removeChild(this.translategroup.firstChild);_e(t.heatMapSeries.containerRectObject.id),t.cellSettings.showLabel&&_e(t.heatMapSeries.containerTextObject.id)}if(t.legendSettings.enableSmartLegend&&t.colorCollection.length!==t.legendColorCollection.length&&(e===t.legendColorCollection.length-1?t.toggleValue[e-1].visible=this.visibilityCollections[e-1]=i[e-1].visible=!i[e].visible:e===t.colorCollection.length-1&&(t.toggleValue[e+1].visible=this.visibilityCollections[e+1]=i[e+1].visible=!i[e].visible)),t.toggleValue[e].visible=this.visibilityCollections[e]=i[e].visible=!i[e].visible,t.legendOnLoad=!1,t.legendSettings.enableSmartLegend){this.renderSmartLegend();const e=new Me(a.x,a.y,a.width,a.height);this.renderLegendLabel(e),t.enableCanvasRendering&&(s.save(),s.clip()),"SVG"===t.renderingMode&&this.renderTitle(e)}else this.renderListLegendMode(this.legendRectScale,!1);t.enableCanvasRendering&&s.restore(),t.heatMapSeries.renderRectSeries(),t.clearSelection()}updateLegendRangeCollections(){const e=this.heatMap;e.rangeSelection=!e.legendOnLoad,this.visibilityCollections=e.legendOnLoad?[]:this.visibilityCollections,e.toggleValue=e.legendOnLoad?[]:e.toggleValue,this.legendRange=e.legendOnLoad?[]:this.legendRange,this.legendTextRange=e.legendOnLoad?[]:this.legendTextRange}}},Ct={provide:"HeatMapTooltip",useValue:class{constructor(e){this.isFirst=!0,this.isFadeout=!1,this.heatMap=e}getModuleName(){return"Tooltip"}showHideTooltip(e,t){const i=document.getElementById(this.heatMap.element.id+"Celltooltipcontainer");e?i.style.visibility="visible":(i&&"hidden"!==i.style.visibility&&(this.tooltipObject&&t&&this.heatMap.isRectBoundary?this.tooltipObject.fadeOut():this.tooltipObject&&this.tooltipObject.element&&this.tooltipObject.element.firstChild.setAttribute("opacity","0"),i.style.visibility="hidden"),this.isFadeout=!0)}destroy(){}createTooltip(e,t,i,l){let a=null;const s=Object(B.B)("#"+this.heatMap.element.id+"Celltooltipcontainer");this.heatMap.cellSettings.showLabel&&this.heatMap.heatMapSeries.checkLabelXDisplay&&this.heatMap.heatMapSeries.checkLabelYDisplay&&(a=parseInt(this.heatMap.cellSettings.textStyle.size,10)/2),"Tailwind"===this.heatMap.theme&&this.heatMap.setProperties({tooltipSettings:{textStyle:{size:"12px",fontFamily:"Inter",fontWeight:"500"}}},!0),"TailwindDark"===this.heatMap.theme&&this.heatMap.setProperties({tooltipSettings:{fill:"#F9FAFB",textStyle:{size:"12px",fontFamily:"Inter",fontWeight:"500",color:"#1F2937"}}},!0),"Bootstrap5"===this.heatMap.theme&&this.heatMap.setProperties({tooltipSettings:{textStyle:{size:"14px",fontFamily:"system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'",fontWeight:"500"}}},!0),"Bootstrap5Dark"===this.heatMap.theme&&this.heatMap.setProperties({tooltipSettings:{fill:"#E9ECEF",textStyle:{size:"14px",fontFamily:"system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'",fontWeight:"500",color:"#212529"}}},!0),this.tooltipObject=new H.g({opacity:"Tailwind"==this.heatMap.theme||"TailwindDark"===this.heatMap.theme||"Bootstrap5"===this.heatMap.theme||"Bootstrap5Dark"===this.heatMap.theme?1:.75,enableAnimation:!1,offset:a,location:{x:t,y:i},availableSize:this.heatMap.availableSize,data:{xValue:this.heatMap.heatMapSeries.hoverXAxisValue,yValue:this.heatMap.heatMapSeries.hoverYAxisValue,value:e.value,xLabel:this.heatMap.heatMapSeries.hoverXAxisLabel?this.heatMap.heatMapSeries.hoverXAxisLabel.toString():null,yLabel:this.heatMap.heatMapSeries.hoverYAxisLabel?this.heatMap.heatMapSeries.hoverYAxisLabel.toString():null},theme:this.heatMap.theme,content:l,fill:this.heatMap.tooltipSettings.fill,template:""===this.heatMap.tooltipSettings.template?null:this.heatMap.tooltipSettings.template,border:{width:this.heatMap.tooltipSettings.border.width,color:this.heatMap.tooltipSettings.border.color},textStyle:{size:this.heatMap.tooltipSettings.textStyle.size,fontWeight:this.heatMap.tooltipSettings.textStyle.fontWeight.toLowerCase(),color:this.heatMap.tooltipSettings.textStyle.color,fontStyle:this.heatMap.tooltipSettings.textStyle.fontStyle.toLowerCase(),fontFamily:this.heatMap.tooltipSettings.textStyle.fontFamily},areaBounds:{height:this.heatMap.initialClipRect.height+this.heatMap.initialClipRect.y,width:this.heatMap.initialClipRect.width,x:this.heatMap.initialClipRect.x}},s)}createTooltipDiv(e){const t=e.enableCanvasRendering&&e.allowSelection?e.availableSize.height:0,i=Object(B.p)("div",{id:this.heatMap.element.id+"Celltooltipcontainer",styles:"position:absolute; z-index: 3;top:-"+t+"px"});this.heatMap.element.appendChild(Object(B.p)("div",{id:this.heatMap.element.id+"Celltooltipparent",styles:"position:relative"}).appendChild(i))}getTooltipContent(e,t){let i,l;const a=this.heatMap,s=this.heatMap.dataSourceSettings;if(a.bubbleSizeWithColor){const n=a.xAxis.title&&""!==a.xAxis.title.text?a.xAxis.title.text:"X-Axis",o=a.yAxis.title&&""!==a.yAxis.title.text?a.yAxis.title.text:"Y-Axis",h=s.isJsonData&&"Cell"===s.adaptorType?s.bubbleDataMapping.size:"Value 1",r=s.isJsonData&&"Cell"===s.adaptorType?s.bubbleDataMapping.color:"Value 2";i=t.getFormatedText(e.value[0].bubbleData,this.heatMap.cellSettings.format),l=[n+" : "+t.hoverXAxisLabel+"<br/>"+o+" : "+t.hoverYAxisLabel+"<br/>"+h+" : "+i+"<br/>"+r+" : "+t.getFormatedText(e.value[1].bubbleData,this.heatMap.cellSettings.format)]}else i=e.value,l=[t.hoverXAxisLabel+" | "+t.hoverYAxisLabel+" : "+t.getFormatedText(i,this.heatMap.cellSettings.format)];return l}renderTooltip(e){const t=this.heatMap.heatMapSeries;let i=[""];if(this.heatMap.bubbleSizeWithColor?Object(B.u)(e.value)||Object(B.u)(e.value[0].bubbleData)||""===e.value[0].bubbleData.toString():Object(B.u)(e.value)||!Object(B.u)(e.value)&&""===e.value.toString())this.showHideTooltip(!1,!1),e.visible||this.showHideTooltip(!1,!1);else if(Object(B.u)(this.heatMap.tooltipRender))i=this.getTooltipContent(e,t),this.tooltipCallback(e,i);else{const l=this.getTooltipContent(e,t),a={heatmap:this.heatMap,cancel:!1,name:"tooltipRender",value:e.value,xValue:this.heatMap.heatMapSeries.hoverXAxisValue,yValue:this.heatMap.heatMapSeries.hoverYAxisValue,xLabel:this.heatMap.heatMapSeries.hoverXAxisLabel?this.heatMap.heatMapSeries.hoverXAxisLabel.toString():null,yLabel:this.heatMap.heatMapSeries.hoverYAxisLabel?this.heatMap.heatMapSeries.hoverYAxisLabel.toString():null,content:l};this.heatMap.trigger("tooltipRender",a,t=>{t.cancel?this.tooltipObject&&this.showHideTooltip(!1):(i=t.content,this.tooltipCallback(e,i))})}}tooltipCallback(e,t){this.tooltipObject?(this.tooltipObject.content=t,this.tooltipObject.data={xValue:this.heatMap.heatMapSeries.hoverXAxisValue,yValue:this.heatMap.heatMapSeries.hoverYAxisValue,xLabel:this.heatMap.heatMapSeries.hoverXAxisLabel?this.heatMap.heatMapSeries.hoverXAxisLabel.toString():null,yLabel:this.heatMap.heatMapSeries.hoverYAxisLabel?this.heatMap.heatMapSeries.hoverYAxisLabel.toString():null,value:e.value}):this.createTooltip(e,e.x+e.width/2,e.y+e.height/2,t),this.showHideTooltip(!0),this.tooltipObject.enableAnimation=!this.isFirst&&!this.isFadeout,this.isFirst=!this.isFirst&&this.isFirst,this.isFadeout=!this.isFadeout&&this.isFadeout,this.tooltipObject.location.x=e.x+e.width/2,this.tooltipObject.location.y=e.y+e.height/2,e.visible||this.showHideTooltip(!1,!1)}}},yt={provide:"HeatMapAdaptor",useValue:class{constructor(e){this.reconstructedXAxis=[],this.reconstructedYAxis=[],this.adaptiveXMinMax=new rt,this.adaptiveYMinMax=new rt,this.heatMap=e}constructDatasource(e,t){if("Cell"===t.adaptorType){const i=this.heatMap.xAxis,l=this.heatMap.yAxis;this.adaptiveXMinMax.min=i.minimum,this.adaptiveXMinMax.max=i.maximum,this.adaptiveYMinMax.min=l.minimum,this.adaptiveYMinMax.max=l.maximum,("Numeric"!==i.valueType&&"DateTime"!==i.valueType||!Object(B.u)(i.minimum)&&!Object(B.u)(i.maximum))&&("Numeric"!==l.valueType&&"DateTime"!==l.valueType||!Object(B.u)(l.minimum)&&!Object(B.u)(l.maximum))||this.getMinMaxValue(e,t,i,l),this.heatMap.isCellData=!0}"None"===t.adaptorType?this.heatMap.completeAdaptDataSource=e:t.isJsonData||"Table"!==t.adaptorType?t.isJsonData&&"Table"===t.adaptorType?this.heatMap.completeAdaptDataSource=this.processJsonTableData(e,t):t.isJsonData&&"Cell"===t.adaptorType?this.heatMap.completeAdaptDataSource=this.processJsonCellData(e,t):t.isJsonData||"Cell"!==t.adaptorType||(this.constructAdaptiveAxis(),this.heatMap.completeAdaptDataSource=this.processCellData(e),this.heatMap.isCellData=!0):this.heatMap.completeAdaptDataSource=e}constructAdaptiveAxis(){const e=this.heatMap.xAxis,t=this.heatMap.yAxis;"Numeric"===e.valueType&&(this.reconstructedXAxis=this.getNumericAxisCollection(this.adaptiveXMinMax.min,this.adaptiveXMinMax.max,e.increment)),"Numeric"===t.valueType&&(this.reconstructedYAxis=this.getNumericAxisCollection(this.adaptiveYMinMax.min,this.adaptiveYMinMax.max,t.increment)),"DateTime"===e.valueType&&(this.reconstructedXAxis=this.getDateAxisCollection(this.adaptiveXMinMax.min,this.adaptiveXMinMax.max,e.intervalType,e.increment)),"DateTime"===t.valueType&&(this.reconstructedYAxis=this.getDateAxisCollection(this.adaptiveYMinMax.min,this.adaptiveYMinMax.max,t.intervalType,t.increment))}getNumericAxisCollection(e,t,i){let l=e;const a=[];for(;l<=t;)a.push(l.toString()),l+=i;return a}getDateAxisCollection(e,t,i,l){const a={skeleton:"full",type:"dateTime"},s=this.heatMap.intl.getDateParser(a),n=this.heatMap.intl.getDateFormat(a);let o=e=Date.parse(s(n(new Date(k.b.parse.parseJson({val:e}).val))));const h=[];for(;o<=t;)h.push(new Date(o).toString()),o=Ge(o,1,i,l).getTime();return h}getMinMaxValue(e,t,i,l){const a=e,s=Object.keys(a[0]);a.length>0&&(this.adaptiveXMinMax.min=Object(B.u)(i.minimum)?t.isJsonData?a[0][s[0]]:a[0][0]:i.minimum,this.adaptiveYMinMax.min=Object(B.u)(l.minimum)?t.isJsonData?a[0][s[1]]:a[0][1]:l.minimum,this.adaptiveXMinMax.max=Object(B.u)(i.maximum)?t.isJsonData?a[0][s[0]]:a[0][0]:i.maximum,this.adaptiveYMinMax.max=Object(B.u)(l.maximum)?t.isJsonData?a[0][s[1]]:a[0][1]:l.maximum);for(let n=0;n<a.length;n++){const e=t.isJsonData?a[n][s[0]]:a[n][0],o=t.isJsonData?a[n][s[1]]:a[n][1];e<this.adaptiveXMinMax.min&&Object(B.u)(i.minimum)&&(this.adaptiveXMinMax.min=e),e>this.adaptiveXMinMax.max&&Object(B.u)(i.maximum)&&(this.adaptiveXMinMax.max=e),o<this.adaptiveYMinMax.min&&Object(B.u)(l.minimum)&&(this.adaptiveYMinMax.min=o),o>this.adaptiveYMinMax.max&&Object(B.u)(l.maximum)&&(this.adaptiveYMinMax.max=o)}}processCellData(e){const t=e,i=this.reconstructedXAxis,l=this.reconstructedYAxis;let a=0,s=0;if(this.reconstructData=[],t&&t.length)for(let n=0;n<t.length;n++)if(a="Category"===this.heatMap.xAxis.valueType?t[n][0]:i.indexOf(t[n][0].toString()),a>-1){for(;!this.reconstructData[a];)this.reconstructData.push([]);if(s="Category"===this.heatMap.yAxis.valueType?t[n][1]:l.indexOf(t[n][1].toString()),-1!==s){for(;""!==this.reconstructData[a][s];)this.reconstructData[a].push("");this.reconstructData[a][s]=Object(B.u)(t[n][2])?"":t[n][2]}}return this.reconstructData}processJsonCellData(e,t){const i=e,l=this.heatMap.xAxis.labels?this.heatMap.xAxis.labels:[],a=this.heatMap.yAxis.labels?this.heatMap.yAxis.labels:[],s=this.heatMap.axisCollections;0!==l.length&&0!==a.length||this.generateAxisLabels(e,t);const n="Category"===this.heatMap.xAxis.valueType?l.length>0?this.heatMap.xAxis.labels:s[0].jsonCellLabel:s[0].labelValue,o="Category"===this.heatMap.yAxis.valueType?a.length>0?this.heatMap.yAxis.labels:s[1].jsonCellLabel:s[1].labelValue;let h=0,r=0;if(i.length){this.reconstructData=[];for(let e=0;e<i.length;e++)if(h=this.getSplitDataValue(i[e],t,n,t.xDataMapping.split("."),this.heatMap.xAxis.valueType),-1!==h){for(;!this.reconstructData[h];)this.reconstructData.push([]);if(r=this.getSplitDataValue(i[e],t,o,t.yDataMapping.split("."),this.heatMap.yAxis.valueType),-1!==r){for(;Object(B.u)(this.reconstructData[h][r]);)this.reconstructData[h].push("");this.reconstructData[h][r]=this.heatMap.bubbleSizeWithColor?[this.getSplitDataValue(i[e],t,null,t.bubbleDataMapping.size.split("."),""),this.getSplitDataValue(i[e],t,null,t.bubbleDataMapping.color.split("."),"")]:this.getSplitDataValue(i[e],t,null,t.valueMapping.split("."),"")}}}return this.reconstructData}generateAxisLabels(e,t){const i=e,l=(this.heatMap.xAxis.labels?this.heatMap.xAxis.labels:[]).length>0,a=(this.heatMap.yAxis.labels?this.heatMap.yAxis.labels:[]).length>0,s=this.heatMap.axisCollections;for(let n=0;n<s.length;n++){const e=s[n].valueType,o=s[n];if("Category"===e){let e,s,n;if("Horizontal"===o.orientation?(e=l,s=t.xDataMapping,o.jsonCellLabel=n=[]):(e=a,s=t.yDataMapping,o.jsonCellLabel=n=[]),!e)for(let t=0;t<i.length;t++)if(s in i[t]){const e=i[t][s].toString();-1===n.indexOf(e.toString())&&n.push(e)}}else"DateTime"===e?(o.clearAxisLabel(),o.calculateDateTimeAxisLabel(this.heatMap)):(o.clearAxisLabel(),o.calculateNumericAxisLabels(this.heatMap))}}getSplitDataValue(e,t,i,l,a){let s=-1;this.tempSplitDataCollection=e;for(let n=0;n<l.length&&(s=Object(B.u)(i)?null:"DateTime"!==a?i.indexOf(this.tempSplitDataCollection[l[n]]):i.map(Number).indexOf(+this.tempSplitDataCollection[l[n]]),Object(B.u)(this.tempSplitDataCollection)||(this.tempSplitDataCollection=-1===s||Object(B.u)(i)?this.tempSplitDataCollection[l[n]]:this.tempSplitDataCollection),!Object(B.u)(this.tempSplitDataCollection));n++);return s=Object(B.u)(i)?Object(B.u)(this.tempSplitDataCollection)||""===this.tempSplitDataCollection.toString()?"":parseFloat(this.tempSplitDataCollection.toString()):s,s}processJsonTableData(e,t){const i=e;let l=0,a=0;const s=this.heatMap.xAxis.labels?this.heatMap.xAxis.labels:[],n=this.heatMap.yAxis.labels?this.heatMap.yAxis.labels:[];let o;if(i.length){this.reconstructData=[];for(let e=0;e<i.length;e++)if(l=this.getSplitDataValue(i[e],t,s,t.xDataMapping.split("."),this.heatMap.xAxis.valueType),-1!==l){for(;!this.reconstructData[l];)this.reconstructData.push([]);for(let e=0;e<Object.keys(this.tempSplitDataCollection).length;e++)if(o=Object.keys(this.tempSplitDataCollection)[e],a=o!==t.xDataMapping?n.indexOf(o):-1,-1!==a){for(;Object(B.u)(this.reconstructData[l][a]);)this.reconstructData[l].push("");this.reconstructData[l][a]=Object(B.u)(this.tempSplitDataCollection[o])?"":this.tempSplitDataCollection[o]}}}return this.reconstructData}destroy(){}getModuleName(){return"Adaptor"}}};let Mt=(()=>{class e{constructor(e,t,i,l){this._store=e,this._escalaService=t,this._catalogoService=i,this._dialog=l,this.paletaMapa=[],this.titleSettings={text:"Mapa de Riesgo Inherente",textStyle:{size:"15px",fontWeight:"500",fontStyle:"Normal",fontFamily:"Segoe UI"}},this.dataSourceSettings={isJsonData:!0,adaptorType:"Cell",xDataMapping:"frecuencia",yDataMapping:"impacto",valueMapping:"riesgo"},this.cellSettings={border:{radius:4,width:1,color:"white"},showLabel:!0},this.legendSettings={position:"Bottom"}}ngOnInit(){this.cargaEscalaColor(),this.cargaFI(),this.cargaMapaRI()}ngOnDestroy(){this.mapaRISubs&&this.mapaRISubs.unsubscribe()}cargaMapaRI(){this._store.dispatch(n.v()),this.mapaRISubs=this._store.select("mapa").subscribe(e=>{this.dataSource=e.mapa})}cargaEscalaColor(){this._escalaService.getEscalaColores().subscribe(e=>{this.escalaColor=e,this.escalaColor.forEach(e=>{this.paletaMapa.push({minColor:e.colorCell,maxColor:e.colorCell,label:e.descripcion,startValue:e.valorInicial,endValue:e.valorFinal})}),this.paletteSettings={palette:this.paletaMapa,type:"Gradient"}})}cargaFI(){let e=[],t=[],i=[],l=[];this._catalogoService.getCatalogoItems(6).subscribe(i=>{this.valoresFrecuencia=i,this.valoresFrecuencia.forEach(i=>{e.push(parseInt(i.codigo)),t.push({start:parseInt(i.codigo)-1,end:parseInt(i.codigo)-1,text:i.valor})}),this.xAxis={labels:e,multiLevelLabels:[{categories:t}],title:{text:"FRECUENCIA"}}}),this._catalogoService.getCatalogoItems(7).subscribe(e=>{this.valoresImpacto=e,this.valoresImpacto.forEach(e=>{i.push(parseInt(e.codigo)),l.push({start:parseInt(e.codigo)-1,end:parseInt(e.codigo)-1,text:e.valor})}),this.yAxis={labels:i,multiLevelLabels:[{categories:l}],title:{text:"IMPACTO"}}})}cellRender(e){let t=e.heatmap.dataSource,i=null==t?void 0:t.find(t=>t.frecuencia==parseInt(e.xLabel)&&t.impacto==parseInt(e.yLabel));e.displayText=(null==i?void 0:i.totalRiesgos)>0?null==i?void 0:i.totalRiesgos.toString():""}tooltipRender(e){let t=e.heatmap.dataSource,i=null==t?void 0:t.find(t=>t.frecuencia==parseInt(e.xLabel)&&t.impacto==parseInt(e.yLabel));e.content=["Riesgo inherente: "+e.value+" | Total riesgos: "+(null==i?void 0:i.totalRiesgos.toString())]}cellClicked(e){this._dialog.open(I,{width:"80%",disableClose:!1,data:{frecuencia:e.xLabel,impacto:e.yLabel,tipo:"I"}})}}return e.\u0275fac=function(t){return new(t||e)(s.Qb(c.h),s.Qb(E),s.Qb(_.a),s.Qb(o.b))},e.\u0275cmp=s.Kb({type:e,selectors:[["app-mapaRI"]],decls:1,vars:8,consts:[["id","container",2,"display","block",3,"dataSource","dataSourceSettings","xAxis","yAxis","cellSettings","titleSettings","paletteSettings","legendSettings","cellRender","tooltipRender","cellClick"]],template:function(e,t){1&e&&(s.Wb(0,"ejs-heatmap",0),s.dc("cellRender",function(e){return t.cellRender(e)})("tooltipRender",function(e){return t.tooltipRender(e)})("cellClick",function(e){return t.cellClicked(e)}),s.Vb()),2&e&&s.mc("dataSource",t.dataSource)("dataSourceSettings",t.dataSourceSettings)("xAxis",t.xAxis)("yAxis",t.yAxis)("cellSettings",t.cellSettings)("titleSettings",t.titleSettings)("paletteSettings",t.paletteSettings)("legendSettings",t.legendSettings)},directives:[mt],styles:[""]}),e})(),vt=(()=>{class e{constructor(e,t,i,l){this._store=e,this._escalaService=t,this._catalogoService=i,this._dialog=l,this.paletaMapa=[],this.titleSettingsRR={text:"Mapa de Riesgo Residual",textStyle:{size:"15px",fontWeight:"500",fontStyle:"Normal",fontFamily:"Segoe UI"}},this.dataSourceSettingsRR={isJsonData:!0,adaptorType:"Cell",xDataMapping:"frecuencia",yDataMapping:"impacto",valueMapping:"riesgo"},this.cellSettingsRR={border:{radius:4,width:1,color:"white"},showLabel:!0},this.legendSettingsRR={position:"Bottom"}}ngOnInit(){this.cargaEscalaColor(),this.cargaFI(),this.cargaMapaRR()}ngOnDestroy(){this.mapaRRSubs&&this.mapaRRSubs.unsubscribe()}cargaMapaRR(){this._store.dispatch(n.w()),this.mapaRRSubs=this._store.select("mapa").subscribe(e=>{this.dataSourceRR=e.mapaRR})}cargaEscalaColor(){this._escalaService.getEscalaColores().subscribe(e=>{this.escalaColor=e,this.escalaColor.forEach(e=>{this.paletaMapa.push({minColor:e.colorCell,maxColor:e.colorCell,label:e.descripcion,startValue:e.valorInicial,endValue:e.valorFinal})}),this.paletteSettingsRR={palette:this.paletaMapa,type:"Gradient"}})}cargaFI(){let e=[],t=[],i=[],l=[];this._catalogoService.getCatalogoItems(6).subscribe(i=>{this.valoresFrecuencia=i,this.valoresFrecuencia.forEach(i=>{e.push(parseInt(i.codigo)),t.push({start:parseInt(i.codigo)-1,end:parseInt(i.codigo)-1,text:i.valor})}),this.xAxisRR={labels:e,multiLevelLabels:[{categories:t}],title:{text:"FRECUENCIA"}}}),this._catalogoService.getCatalogoItems(7).subscribe(e=>{this.valoresImpacto=e,this.valoresImpacto.forEach(e=>{i.push(parseInt(e.codigo)),l.push({start:parseInt(e.codigo)-1,end:parseInt(e.codigo)-1,text:e.valor})}),this.yAxisRR={labels:i,multiLevelLabels:[{categories:l}],title:{text:"IMPACTO"}}})}cellRenderRR(e){let t=e.heatmap.dataSource,i=null==t?void 0:t.find(t=>t.frecuencia==parseInt(e.xLabel)&&t.impacto==parseInt(e.yLabel));e.displayText=(null==i?void 0:i.totalRiesgos)>0?null==i?void 0:i.totalRiesgos.toString():""}tooltipRenderRR(e){let t=e.heatmap.dataSource,i=null==t?void 0:t.find(t=>t.frecuencia==parseInt(e.xLabel)&&t.impacto==parseInt(e.yLabel));e.content=["Riesgo residual: "+e.value+" | Total riesgos: "+(null==i?void 0:i.totalRiesgos.toString())]}cellClickedRR(e){this._dialog.open(I,{width:"80%",disableClose:!1,data:{frecuencia:e.xLabel,impacto:e.yLabel,tipo:"R"}})}}return e.\u0275fac=function(t){return new(t||e)(s.Qb(c.h),s.Qb(E),s.Qb(_.a),s.Qb(o.b))},e.\u0275cmp=s.Kb({type:e,selectors:[["app-mapa-rr"]],decls:1,vars:8,consts:[["id","mapaRR",2,"display","block",3,"dataSource","dataSourceSettings","xAxis","yAxis","cellSettings","titleSettings","paletteSettings","legendSettings","cellRender","tooltipRender","cellClick"]],template:function(e,t){1&e&&(s.Wb(0,"ejs-heatmap",0),s.dc("cellRender",function(e){return t.cellRenderRR(e)})("tooltipRender",function(e){return t.tooltipRenderRR(e)})("cellClick",function(e){return t.cellClickedRR(e)}),s.Vb()),2&e&&s.mc("dataSource",t.dataSourceRR)("dataSourceSettings",t.dataSourceSettingsRR)("xAxis",t.xAxisRR)("yAxis",t.yAxisRR)("cellSettings",t.cellSettingsRR)("titleSettings",t.titleSettingsRR)("paletteSettings",t.paletteSettingsRR)("legendSettings",t.legendSettingsRR)},directives:[mt],styles:[""]}),e})();const ft=[{path:"",children:[{path:"mapas",component:(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Kb({type:e,selectors:[["app-mapas"]],decls:4,vars:0,consts:[[1,"col-sm-12","col-md-6"]],template:function(e,t){1&e&&(s.Wb(0,"div",0),s.Rb(1,"app-mapaRI"),s.Vb(),s.Wb(2,"div",0),s.Rb(3,"app-mapa-rr"),s.Vb())},directives:[Mt,vt],styles:[""]}),e})()},{path:"**",redirectTo:"mapas"}]}];let wt=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.Ob({type:e}),e.\u0275inj=s.Nb({imports:[[a.e.forChild(ft)],a.e]}),e})();var Rt=i("kX6E"),Lt=i("Af5F");let Tt=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.Ob({type:e}),e.\u0275inj=s.Nb({providers:[St,Ct,yt],imports:[[l.c,wt,xt,c.j.forFeature("mapa",Rt.a),c.j.forFeature("riesgo",Lt.a),o.g,h.p,r.b,d.c]]}),e})()}}]);