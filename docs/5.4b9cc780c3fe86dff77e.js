(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{YFW5:function(e,t,r){"use strict";r.d(t,"a",function(){return y}),r.d(t,"c",function(){return m}),r.d(t,"e",function(){return a}),r.d(t,"d",function(){return o}),r.d(t,"f",function(){return d}),r.d(t,"b",function(){return i});var s=r("h+i/");class a{constructor(e){return this.subQuery=null,this.isChild=!1,this.distincts=[],this.queries=[],this.key="",this.fKey="","string"==typeof e?this.fromTable=e:e&&e instanceof Array&&(this.lookups=e),this.expands=[],this.sortedColumns=[],this.groupedColumns=[],this.subQuery=null,this.isChild=!1,this.params=[],this.lazyLoad=[],this}setKey(e){return this.key=e,this}using(e){return this.dataManager=e,this}execute(e,t,r,s){return(e=e||this.dataManager)?e.executeQuery(this,t,r,s):i.throwError('Query - execute() : dataManager needs to be is set using "using" function or should be passed as argument')}executeLocal(e){return(e=e||this.dataManager)?e.executeLocal(this):i.throwError('Query - executeLocal() : dataManager needs to be is set using "using" function or should be passed as argument')}clone(){let e=new a;return e.queries=this.queries.slice(0),e.key=this.key,e.isChild=this.isChild,e.dataManager=this.dataManager,e.fromTable=this.fromTable,e.params=this.params.slice(0),e.expands=this.expands.slice(0),e.sortedColumns=this.sortedColumns.slice(0),e.groupedColumns=this.groupedColumns.slice(0),e.subQuerySelector=this.subQuerySelector,e.subQuery=this.subQuery,e.fKey=this.fKey,e.isCountRequired=this.isCountRequired,e.distincts=this.distincts.slice(0),e.lazyLoad=this.lazyLoad.slice(0),e}from(e){return this.fromTable=e,this}addParams(e,t){return this.params.push("function"==typeof t?{key:e,fn:t}:{key:e,value:t}),this}distinct(e){return this.distincts="string"==typeof e?[].slice.call([e],0):e.slice(0),this}expand(e){return this.expands="string"==typeof e?[].slice.call([e],0):e.slice(0),this}where(e,t,r,s,a){t=t?t.toLowerCase():null;let n=null;return"string"==typeof e?n=new o(e,t,r,s,a):e instanceof o&&(n=e),this.queries.push({fn:"onWhere",e:n}),this}search(e,t,r,s,a){return"string"==typeof t&&(t=[t]),r&&"none"!==r||(r="contains"),this.queries.push({fn:"onSearch",e:{fieldNames:t,operator:r,searchKey:e,ignoreCase:s,ignoreAccent:a,comparer:i.fnOperators[r]}}),this}sortBy(e,t,r){return this.sortByForeignKey(e,t,r)}sortByForeignKey(e,t,r,o){let n,l,u=Object(s.u)(o)?"ascending":o;if("string"==typeof e&&i.endsWith(e.toLowerCase()," desc")&&(e=e.replace(/ desc$/i,""),t="descending"),t&&"string"!=typeof t||(u=t?t.toLowerCase():"ascending",t=i.fnSort(t)),r){n=a.filterQueries(this.queries,"onSortBy");for(let t=0;t<n.length;t++)if(l=n[t].e.fieldName,"string"==typeof l){if(l===e)return this}else if(l instanceof Array)for(let r=0;r<l.length;r++)if(l[r]===e||e.toLowerCase()===l[r]+" desc")return this}return this.queries.push({fn:"onSortBy",e:{fieldName:e,comparer:t,direction:u}}),this}sortByDesc(e){return this.sortBy(e,"descending")}group(e,t,r){return this.sortBy(e,null,!0),this.queries.push({fn:"onGroup",e:{fieldName:e,comparer:t||null,format:r||null}}),this}page(e,t){return this.queries.push({fn:"onPage",e:{pageIndex:e,pageSize:t}}),this}range(e,t){return this.queries.push({fn:"onRange",e:{start:e,end:t}}),this}take(e){return this.queries.push({fn:"onTake",e:{nos:e}}),this}skip(e){return this.queries.push({fn:"onSkip",e:{nos:e}}),this}select(e){return"string"==typeof e&&(e=[].slice.call([e],0)),this.queries.push({fn:"onSelect",e:{fieldNames:e}}),this}hierarchy(e,t){return this.subQuerySelector=t,this.subQuery=e,this}foreignKey(e){return this.fKey=e,this}requiresCount(){return this.isCountRequired=!0,this}aggregate(e,t){return this.queries.push({fn:"onAggregates",e:{field:t,type:e}}),this}static filterQueries(e,t){return e.filter(e=>e.fn===t)}static filterQueryLists(e,t){let r=e.filter(e=>-1!==t.indexOf(e.fn)),s={};for(let a=0;a<r.length;a++)s[r[a].fn]||(s[r[a].fn]=r[a].e);return s}}class o{constructor(e,t,r,s=!1,a){return this.ignoreAccent=!1,this.isComplex=!1,"string"==typeof e?(this.field=e,this.operator=t.toLowerCase(),this.value=r,this.ignoreCase=s,this.ignoreAccent=a,this.isComplex=!1,this.comparer=i.fnOperators.processOperator(this.operator)):(e instanceof o&&r instanceof o||r instanceof Array)&&(this.isComplex=!0,this.condition=t.toLowerCase(),this.predicates=[e],r instanceof Array?[].push.apply(this.predicates,r):this.predicates.push(r)),this}static and(...e){return o.combinePredicates([].slice.call(e,0),"and")}and(e,t,r,s,a){return o.combine(this,e,t,r,"and",s,a)}static or(...e){return o.combinePredicates([].slice.call(e,0),"or")}or(e,t,r,s,a){return o.combine(this,e,t,r,"or",s,a)}static fromJson(e){if(e instanceof Array){let t=[];for(let r=0,s=e.length;r<s;r++)t.push(this.fromJSONData(e[r]));return t}return this.fromJSONData(e)}validate(e){let t,r,s=this.predicates?this.predicates:[];if(!this.isComplex&&this.comparer)return this.comparer.call(this,i.getObject(this.field,e),this.value,this.ignoreCase,this.ignoreAccent);t="and"===this.condition;for(let a=0;a<s.length;a++)if(r=s[a].validate(e),t){if(!r)return!1}else if(r)return!0;return t}toJson(){let e,t;if(this.isComplex){e=[],t=this.predicates;for(let r=0;r<t.length;r++)e.push(t[r].toJson())}return{isComplex:this.isComplex,field:this.field,operator:this.operator,value:this.value,ignoreCase:this.ignoreCase,ignoreAccent:this.ignoreAccent,condition:this.condition,predicates:e}}static combinePredicates(e,t){if(1===e.length){if(!(e[0]instanceof Array))return e[0];e=e[0]}return new o(e[0],t,e.slice(1))}static combine(e,t,r,s,a,n,l){return t instanceof o?o[a](e,t):"string"==typeof t?o[a](e,new o(t,r,s,n,l)):i.throwError("Predicate - "+a+" : invalid arguments")}static fromJSONData(e){let t,r=e.predicates||[],s=r.length,a=[];for(let o=0;o<s;o++)a.push(this.fromJSONData(r[o]));return t=e.isComplex?new o(a[0],e.condition,a.slice(1)):new o(e.field,e.operator,e.value,e.ignoreCase,e.ignoreAccent),t}}const n={GroupGuid:"{271bbba0-1ee7}"};let i=(()=>{class e{static getValue(e,t){return"function"==typeof e?e.call(t||{}):e}static endsWith(e,t){return e.slice&&e.slice(-t.length)===t}static startsWith(e,t){return e.slice(0,t.length)===t}static fnSort(t){return"ascending"===(t=t?e.toLowerCase(t):"ascending")?this.fnAscending:this.fnDescending}static fnAscending(e,t){return Object(s.u)(e)&&Object(s.u)(t)||null==t?-1:"string"==typeof e?e.localeCompare(t):null==e?1:e-t}static fnDescending(e,t){return Object(s.u)(e)&&Object(s.u)(t)?-1:null==t?1:"string"==typeof e?-1*e.localeCompare(t):null==e?-1:t-e}static extractFields(e,t){let r={};for(let s=0;s<t.length;s++)r=this.setValue(t[s],this.getObject(t[s],e),r);return r}static select(e,t){let r=[];for(let s=0;s<e.length;s++)r.push(this.extractFields(e[s],t));return r}static group(t,r,a,o,i,l,u){o=o||1;let c=t,d="GroupGuid";if(c.GroupGuid===n[d]){for(let e=0;e<c.length;e++)if(Object(s.u)(i))c[e].items=this.group(c[e].items,r,a,c.level+1,null,l,u),c[e].count=c[e].items.length;else{let t=-1,s=i.filter(t=>t.key===c[e].key);t=i.indexOf(s[0]),c[e].items=this.group(c[e].items,r,a,c.level+1,i[t].items,l,u),c[e].count=i[t].count}return c.childLevels+=1,c}let h={},p=[];p.GroupGuid=n[d],p.level=o,p.childLevels=0,p.records=c;for(let e=0;e<c.length;e++){let t=this.getVal(c,e,r);if(Object(s.u)(l)||(t=l(t,r)),!h[t]&&(h[t]={key:t,count:0,items:[],aggregates:{},field:r},p.push(h[t]),!Object(s.u)(i))){let e=i.filter(e=>e.key===h[t].key);h[t].count=e[0].count}h[t].count=Object(s.u)(i)?h[t].count+=1:h[t].count,(!u||u&&a.length)&&h[t].items.push(c[e])}if(a&&a.length)for(let n=0;n<p.length;n++){let t,r={},o=a;for(let l=0;l<a.length;l++)if(t=e.aggregates[a[l].type],Object(s.u)(i))t&&(r[o[l].field+" - "+o[l].type]=t(p[n].items,o[l].field));else{let e=i.filter(e=>e.key===p[n].key);t&&(r[o[l].field+" - "+o[l].type]=t(e[0].items,o[l].field))}p[n].aggregates=r}if(u&&p.length&&a.length)for(let e=0;e<p.length;e++)p[e].items=[];return c.length&&p||c}static buildHierarchy(e,t,r,s,a){let o,n,i={};for(s.result&&(s=s.result),s.GroupGuid&&this.throwError("DataManager: Do not have support Grouping in hierarchy"),o=0;o<s.length;o++){let t=this.getObject(e,s[o]);n=i[t]||(i[t]=[]),n.push(s[o])}for(o=0;o<r.length;o++){let s=this.getObject(a||e,r[o]);r[o][t]=i[s]}}static getFieldList(e,t,r){if(void 0===r&&(r=""),null==t)return this.getFieldList(e,[],r);let s=e,a=Object.keys(e);for(let o of a)"object"!=typeof s[o]||s[o]instanceof Array?t.push(r+o):this.getFieldList(s[o],t,r+o+".");return t}static getObject(e,t){if(!e)return t;if(!t)return;if(-1===e.indexOf("."))return t[e];let r=t,s=e.split(".");for(let a=0;a<s.length&&null!=r;a++)r=r[s[a]];return r}static setValue(e,t,r){let a,o,n=e.toString().split("."),i=r||{},l=i,u=n.length;for(a=0;a<u;a++)o=n[a],a+1===u?l[o]=void 0===t?void 0:t:Object(s.u)(l[o])&&(l[o]={}),l=l[o];return i}static sort(e,t,r){if(e.length<=1)return e;let s=parseInt((e.length/2).toString(),10),a=e.slice(0,s),o=e.slice(s);return a=this.sort(a,t,r),o=this.sort(o,t,r),this.merge(a,o,t,r)}static ignoreDiacritics(t){return"string"!=typeof t?t:t.split("").map(t=>t in e.diacritics?e.diacritics[t]:t).join("")}static merge(e,t,r,s){let a,o=[];for(;e.length>0||t.length>0;)a=e.length>0&&t.length>0?s?s(this.getVal(e,0,r),this.getVal(t,0,r),e[0],t[0])<=0?e:t:e[0][r]<e[0][r]?e:t:e.length>0?e:t,o.push(a.shift());return o}static getVal(e,t,r){return r?this.getObject(r,e[t]):e[t]}static toLowerCase(e){return e?"string"==typeof e?e.toLowerCase():e.toString():0===e||!1===e?e.toString():""}static callAdaptorFunction(e,t,r,a){if(t in e){let o=e[t](r,a);Object(s.u)(o)||(r=o)}return r}static getAddParams(t,r,s){let a={};return e.callAdaptorFunction(t,"addParams",{dm:r,query:s,params:s.params,reqParams:a}),a}static isPlainObject(e){return!!e&&e.constructor===Object}static isCors(){let e=null;try{e=new window.XMLHttpRequest}catch(t){}return!!e&&"withCredentials"in e}static getGuid(e){let t;return(e||"")+"00000000-0000-4000-0000-000000000000".replace(/0/g,(e,r)=>{if("crypto"in window&&"getRandomValues"in crypto){let e=new Uint8Array(1);window.crypto.getRandomValues(e),t=e[0]%16|0}else t=16*Math.random()|0;return"0123456789abcdef"[19===r?3&t|8:t]})}static isNull(e){return null==e}static getItemFromComparer(t,r,a){let o,n,i,l=0,u="string"==typeof e.getVal(t,0,r);if(t.length)for(;Object(s.u)(o)&&l<t.length;)o=e.getVal(t,l,r),i=t[l++];for(;l<t.length;l++)n=e.getVal(t,l,r),Object(s.u)(n)||(u&&(o=+o,n=+n),a(o,n)>0&&(o=n,i=t[l]));return i}static distinct(t,r,a){a=!Object(s.u)(a)&&a;let o,n=[],i={};return t.forEach((s,l)=>{o="object"==typeof t[l]?e.getVal(t,l,r):t[l],o in i||(n.push(a?t[l]:o),i[o]=1)}),n}static processData(e,t){let r=this.prepareQuery(e),s=new y(t);e.requiresCounts&&r.requiresCount();let a=s.executeLocal(r),o={result:e.requiresCounts?a.result:a,count:a.count,aggregates:JSON.stringify(a.aggregates)};return e.requiresCounts?o:a}static prepareQuery(t){let r=new a;return t.select&&r.select(t.select),t.where&&e.parse.parseJson(t.where).filter(e=>{if(Object(s.u)(e.condition))r.where(e.field,e.operator,e.value,e.ignoreCase,e.ignoreAccent);else{let t=[];e.field?t.push(new o(e.field,e.operator,e.value,e.ignoreCase,e.ignoreAccent)):t=t.concat(this.getPredicate(e.predicates)),"or"==e.condition?r.where(o.or(t)):"and"==e.condition&&r.where(o.and(t))}}),t.search&&e.parse.parseJson(t.search).filter(e=>r.search(e.key,e.fields,e.operator,e.ignoreCase,e.ignoreAccent)),t.aggregates&&t.aggregates.filter(e=>r.aggregate(e.type,e.field)),t.sorted&&t.sorted.filter(e=>r.sortBy(e.name,e.direction)),t.skip&&r.skip(t.skip),t.take&&r.take(t.take),t.group&&t.group.filter(e=>r.group(e)),r}static getPredicate(e){let t=[];for(let r=0;r<e.length;r++){let s=e[r];if(s.field)t.push(new o(s.field,s.operator,s.value,s.ignoreCase,s.ignoreAccent));else{let e=[],r=this.getPredicate(s.predicates);for(const t of Object.keys(r))e.push(r[t]);t.push("or"==s.condition?o.or(e):o.and(e))}}return t}}return e.serverTimezoneOffset=null,e.timeZoneHandling=!0,e.throwError=e=>{try{throw new Error(e)}catch(t){throw t.message+"\n"+t.stack}},e.aggregates={sum:(t,r)=>{let s,a=0,o="number"!=typeof e.getVal(t,0,r);for(let n=0;n<t.length;n++)s=e.getVal(t,n,r),isNaN(s)||null===s||(o&&(s=+s),a+=s);return a},average:(t,r)=>e.aggregates.sum(t,r)/t.length,min:(t,r)=>{let s;return"function"==typeof r&&(s=r,r=null),e.getObject(r,e.getItemFromComparer(t,r,s||e.fnAscending))},max:(t,r)=>{let s;return"function"==typeof r&&(s=r,r=null),e.getObject(r,e.getItemFromComparer(t,r,s||e.fnDescending))},truecount:(e,t)=>new y(e).executeLocal((new a).where(t,"equal",!0,!0)).length,falsecount:(e,t)=>new y(e).executeLocal((new a).where(t,"equal",!1,!0)).length,count:(e,t)=>e.length},e.operatorSymbols={"<":"lessthan",">":"greaterthan","<=":"lessthanorequal",">=":"greaterthanorequal","==":"equal","!=":"notequal","*=":"contains","$=":"endswith","^=":"startswith"},e.odBiOperator={"<":" lt ",">":" gt ","<=":" le ",">=":" ge ","==":" eq ","!=":" ne ",lessthan:" lt ",lessthanorequal:" le ",greaterthan:" gt ",greaterthanorequal:" ge ",equal:" eq ",notequal:" ne "},e.odUniOperator={"$=":"endswith","^=":"startswith","*=":"substringof",endswith:"endswith",startswith:"startswith",contains:"substringof"},e.odv4UniOperator={"$=":"endswith","^=":"startswith","*=":"contains",endswith:"endswith",startswith:"startswith",contains:"contains"},e.diacritics={"\u24b6":"A","\uff21":"A","\xc0":"A","\xc1":"A","\xc2":"A","\u1ea6":"A","\u1ea4":"A","\u1eaa":"A","\u1ea8":"A","\xc3":"A","\u0100":"A","\u0102":"A","\u1eb0":"A","\u1eae":"A","\u1eb4":"A","\u1eb2":"A","\u0226":"A","\u01e0":"A","\xc4":"A","\u01de":"A","\u1ea2":"A","\xc5":"A","\u01fa":"A","\u01cd":"A","\u0200":"A","\u0202":"A","\u1ea0":"A","\u1eac":"A","\u1eb6":"A","\u1e00":"A","\u0104":"A","\u023a":"A","\u2c6f":"A","\ua732":"AA","\xc6":"AE","\u01fc":"AE","\u01e2":"AE","\ua734":"AO","\ua736":"AU","\ua738":"AV","\ua73a":"AV","\ua73c":"AY","\u24b7":"B","\uff22":"B","\u1e02":"B","\u1e04":"B","\u1e06":"B","\u0243":"B","\u0182":"B","\u0181":"B","\u24b8":"C","\uff23":"C","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\xc7":"C","\u1e08":"C","\u0187":"C","\u023b":"C","\ua73e":"C","\u24b9":"D","\uff24":"D","\u1e0a":"D","\u010e":"D","\u1e0c":"D","\u1e10":"D","\u1e12":"D","\u1e0e":"D","\u0110":"D","\u018b":"D","\u018a":"D","\u0189":"D","\ua779":"D","\u01f1":"DZ","\u01c4":"DZ","\u01f2":"Dz","\u01c5":"Dz","\u24ba":"E","\uff25":"E","\xc8":"E","\xc9":"E","\xca":"E","\u1ec0":"E","\u1ebe":"E","\u1ec4":"E","\u1ec2":"E","\u1ebc":"E","\u0112":"E","\u1e14":"E","\u1e16":"E","\u0114":"E","\u0116":"E","\xcb":"E","\u1eba":"E","\u011a":"E","\u0204":"E","\u0206":"E","\u1eb8":"E","\u1ec6":"E","\u0228":"E","\u1e1c":"E","\u0118":"E","\u1e18":"E","\u1e1a":"E","\u0190":"E","\u018e":"E","\u24bb":"F","\uff26":"F","\u1e1e":"F","\u0191":"F","\ua77b":"F","\u24bc":"G","\uff27":"G","\u01f4":"G","\u011c":"G","\u1e20":"G","\u011e":"G","\u0120":"G","\u01e6":"G","\u0122":"G","\u01e4":"G","\u0193":"G","\ua7a0":"G","\ua77d":"G","\ua77e":"G","\u24bd":"H","\uff28":"H","\u0124":"H","\u1e22":"H","\u1e26":"H","\u021e":"H","\u1e24":"H","\u1e28":"H","\u1e2a":"H","\u0126":"H","\u2c67":"H","\u2c75":"H","\ua78d":"H","\u24be":"I","\uff29":"I","\xcc":"I","\xcd":"I","\xce":"I","\u0128":"I","\u012a":"I","\u012c":"I","\u0130":"I","\xcf":"I","\u1e2e":"I","\u1ec8":"I","\u01cf":"I","\u0208":"I","\u020a":"I","\u1eca":"I","\u012e":"I","\u1e2c":"I","\u0197":"I","\u24bf":"J","\uff2a":"J","\u0134":"J","\u0248":"J","\u24c0":"K","\uff2b":"K","\u1e30":"K","\u01e8":"K","\u1e32":"K","\u0136":"K","\u1e34":"K","\u0198":"K","\u2c69":"K","\ua740":"K","\ua742":"K","\ua744":"K","\ua7a2":"K","\u24c1":"L","\uff2c":"L","\u013f":"L","\u0139":"L","\u013d":"L","\u1e36":"L","\u1e38":"L","\u013b":"L","\u1e3c":"L","\u1e3a":"L","\u0141":"L","\u023d":"L","\u2c62":"L","\u2c60":"L","\ua748":"L","\ua746":"L","\ua780":"L","\u01c7":"LJ","\u01c8":"Lj","\u24c2":"M","\uff2d":"M","\u1e3e":"M","\u1e40":"M","\u1e42":"M","\u2c6e":"M","\u019c":"M","\u24c3":"N","\uff2e":"N","\u01f8":"N","\u0143":"N","\xd1":"N","\u1e44":"N","\u0147":"N","\u1e46":"N","\u0145":"N","\u1e4a":"N","\u1e48":"N","\u0220":"N","\u019d":"N","\ua790":"N","\ua7a4":"N","\u01ca":"NJ","\u01cb":"Nj","\u24c4":"O","\uff2f":"O","\xd2":"O","\xd3":"O","\xd4":"O","\u1ed2":"O","\u1ed0":"O","\u1ed6":"O","\u1ed4":"O","\xd5":"O","\u1e4c":"O","\u022c":"O","\u1e4e":"O","\u014c":"O","\u1e50":"O","\u1e52":"O","\u014e":"O","\u022e":"O","\u0230":"O","\xd6":"O","\u022a":"O","\u1ece":"O","\u0150":"O","\u01d1":"O","\u020c":"O","\u020e":"O","\u01a0":"O","\u1edc":"O","\u1eda":"O","\u1ee0":"O","\u1ede":"O","\u1ee2":"O","\u1ecc":"O","\u1ed8":"O","\u01ea":"O","\u01ec":"O","\xd8":"O","\u01fe":"O","\u0186":"O","\u019f":"O","\ua74a":"O","\ua74c":"O","\u01a2":"OI","\ua74e":"OO","\u0222":"OU","\u24c5":"P","\uff30":"P","\u1e54":"P","\u1e56":"P","\u01a4":"P","\u2c63":"P","\ua750":"P","\ua752":"P","\ua754":"P","\u24c6":"Q","\uff31":"Q","\ua756":"Q","\ua758":"Q","\u024a":"Q","\u24c7":"R","\uff32":"R","\u0154":"R","\u1e58":"R","\u0158":"R","\u0210":"R","\u0212":"R","\u1e5a":"R","\u1e5c":"R","\u0156":"R","\u1e5e":"R","\u024c":"R","\u2c64":"R","\ua75a":"R","\ua7a6":"R","\ua782":"R","\u24c8":"S","\uff33":"S","\u1e9e":"S","\u015a":"S","\u1e64":"S","\u015c":"S","\u1e60":"S","\u0160":"S","\u1e66":"S","\u1e62":"S","\u1e68":"S","\u0218":"S","\u015e":"S","\u2c7e":"S","\ua7a8":"S","\ua784":"S","\u24c9":"T","\uff34":"T","\u1e6a":"T","\u0164":"T","\u1e6c":"T","\u021a":"T","\u0162":"T","\u1e70":"T","\u1e6e":"T","\u0166":"T","\u01ac":"T","\u01ae":"T","\u023e":"T","\ua786":"T","\ua728":"TZ","\u24ca":"U","\uff35":"U","\xd9":"U","\xda":"U","\xdb":"U","\u0168":"U","\u1e78":"U","\u016a":"U","\u1e7a":"U","\u016c":"U","\xdc":"U","\u01db":"U","\u01d7":"U","\u01d5":"U","\u01d9":"U","\u1ee6":"U","\u016e":"U","\u0170":"U","\u01d3":"U","\u0214":"U","\u0216":"U","\u01af":"U","\u1eea":"U","\u1ee8":"U","\u1eee":"U","\u1eec":"U","\u1ef0":"U","\u1ee4":"U","\u1e72":"U","\u0172":"U","\u1e76":"U","\u1e74":"U","\u0244":"U","\u24cb":"V","\uff36":"V","\u1e7c":"V","\u1e7e":"V","\u01b2":"V","\ua75e":"V","\u0245":"V","\ua760":"VY","\u24cc":"W","\uff37":"W","\u1e80":"W","\u1e82":"W","\u0174":"W","\u1e86":"W","\u1e84":"W","\u1e88":"W","\u2c72":"W","\u24cd":"X","\uff38":"X","\u1e8a":"X","\u1e8c":"X","\u24ce":"Y","\uff39":"Y","\u1ef2":"Y","\xdd":"Y","\u0176":"Y","\u1ef8":"Y","\u0232":"Y","\u1e8e":"Y","\u0178":"Y","\u1ef6":"Y","\u1ef4":"Y","\u01b3":"Y","\u024e":"Y","\u1efe":"Y","\u24cf":"Z","\uff3a":"Z","\u0179":"Z","\u1e90":"Z","\u017b":"Z","\u017d":"Z","\u1e92":"Z","\u1e94":"Z","\u01b5":"Z","\u0224":"Z","\u2c7f":"Z","\u2c6b":"Z","\ua762":"Z","\u24d0":"a","\uff41":"a","\u1e9a":"a","\xe0":"a","\xe1":"a","\xe2":"a","\u1ea7":"a","\u1ea5":"a","\u1eab":"a","\u1ea9":"a","\xe3":"a","\u0101":"a","\u0103":"a","\u1eb1":"a","\u1eaf":"a","\u1eb5":"a","\u1eb3":"a","\u0227":"a","\u01e1":"a","\xe4":"a","\u01df":"a","\u1ea3":"a","\xe5":"a","\u01fb":"a","\u01ce":"a","\u0201":"a","\u0203":"a","\u1ea1":"a","\u1ead":"a","\u1eb7":"a","\u1e01":"a","\u0105":"a","\u2c65":"a","\u0250":"a","\ua733":"aa","\xe6":"ae","\u01fd":"ae","\u01e3":"ae","\ua735":"ao","\ua737":"au","\ua739":"av","\ua73b":"av","\ua73d":"ay","\u24d1":"b","\uff42":"b","\u1e03":"b","\u1e05":"b","\u1e07":"b","\u0180":"b","\u0183":"b","\u0253":"b","\u24d2":"c","\uff43":"c","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\xe7":"c","\u1e09":"c","\u0188":"c","\u023c":"c","\ua73f":"c","\u2184":"c","\u24d3":"d","\uff44":"d","\u1e0b":"d","\u010f":"d","\u1e0d":"d","\u1e11":"d","\u1e13":"d","\u1e0f":"d","\u0111":"d","\u018c":"d","\u0256":"d","\u0257":"d","\ua77a":"d","\u01f3":"dz","\u01c6":"dz","\u24d4":"e","\uff45":"e","\xe8":"e","\xe9":"e","\xea":"e","\u1ec1":"e","\u1ebf":"e","\u1ec5":"e","\u1ec3":"e","\u1ebd":"e","\u0113":"e","\u1e15":"e","\u1e17":"e","\u0115":"e","\u0117":"e","\xeb":"e","\u1ebb":"e","\u011b":"e","\u0205":"e","\u0207":"e","\u1eb9":"e","\u1ec7":"e","\u0229":"e","\u1e1d":"e","\u0119":"e","\u1e19":"e","\u1e1b":"e","\u0247":"e","\u025b":"e","\u01dd":"e","\u24d5":"f","\uff46":"f","\u1e1f":"f","\u0192":"f","\ua77c":"f","\u24d6":"g","\uff47":"g","\u01f5":"g","\u011d":"g","\u1e21":"g","\u011f":"g","\u0121":"g","\u01e7":"g","\u0123":"g","\u01e5":"g","\u0260":"g","\ua7a1":"g","\u1d79":"g","\ua77f":"g","\u24d7":"h","\uff48":"h","\u0125":"h","\u1e23":"h","\u1e27":"h","\u021f":"h","\u1e25":"h","\u1e29":"h","\u1e2b":"h","\u1e96":"h","\u0127":"h","\u2c68":"h","\u2c76":"h","\u0265":"h","\u0195":"hv","\u24d8":"i","\uff49":"i","\xec":"i","\xed":"i","\xee":"i","\u0129":"i","\u012b":"i","\u012d":"i","\xef":"i","\u1e2f":"i","\u1ec9":"i","\u01d0":"i","\u0209":"i","\u020b":"i","\u1ecb":"i","\u012f":"i","\u1e2d":"i","\u0268":"i","\u0131":"i","\u24d9":"j","\uff4a":"j","\u0135":"j","\u01f0":"j","\u0249":"j","\u24da":"k","\uff4b":"k","\u1e31":"k","\u01e9":"k","\u1e33":"k","\u0137":"k","\u1e35":"k","\u0199":"k","\u2c6a":"k","\ua741":"k","\ua743":"k","\ua745":"k","\ua7a3":"k","\u24db":"l","\uff4c":"l","\u0140":"l","\u013a":"l","\u013e":"l","\u1e37":"l","\u1e39":"l","\u013c":"l","\u1e3d":"l","\u1e3b":"l","\u017f":"l","\u0142":"l","\u019a":"l","\u026b":"l","\u2c61":"l","\ua749":"l","\ua781":"l","\ua747":"l","\u01c9":"lj","\u24dc":"m","\uff4d":"m","\u1e3f":"m","\u1e41":"m","\u1e43":"m","\u0271":"m","\u026f":"m","\u24dd":"n","\uff4e":"n","\u01f9":"n","\u0144":"n","\xf1":"n","\u1e45":"n","\u0148":"n","\u1e47":"n","\u0146":"n","\u1e4b":"n","\u1e49":"n","\u019e":"n","\u0272":"n","\u0149":"n","\ua791":"n","\ua7a5":"n","\u01cc":"nj","\u24de":"o","\uff4f":"o","\xf2":"o","\xf3":"o","\xf4":"o","\u1ed3":"o","\u1ed1":"o","\u1ed7":"o","\u1ed5":"o","\xf5":"o","\u1e4d":"o","\u022d":"o","\u1e4f":"o","\u014d":"o","\u1e51":"o","\u1e53":"o","\u014f":"o","\u022f":"o","\u0231":"o","\xf6":"o","\u022b":"o","\u1ecf":"o","\u0151":"o","\u01d2":"o","\u020d":"o","\u020f":"o","\u01a1":"o","\u1edd":"o","\u1edb":"o","\u1ee1":"o","\u1edf":"o","\u1ee3":"o","\u1ecd":"o","\u1ed9":"o","\u01eb":"o","\u01ed":"o","\xf8":"o","\u01ff":"o","\u0254":"o","\ua74b":"o","\ua74d":"o","\u0275":"o","\u01a3":"oi","\u0223":"ou","\ua74f":"oo","\u24df":"p","\uff50":"p","\u1e55":"p","\u1e57":"p","\u01a5":"p","\u1d7d":"p","\ua751":"p","\ua753":"p","\ua755":"p","\u24e0":"q","\uff51":"q","\u024b":"q","\ua757":"q","\ua759":"q","\u24e1":"r","\uff52":"r","\u0155":"r","\u1e59":"r","\u0159":"r","\u0211":"r","\u0213":"r","\u1e5b":"r","\u1e5d":"r","\u0157":"r","\u1e5f":"r","\u024d":"r","\u027d":"r","\ua75b":"r","\ua7a7":"r","\ua783":"r","\u24e2":"s","\uff53":"s","\xdf":"s","\u015b":"s","\u1e65":"s","\u015d":"s","\u1e61":"s","\u0161":"s","\u1e67":"s","\u1e63":"s","\u1e69":"s","\u0219":"s","\u015f":"s","\u023f":"s","\ua7a9":"s","\ua785":"s","\u1e9b":"s","\u24e3":"t","\uff54":"t","\u1e6b":"t","\u1e97":"t","\u0165":"t","\u1e6d":"t","\u021b":"t","\u0163":"t","\u1e71":"t","\u1e6f":"t","\u0167":"t","\u01ad":"t","\u0288":"t","\u2c66":"t","\ua787":"t","\ua729":"tz","\u24e4":"u","\uff55":"u","\xf9":"u","\xfa":"u","\xfb":"u","\u0169":"u","\u1e79":"u","\u016b":"u","\u1e7b":"u","\u016d":"u","\xfc":"u","\u01dc":"u","\u01d8":"u","\u01d6":"u","\u01da":"u","\u1ee7":"u","\u016f":"u","\u0171":"u","\u01d4":"u","\u0215":"u","\u0217":"u","\u01b0":"u","\u1eeb":"u","\u1ee9":"u","\u1eef":"u","\u1eed":"u","\u1ef1":"u","\u1ee5":"u","\u1e73":"u","\u0173":"u","\u1e77":"u","\u1e75":"u","\u0289":"u","\u24e5":"v","\uff56":"v","\u1e7d":"v","\u1e7f":"v","\u028b":"v","\ua75f":"v","\u028c":"v","\ua761":"vy","\u24e6":"w","\uff57":"w","\u1e81":"w","\u1e83":"w","\u0175":"w","\u1e87":"w","\u1e85":"w","\u1e98":"w","\u1e89":"w","\u2c73":"w","\u24e7":"x","\uff58":"x","\u1e8b":"x","\u1e8d":"x","\u24e8":"y","\uff59":"y","\u1ef3":"y","\xfd":"y","\u0177":"y","\u1ef9":"y","\u0233":"y","\u1e8f":"y","\xff":"y","\u1ef7":"y","\u1e99":"y","\u1ef5":"y","\u01b4":"y","\u024f":"y","\u1eff":"y","\u24e9":"z","\uff5a":"z","\u017a":"z","\u1e91":"z","\u017c":"z","\u017e":"z","\u1e93":"z","\u1e95":"z","\u01b6":"z","\u0225":"z","\u0240":"z","\u2c6c":"z","\ua763":"z","\u0386":"\u0391","\u0388":"\u0395","\u0389":"\u0397","\u038a":"\u0399","\u03aa":"\u0399","\u038c":"\u039f","\u038e":"\u03a5","\u03ab":"\u03a5","\u038f":"\u03a9","\u03ac":"\u03b1","\u03ad":"\u03b5","\u03ae":"\u03b7","\u03af":"\u03b9","\u03ca":"\u03b9","\u0390":"\u03b9","\u03cc":"\u03bf","\u03cd":"\u03c5","\u03cb":"\u03c5","\u03b0":"\u03c5","\u03c9":"\u03c9","\u03c2":"\u03c3"},e.fnOperators={equal:(t,r,s,a)=>(a&&(t=e.ignoreDiacritics(t),r=e.ignoreDiacritics(r)),s?e.toLowerCase(t)===e.toLowerCase(r):t===r),notequal:(t,r,s,a)=>(a&&(t=e.ignoreDiacritics(t),r=e.ignoreDiacritics(r)),!e.fnOperators.equal(t,r,s)),lessthan:(t,r,a)=>a?e.toLowerCase(t)<e.toLowerCase(r):(Object(s.u)(t)&&(t=void 0),t<r),greaterthan:(t,r,s)=>s?e.toLowerCase(t)>e.toLowerCase(r):t>r,lessthanorequal:(t,r,a)=>a?e.toLowerCase(t)<=e.toLowerCase(r):(Object(s.u)(t)&&(t=void 0),t<=r),greaterthanorequal:(t,r,s)=>s?e.toLowerCase(t)>=e.toLowerCase(r):t>=r,contains:(t,r,a,o)=>(o&&(t=e.ignoreDiacritics(t),r=e.ignoreDiacritics(r)),a?!Object(s.u)(t)&&!Object(s.u)(r)&&-1!==e.toLowerCase(t).indexOf(e.toLowerCase(r)):!Object(s.u)(t)&&!Object(s.u)(r)&&-1!==t.toString().indexOf(r)),notnull:e=>null!==e,isnull:e=>null===e,startswith:(t,r,s,a)=>(a&&(t=e.ignoreDiacritics(t),r=e.ignoreDiacritics(r)),s?t&&r&&e.startsWith(e.toLowerCase(t),e.toLowerCase(r)):t&&r&&e.startsWith(t,r)),endswith:(t,r,s,a)=>(a&&(t=e.ignoreDiacritics(t),r=e.ignoreDiacritics(r)),s?t&&r&&e.endsWith(e.toLowerCase(t),e.toLowerCase(r)):t&&r&&e.endsWith(t,r)),processSymbols:t=>{let r=e.operatorSymbols[t];return r?e.fnOperators[r]:e.throwError("Query - Process Operator : Invalid operator")},processOperator:t=>e.fnOperators[t]||e.fnOperators.processSymbols(t)},e.parse={parseJson:t=>("string"==typeof t?t=JSON.parse(t,e.parse.jsonReviver):t instanceof Array?e.parse.iterateAndReviveArray(t):"object"==typeof t&&null!==t&&e.parse.iterateAndReviveJson(t),t),iterateAndReviveArray:t=>{for(let r=0;r<t.length;r++)"object"==typeof t[r]&&null!==t[r]?e.parse.iterateAndReviveJson(t[r]):t[r]="string"!=typeof t[r]||/^[\s]*\[|^[\s]*\{(.)+:|\"/g.test(t[r])?e.parse.parseJson(t[r]):e.parse.jsonReviver("",t[r])},iterateAndReviveJson:t=>{let r,s=Object.keys(t);for(let a of s)e.startsWith(a,"__")||(r=t[a],"object"==typeof r?r instanceof Array?e.parse.iterateAndReviveArray(r):r&&e.parse.iterateAndReviveJson(r):t[a]=e.parse.jsonReviver(t[a],r))},jsonReviver:(t,r)=>{if("string"==typeof r){let t=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(r),s=e.timeZoneHandling?e.serverTimezoneOffset:null;if(t)return e.dateParse.toTimeZone(new Date(parseInt(t[1],10)),s,!0);if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(r)){let t=r.indexOf("Z")>-1||r.indexOf("z")>-1,s=r.split(/[^0-9.]/);if(t)r=e.dateParse.toTimeZone(new Date(parseInt(s[0],10),parseInt(s[1],10)-1,parseInt(s[2],10),parseInt(s[3],10),parseInt(s[4],10),parseInt(s[5],10)),e.serverTimezoneOffset,!1);else{let t=new Date(parseInt(s[0],10),parseInt(s[1],10)-1,parseInt(s[2],10),parseInt(s[3],10),parseInt(s[4],10),parseInt(s[5],10)),a=parseInt(s[6],10),o=parseInt(s[7],10);if(isNaN(a)&&isNaN(o))return t;r.indexOf("+")>-1?t.setHours(t.getHours()-a,t.getMinutes()-o):t.setHours(t.getHours()+a,t.getMinutes()+o),r=e.dateParse.toTimeZone(t,e.serverTimezoneOffset,!1)}null==e.serverTimezoneOffset&&(r=e.dateParse.addSelfOffset(r))}}return r},isJson:t=>"string"==typeof t[0]?t:e.parse.parseJson(t),isGuid:e=>null!=/[A-Fa-f0-9]{8}(?:-[A-Fa-f0-9]{4}){3}-[A-Fa-f0-9]{12}/i.exec(e),replacer:(t,r)=>e.isPlainObject(t)?e.parse.jsonReplacer(t,r):t instanceof Array?e.parse.arrayReplacer(t):t instanceof Date?e.parse.jsonReplacer({val:t},r).val:t,jsonReplacer:(t,r)=>{let s,a=Object.keys(t);for(let o of a){if(s=t[o],!(s instanceof Date))continue;let r=s;null==e.serverTimezoneOffset?t[o]=e.dateParse.toTimeZone(r,null).toJSON():(r=new Date(+r+36e5*e.serverTimezoneOffset),t[o]=e.dateParse.toTimeZone(e.dateParse.addSelfOffset(r),null).toJSON())}return t},arrayReplacer:t=>{for(let r=0;r<t.length;r++)e.isPlainObject(t[r])?t[r]=e.parse.jsonReplacer(t[r]):t[r]instanceof Date&&(t[r]=e.parse.jsonReplacer({date:t[r]}).date);return t},jsonDateReplacer:(t,r)=>{if("value"===t&&r){if("string"==typeof r){let t=/^\/Date\(([+-]?[0-9]+)([+-][0-9]{4})?\)\/$/.exec(r);if(t)r=e.dateParse.toTimeZone(new Date(parseInt(t[1],10)),null,!0);else if(/^(\d{4}\-\d\d\-\d\d([tT][\d:\.]*){1})([zZ]|([+\-])(\d\d):?(\d\d))?$/.test(r)){let t=r.split(/[^0-9]/);r=e.dateParse.toTimeZone(new Date(parseInt(t[0],10),parseInt(t[1],10)-1,parseInt(t[2],10),parseInt(t[3],10),parseInt(t[4],10),parseInt(t[5],10)),null,!0)}}if(r instanceof Date)return r=e.dateParse.addSelfOffset(r),null===e.serverTimezoneOffset?e.dateParse.toTimeZone(e.dateParse.addSelfOffset(r),null).toJSON():(r=e.dateParse.toTimeZone(r,r.getTimezoneOffset()/60*2-e.serverTimezoneOffset,!1)).toJSON()}return r}},e.dateParse={addSelfOffset:e=>new Date(+e-6e4*e.getTimezoneOffset()),toUTC:e=>new Date(+e+6e4*e.getTimezoneOffset()),toTimeZone:(t,r,s)=>{if(null===r)return t;let a=s?e.dateParse.toUTC(t):t;return new Date(+a-36e5*r)},toLocalTime:e=>{let t=e,r=-t.getTimezoneOffset(),s=r>=0?"+":"-",a=e=>{let t=Math.floor(Math.abs(e));return(t<10?"0":"")+t};return t.getFullYear()+"-"+a(t.getMonth()+1)+"-"+a(t.getDate())+"T"+a(t.getHours())+":"+a(t.getMinutes())+":"+a(t.getSeconds())+s+a(r/60)+":"+a(r%60)}},e})();const l={GroupGuid:"{271bbba0-1ee7}"};class u{constructor(e){this.options={from:"table",requestType:"json",sortBy:"sorted",select:"select",skip:"skip",group:"group",take:"take",search:"search",count:"requiresCounts",where:"where",aggregates:"aggregates",expand:"expand"},this.type=u,this.dataSource=e,this.pvt={}}processResponse(e,t,r,s){return e}}class c extends u{processQuery(e,t){let r,s,a,o=e.dataSource.json.slice(0),n=o.length,i=!0,l={},u=0,c=[];for(let h=0;h<t.lazyLoad.length;h++)u++,l[t.lazyLoad[h].key]=t.lazyLoad[h].value;let d={};for(let h=0;h<t.queries.length;h++)s=t.queries[h],"onPage"!==s.fn&&"onGroup"!==s.fn||!t.lazyLoad.length?(r=this[s.fn].call(this,o,s.e,t),"onAggregates"===s.fn?d[s.e.field+" - "+s.e.type]=r:o=void 0!==r?r:o,"onPage"!==s.fn&&"onSkip"!==s.fn&&"onTake"!==s.fn&&"onRange"!==s.fn||(i=!1),i&&(n=o.length)):("onGroup"===s.fn&&c.push(s.e),"onPage"===s.fn&&(a=s.e));if(u){let e=this.lazyLoadGroup({query:t,lazyLoad:l,result:o,group:c,page:a});o=e.result,n=e.count}return t.isCountRequired&&(o={result:o,count:n,aggregates:d}),o}lazyLoadGroup(e){let t=0,r=this.getAggregate(e.query),a=e.result;if(Object(s.u)(e.lazyLoad.onDemandGroupInfo)){a=i.group(a,e.group[0].fieldName,r,null,null,e.group[0].comparer,!0),t=a.length;let s=a;e.page&&(a=this.onPage(a,e.page,e.query)),this.formGroupResult(a,s)}else{let s=e.lazyLoad.onDemandGroupInfo;for(let e=s.where.length-1;e>=0;e--)a=this.onWhere(a,s.where[e]);e.group.length!==s.level&&(a=i.group(a,e.group[s.level].fieldName,r,null,null,e.group[0].comparer,!0)),t=a.length;let o=a;a=a.slice(s.skip),a=a.slice(0,s.take),e.group.length!==s.level&&this.formGroupResult(a,o)}return{result:a,count:t}}formGroupResult(e,t){if(e.length&&t.length){let r="GroupGuid",s="childLevels",a="level",o="records";e[r]=t[r],e[s]=t[s],e[a]=t[a],e[o]=t[o]}return e}getAggregate(e){let t=a.filterQueries(e.queries,"onAggregates"),r=[];if(t.length){let s;for(let a=0;a<t.length;a++)s=t[a].e,r.push({type:s.type,field:i.getValue(s.field,e)})}return r}batchRequest(e,t,r){let s,a=t.deletedRecords.length;for(s=0;s<t.addedRecords.length;s++)this.insert(e,t.addedRecords[s]);for(s=0;s<t.changedRecords.length;s++)this.update(e,r.key,t.changedRecords[s]);for(s=0;s<a;s++)this.remove(e,r.key,t.deletedRecords[s]);return t}onWhere(e,t){return e&&e.length?e.filter(e=>{if(t)return t.validate(e)}):e}onAggregates(e,t){let r=i.aggregates[t.type];return e&&r&&0!==e.length?r(e,t.field):null}onSearch(e,t){return e&&e.length?(0===t.fieldNames.length&&i.getFieldList(e[0],t.fieldNames),e.filter(e=>{for(let r=0;r<t.fieldNames.length;r++)if(t.comparer.call(e,i.getObject(t.fieldNames[r],e),t.searchKey,t.ignoreCase,t.ignoreAccent))return!0;return!1})):e}onSortBy(e,t,r){if(!e||!e.length)return e;let s,a=i.getValue(t.fieldName,r);if(!a)return e.sort(t.comparer);if(a instanceof Array){a=a.slice(0);for(let r=a.length-1;r>=0;r--)a[r]&&(s=t.comparer,i.endsWith(a[r]," desc")&&(s=i.fnSort("descending"),a[r]=a[r].replace(" desc","")),e=i.sort(e,a[r],s));return e}return i.sort(e,a,t.comparer)}onGroup(e,t,r){if(!e||!e.length)return e;let s=this.getAggregate(r);return i.group(e,i.getValue(t.fieldName,r),s,null,null,t.comparer)}onPage(e,t,r){let s=i.getValue(t.pageSize,r),a=(i.getValue(t.pageIndex,r)-1)*s;return e&&e.length?e.slice(a,a+s):e}onRange(e,t){return e&&e.length?e.slice(i.getValue(t.start),i.getValue(t.end)):e}onTake(e,t){return e&&e.length?e.slice(0,i.getValue(t.nos)):e}onSkip(e,t){return e&&e.length?e.slice(i.getValue(t.nos)):e}onSelect(e,t){return e&&e.length?i.select(e,i.getValue(t.fieldNames)):e}insert(e,t,r,a,o){return Object(s.u)(o)?e.dataSource.json.push(t):e.dataSource.json.splice(o,0,t)}remove(e,t,r,s){let a,o=e.dataSource.json;for("object"!=typeof r||r instanceof Date||(r=i.getObject(t,r)),a=0;a<o.length&&i.getObject(t,o[a])!==r;a++);return a!==o.length?o.splice(a,1):null}update(e,t,r,a){let o,n,i=e.dataSource.json;for(Object(s.u)(t)||(n=Object(s.s)(t,r)),o=0;o<i.length&&(Object(s.u)(t)||Object(s.s)(t,i[o])!==n);o++);return o<i.length?Object(s.x)(i[o],r):null}}class d extends u{processQuery(e,t,r){let o,n,l=this.getQueryRequest(t),u=a.filterQueryLists(t.queries,["onSelect","onPage","onSkip","onTake","onRange"]),c=t.params,d=e.dataSource.url,h=null,p=this.options,g={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};"onPage"in u?(o=u.onPage,n=i.getValue(o.pageIndex,t),h=i.getValue(o.pageSize,t),n=(n-1)*h):"onRange"in u&&(o=u.onRange,n=o.start,h=o.end-o.start);for(let s=0;s<l.sorts.length;s++)o=i.getValue(l.sorts[s].e.fieldName,t),g.sorts.push(i.callAdaptorFunction(this,"onEachSort",{name:o,direction:l.sorts[s].e.direction},t));r&&(o=this.getFiltersFrom(r,t),o&&g.filters.push(i.callAdaptorFunction(this,"onEachWhere",o.toJson(),t)));for(let a=0;a<l.filters.length;a++){let e=i.callAdaptorFunction(this,"onEachWhere",l.filters[a].e.toJson(),t);this.getModuleName&&"ODataV4Adaptor"===this.getModuleName()&&!Object(s.u)(l.filters[a].e.key)&&l.filters.length>1&&(e="("+e+")"),g.filters.push(e);let r="object"==typeof g.filters[a]?Object.keys(g.filters[a]):[];for(let t of r)i.isNull(g[t])&&delete g[t]}for(let s=0;s<l.searches.length;s++)o=l.searches[s].e,g.searches.push(i.callAdaptorFunction(this,"onEachSearch",{fields:o.fieldNames,operator:o.operator,key:o.searchKey,ignoreCase:o.ignoreCase},t));for(let s=0;s<l.groups.length;s++)g.groups.push(i.getValue(l.groups[s].e.fieldName,t));for(let s=0;s<l.aggregates.length;s++)o=l.aggregates[s].e,g.aggregates.push({type:o.type,field:i.getValue(o.field,t)});let f={};if(this.getRequestQuery(p,t,u,g,f),i.callAdaptorFunction(this,"addParams",{dm:e,query:t,params:c,reqParams:f}),t.lazyLoad.length)for(let s=0;s<t.lazyLoad.length;s++)f[t.lazyLoad[s].key]=t.lazyLoad[s].value;let y=Object.keys(f);for(let s of y)(i.isNull(f[s])||""===f[s]||0===f[s].length)&&delete f[s];p.skip in f&&p.take in f||null===h||(f[p.skip]=i.callAdaptorFunction(this,"onSkip",n,t),f[p.take]=i.callAdaptorFunction(this,"onTake",h,t));let m=this.pvt;return this.pvt={},"json"===this.options.requestType?{data:JSON.stringify(f,i.parse.jsonDateReplacer),url:d,pvtData:m,type:"POST",contentType:"application/json; charset=utf-8"}:(o=this.convertToQueryString(f,t,e),o=(-1!==e.dataSource.url.indexOf("?")?"&":"/")+o,{type:"GET",url:o.length?d.replace(/\/*$/,o):d,pvtData:m})}getRequestQuery(e,t,r,s,a){let o=a;o[e.from]=t.fromTable,e.apply&&t.distincts.length&&(o[e.apply]="onDistinct"in this?i.callAdaptorFunction(this,"onDistinct",t.distincts):""),!t.distincts.length&&e.expand&&(o[e.expand]="onExpand"in this&&"onSelect"in r?i.callAdaptorFunction(this,"onExpand",{selects:i.getValue(r.onSelect.fieldNames,t),expands:t.expands},t):t.expands),o[e.select]="onSelect"in r&&!t.distincts.length?i.callAdaptorFunction(this,"onSelect",i.getValue(r.onSelect.fieldNames,t),t):"",o[e.count]=t.isCountRequired?i.callAdaptorFunction(this,"onCount",t.isCountRequired,t):"",o[e.search]=s.searches.length?i.callAdaptorFunction(this,"onSearch",s.searches,t):"",o[e.skip]="onSkip"in r?i.callAdaptorFunction(this,"onSkip",i.getValue(r.onSkip.nos,t),t):"",o[e.take]="onTake"in r?i.callAdaptorFunction(this,"onTake",i.getValue(r.onTake.nos,t),t):"",o[e.where]=s.filters.length||s.searches.length?i.callAdaptorFunction(this,"onWhere",s.filters,t):"",o[e.sortBy]=s.sorts.length?i.callAdaptorFunction(this,"onSortBy",s.sorts,t):"",o[e.group]=s.groups.length?i.callAdaptorFunction(this,"onGroup",s.groups,t):"",o[e.aggregates]=s.aggregates.length?i.callAdaptorFunction(this,"onAggregates",s.aggregates,t):"",o.param=[]}convertToQueryString(e,t,r){return""}processResponse(e,t,r,a,o,n){if(a&&a.getResponseHeader("Content-Type")&&-1!==a.getResponseHeader("Content-Type").indexOf("application/json")){let r=i.timeZoneHandling;t&&!t.timeZoneHandling&&(i.timeZoneHandling=!1),e=i.parse.parseJson(e),i.timeZoneHandling=r}let l=o,u=l.pvtData||{},c=e?e.groupDs:[];if(a&&a.getResponseHeader("Content-Type")&&-1!==a.getResponseHeader("Content-Type").indexOf("xml"))return r.isCountRequired?{result:[],count:0}:[];let d=JSON.parse(l.data);if(d&&"batch"===d.action&&e&&e.addedRecords)return n.addedRecords=e.addedRecords,n;e&&e.d&&(e=e.d);let h={};e&&"count"in e&&(h.count=e.count),h.result=e&&e.result?e.result:e;let p=!1;if(Array.isArray(e.result)&&e.result.length){let t="key",a="value",o="level";if(Object(s.u)(e.result[0][t])||(h.result=this.formRemoteGroupedData(h.result,1,u.groups.length-1)),r&&r.lazyLoad.length&&u.groups.length)for(let e=0;e<r.lazyLoad.length;e++)"onDemandGroupInfo"===r.lazyLoad[e][t]&&u.groups.length===r.lazyLoad[e][a][o]&&(p=!0)}return p||this.getAggregateResult(u,e,h,c,r),i.isNull(h.count)?h.result:{result:h.result,count:h.count,aggregates:h.aggregates}}formRemoteGroupedData(e,t,r){for(let s=0;s<e.length;s++)e[s].items.length&&Object.keys(e[s].items[0]).indexOf("key")>-1&&this.formRemoteGroupedData(e[s].items,t+1,r-1);let a="GroupGuid";return e[a]=l[a],e.level=t,e.childLevels=r,e.records=e[0].items.length?this.getGroupedRecords(e,!Object(s.u)(e[0].items.records)):[],e}getGroupedRecords(e,t){let r=[];for(let s=0;s<e.length;s++)if(t)r=r.concat(e[s].items.records);else for(let t=0;t<e[s].items.length;t++)r.push(e[s].items[t]);return r}onGroup(e){return this.pvt.groups=e,e}onAggregates(e){this.pvt.aggregates=e}batchRequest(e,t,r,a,o){return{type:"POST",url:e.dataSource.batchUrl||e.dataSource.crudUrl||e.dataSource.removeUrl||e.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(Object(s.q)({},{changed:t.changedRecords,added:t.addedRecords,deleted:t.deletedRecords,action:"batch",table:r[void 0],key:r[void 0]},i.getAddParams(this,e,a)))}}beforeSend(e,t){}insert(e,t,r,a){return{url:e.dataSource.insertUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(Object(s.q)({},{value:t,table:r,action:"insert"},i.getAddParams(this,e,a)))}}remove(e,t,r,a,o){return{type:"POST",url:e.dataSource.removeUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(Object(s.q)({},{key:r,keyColumn:t,table:a,action:"remove"},i.getAddParams(this,e,o)))}}update(e,t,r,a,o){return{type:"POST",url:e.dataSource.updateUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(Object(s.q)({},{value:r,action:"update",keyColumn:t,key:i.getObject(t,r),table:a},i.getAddParams(this,e,o)))}}getFiltersFrom(e,t){let r,s=t.fKey,a=s,n=t.key,l=[];"object"!=typeof e[0]&&(a=null);for(let u=0;u<e.length;u++)r="object"==typeof e[0]?i.getObject(n||a,e[u]):e[u],l.push(new o(s,"equal",r));return o.or(l)}getAggregateResult(e,t,r,o,n){let l=t;if(t&&t.result&&(l=t.result),e&&e.aggregates&&e.aggregates.length){let s,a=e.aggregates,o=l,n={};t.aggregate&&(o=t.aggregate);for(let e=0;e<a.length;e++)s=i.aggregates[a[e].type],s&&(n[a[e].field+" - "+a[e].type]=s(o,a[e].field));r.aggregates=n}let u=Array.isArray(t.result)&&t.result.length&&!Object(s.u)(t.result[0].key);if(e&&e.groups&&e.groups.length&&!u){let t=e.groups;for(let r=0;r<t.length;r++){let u=null;Object(s.u)(o)||(o=i.group(o,t[r]));let c=a.filterQueries(n.queries,"onGroup")[r].e;l=i.group(l,t[r],e.aggregates,u,o,c.comparer)}r.result=l}return r}getQueryRequest(e){let t={sorts:[],groups:[],filters:[],searches:[],aggregates:[]};return t.sorts=a.filterQueries(e.queries,"onSortBy"),t.groups=a.filterQueries(e.queries,"onGroup"),t.filters=a.filterQueries(e.queries,"onWhere"),t.searches=a.filterQueries(e.queries,"onSearch"),t.aggregates=a.filterQueries(e.queries,"onAggregates"),t}addParams(e){let t=e.reqParams;e.params.length&&(t.params={});for(let r of e.params){if(t[r.key])throw new Error("Query() - addParams: Custom Param is conflicting other request arguments");t[r.key]=r.value,r.fn&&(t[r.key]=r.fn.call(e.query,r.key,e.query,e.dm)),t.params[r.key]=t[r.key]}}}class h extends d{constructor(e){super(),this.options=Object(s.q)({},this.options,{requestType:"get",accept:"application/json;odata=light;q=1,application/json;odata=verbose;q=0.5",multipartAccept:"multipart/mixed",sortBy:"$orderby",select:"$select",skip:"$skip",take:"$top",count:"$inlinecount",where:"$filter",expand:"$expand",batch:"$batch",changeSet:"--changeset_",batchPre:"batch_",contentId:"Content-Id: ",batchContent:"Content-Type: multipart/mixed; boundary=",changeSetContent:"Content-Type: application/http\nContent-Transfer-Encoding: binary ",batchChangeSetContentType:"Content-Type: application/json; charset=utf-8 ",updateType:"PUT"}),Object(s.q)(this.options,e||{})}getModuleName(){return"ODataAdaptor"}onPredicate(e,t,r){let a,o,n="",l=e.value,u=typeof l,c=e.field?h.getField(e.field):null;if(l instanceof Date&&(l="datetime'"+i.parse.replacer(l)+"'"),"string"===u&&(l=encodeURIComponent(l),l="'"+l+"'",r&&(c="cast("+c+", 'Edm.String')"),i.parse.isGuid(l)&&(o="guid"),e.ignoreCase&&(o||(c="tolower("+c+")"),l=l.toLowerCase())),a=i.odBiOperator[e.operator],a)return n+=c,n+=a,o&&(n+=o),n+l;if(a=Object(s.u)(this.getModuleName)||"ODataV4Adaptor"!==this.getModuleName()?i.odUniOperator[e.operator]:i.odv4UniOperator[e.operator],"substringof"===a){let e=l;l=c,c=e}return n+=a+"(",n+=c+",",o&&(n+=o),n+=l+")",n}addParams(e){super.addParams(e),delete e.reqParams.params}onComplexPredicate(e,t,r){let s=[];for(let a=0;a<e.predicates.length;a++)s.push("("+this.onEachWhere(e.predicates[a],t,r)+")");return s.join(" "+e.condition+" ")}onEachWhere(e,t,r){return e.isComplex?this.onComplexPredicate(e,t,r):this.onPredicate(e,t,r)}onWhere(e){return this.pvt.search&&e.push(this.onEachWhere(this.pvt.search,null,!0)),e.join(" and ")}onEachSearch(e){e.fields&&0===e.fields.length&&i.throwError("Query() - Search : oData search requires list of field names to search");let t=this.pvt.search||[];for(let r=0;r<e.fields.length;r++)t.push(new o(e.fields[r],e.operator,e.key,e.ignoreCase));this.pvt.search=t}onSearch(e){return this.pvt.search=o.or(this.pvt.search),""}onEachSort(e){let t=[];if(e.name instanceof Array)for(let r=0;r<e.name.length;r++)t.push(h.getField(e.name[r])+("descending"===e.direction?" desc":""));else t.push(h.getField(e.name)+("descending"===e.direction?" desc":""));return t.join(",")}onSortBy(e){return e.reverse().join(",")}onGroup(e){return this.pvt.groups=e,[]}onSelect(e){for(let t=0;t<e.length;t++)e[t]=h.getField(e[t]);return e.join(",")}onAggregates(e){return this.pvt.aggregates=e,""}onCount(e){return!0===e?"allpages":""}beforeSend(e,t,r){i.endsWith(r.url,this.options.batch)&&"post"===r.type.toLowerCase()?(t.setRequestHeader("Accept",this.options.multipartAccept),t.setRequestHeader("DataServiceVersion","2.0"),t.overrideMimeType("text/plain; charset=x-user-defined")):t.setRequestHeader("Accept",this.options.accept),t.setRequestHeader("DataServiceVersion","2.0"),t.setRequestHeader("MaxDataServiceVersion","2.0")}processResponse(e,t,r,a,o,n){let l="odata.metadata";if(o&&"GET"===o.type&&!this.rootUrl&&e[l]){let t=e[l].split("/$metadata#");this.rootUrl=t[0],this.resourceTableName=t[1]}if(!Object(s.u)(e.d)){let t=r&&r.isCountRequired?e.d.results:e.d,a="__metadata";if(!Object(s.u)(t))for(let e=0;e<t.length;e++)Object(s.u)(t[e][a])||delete t[e][a]}let u=o&&o.pvtData,c=this.processBatchResponse(e,r,a,o,n);if(c)return c;let d=a&&o.getResponseHeader("DataServiceVersion"),h=null,p=d&&parseInt(d,10)||2;if(r&&r.isCountRequired){let t="__count";(e[t]||e["odata.count"])&&(h=e[t]||e["odata.count"]),e.d&&(e=e.d),(e[t]||e["odata.count"])&&(h=e[t]||e["odata.count"])}3===p&&e.value&&(e=e.value),e.d&&(e=e.d),p<3&&e.results&&(e=e.results);let g={};return g.count=h,g.result=e,this.getAggregateResult(u,e,g,null,r),i.isNull(h)?g.result:{result:g.result,count:g.count,aggregates:g.aggregates}}convertToQueryString(e,t,r){let s=[],a=e.table||"";delete e.table,r.dataSource.requiresFormat&&(e.$format="json");let o=Object.keys(e);for(let n of o)s.push(n+"="+e[n]);return s=s.join("&"),r.dataSource.url&&-1!==r.dataSource.url.indexOf("?")&&!a?s:s.length?a+"?"+s:a||""}localTimeReplacer(e,t){for(let r of Object(s.u)(t)?[]:Object.keys(t))t[r]instanceof Date&&(t[r]=i.dateParse.toLocalTime(t[r]));return t}insert(e,t,r){return{url:(e.dataSource.insertUrl||e.dataSource.url).replace(/\/*$/,r?"/"+r:""),data:JSON.stringify(t,this.options.localTime?this.localTimeReplacer:null)}}remove(e,t,r,s){let a;return a="string"!=typeof r||i.parse.isGuid(r)?`(${r})`:`('${r}')`,{type:"DELETE",url:(e.dataSource.removeUrl||e.dataSource.url).replace(/\/*$/,s?"/"+s:"")+a}}update(e,t,r,a,o,n){let l;return"PATCH"!==this.options.updateType||Object(s.u)(n)||(r=this.compareAndRemove(r,n,t)),l="string"!=typeof r[t]||i.parse.isGuid(r[t])?`(${r[t]})`:`('${r[t]}')`,{type:this.options.updateType,url:(e.dataSource.updateUrl||e.dataSource.url).replace(/\/*$/,a?"/"+a:"")+l,data:JSON.stringify(r,this.options.localTime?this.localTimeReplacer:null),accept:this.options.accept}}batchRequest(e,t,r,s,a){let o=r.guid=i.getGuid(this.options.batchPre),n=this.rootUrl?this.rootUrl+"/"+this.options.batch:e.dataSource.url.replace(/\/*$/,"/"+this.options.batch);r.url=this.resourceTableName?this.resourceTableName:r.url;let l={url:r.url,key:r.key,cid:1,cSet:i.getGuid(this.options.changeSet)},u="--"+o+"\n";return u+="Content-Type: multipart/mixed; boundary="+l.cSet.replace("--","")+"\n",this.pvt.changeSet=0,u+=this.generateInsertRequest(t.addedRecords,l,e),u+=this.generateUpdateRequest(t.changedRecords,l,e,a?a.changedRecords:[]),u+=this.generateDeleteRequest(t.deletedRecords,l,e),u+=l.cSet+"--\n",u+="--"+o+"--",{type:"POST",url:n,dataType:"json",contentType:"multipart/mixed; charset=UTF-8;boundary="+o,data:u}}generateDeleteRequest(e,t,r){if(!e)return"";let s="";return s=this.generateBodyContent(e,t,{method:"DELETE ",url:(e,t,r)=>{let s=i.getObject(r,e[t]);return"number"==typeof s||i.parse.isGuid(s)?"("+s+")":s instanceof Date?"("+e[t][r].toJSON()+")":`('${s}')`},data:(e,t)=>""},r),s+"\n"}generateInsertRequest(e,t,r){if(!e)return"";let s="";return s=this.generateBodyContent(e,t,{method:"POST ",url:(e,t,r)=>"",data:(e,t)=>JSON.stringify(e[t])+"\n\n"},r),s}generateUpdateRequest(e,t,r,s){if(!e)return"";let a="";return e.forEach(e=>e=this.compareAndRemove(e,s.filter(r=>i.getObject(t.key,r)===i.getObject(t.key,e))[0],t.key)),a=this.generateBodyContent(e,t,{method:this.options.updateType+" ",url:(e,t,r)=>"number"==typeof e[t][r]||i.parse.isGuid(e[t][r])?"("+e[t][r]+")":e[t][r]instanceof Date?"("+e[t][r].toJSON()+")":`('${e[t][r]}')`,data:(e,t)=>JSON.stringify(e[t])+"\n\n"},r),a}static getField(e){return e.replace(/\./g,"/")}generateBodyContent(e,t,r,a){let o="";for(let n=0;n<e.length;n++)o+="\n"+t.cSet+"\n",o+=this.options.changeSetContent+"\n\n",o+=r.method,"POST "===r.method?o+=(a.dataSource.insertUrl||a.dataSource.crudUrl||t.url)+r.url(e,n,t.key)+" HTTP/1.1\n":"PUT "===r.method||"PATCH "===r.method?o+=(a.dataSource.updateUrl||a.dataSource.crudUrl||t.url)+r.url(e,n,t.key)+" HTTP/1.1\n":"DELETE "===r.method&&(o+=(a.dataSource.removeUrl||a.dataSource.crudUrl||t.url)+r.url(e,n,t.key)+" HTTP/1.1\n"),o+="Accept: "+this.options.accept+"\n",o+="Content-Id: "+this.pvt.changeSet+++"\n",o+=this.options.batchChangeSetContentType+"\n",Object(s.u)(e[n]["@odata.etag"])?o+="\n":(o+="If-Match: "+e[n]["@odata.etag"]+"\n\n",delete e[n]["@odata.etag"]),o+=r.data(e,n);return o}processBatchResponse(e,t,r,a,o){if(r&&r.getResponseHeader("Content-Type")&&-1!==r.getResponseHeader("Content-Type").indexOf("xml"))return t.isCountRequired?{result:[],count:0}:[];if(a&&this.options.batch&&i.endsWith(a.url,this.options.batch)&&"post"===a.type.toLowerCase()){let t,a,n=r.getResponseHeader("Content-Type"),l=e+"";if(n=n.substring(n.indexOf("=batchresponse")+1),l=l.split(n),l.length<2)return{};l=l[1];let u=/(?:\bContent-Type.+boundary=)(changesetresponse.+)/i.exec(l);u&&l.replace(u[0],""),l=l.split(u?u[1]:"");for(let e=l.length;e>-1;e--)/\bContent-ID:/i.test(l[e])&&/\bHTTP.+201/.test(l[e])&&(t=parseInt(/\bContent-ID: (\d+)/i.exec(l[e])[1],10),o.addedRecords[t]&&(a=i.parse.parseJson(/^\{.+\}/m.exec(l[e])[0]),Object(s.q)({},o.addedRecords[t],this.processResponse(a))));return o}return null}compareAndRemove(e,t,r){return Object(s.u)(t)||Object.keys(e).forEach(s=>{s!==r&&"@odata.etag"!==s&&(i.isPlainObject(e[s])?(this.compareAndRemove(e[s],t[s]),0===Object.keys(e[s]).filter(e=>"@odata.etag"!==e).length&&delete e[s]):(e[s]===t[s]||e[s]&&t[s]&&e[s].valueOf()===t[s].valueOf())&&delete e[s])}),e}}class p extends c{constructor(){super(),Object(s.D)("beforeSend",d.prototype.beforeSend,this)}insert(e,t,r,a,o){return this.pvt.position=o,this.updateType="add",{url:e.dataSource.insertUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(Object(s.q)({},{value:t,table:r,action:"insert"},i.getAddParams(this,e,a)))}}remove(e,t,r,a,o){return super.remove(e,t,r),{type:"POST",url:e.dataSource.removeUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(Object(s.q)({},{key:r,keyColumn:t,table:a,action:"remove"},i.getAddParams(this,e,o)))}}update(e,t,r,a,o){return this.updateType="update",this.updateKey=t,{type:"POST",url:e.dataSource.updateUrl||e.dataSource.crudUrl||e.dataSource.url,data:JSON.stringify(Object(s.q)({},{value:r,action:"update",keyColumn:t,key:r[t],table:a},i.getAddParams(this,e,o)))}}processResponse(e,t,r,s,a,o,n){let l;if(e="batch"===(a?JSON.parse(a.data):e).action?i.parse.parseJson(e):e,"add"===this.updateType&&super.insert(t,e,null,null,this.pvt.position),"update"===this.updateType&&super.update(t,this.updateKey,e),this.updateType=void 0,e.added)for(l=0;l<e.added.length;l++)super.insert(t,e.added[l]);if(e.changed)for(l=0;l<e.changed.length;l++)super.update(t,n.key,e.changed[l]);if(e.deleted)for(l=0;l<e.deleted.length;l++)super.remove(t,n.key,e.deleted[l]);return e}batchRequest(e,t,r,a,o){return{type:"POST",url:e.dataSource.batchUrl||e.dataSource.crudUrl||e.dataSource.url,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(Object(s.q)({},{changed:t.changedRecords,added:t.addedRecords,deleted:t.deletedRecords,action:"batch",table:r.url,key:r.key},i.getAddParams(this,e,a)))}}addParams(e){(new d).addParams(e)}}class g extends d{constructor(e){super(),this.options=Object(s.q)({},this.options,{getData:new Function,addRecord:new Function,updateRecord:new Function,deleteRecord:new Function,batchUpdate:new Function}),Object(s.q)(this.options,e||{})}getModuleName(){return"CustomDataAdaptor"}}class f extends d{constructor(e,t,r){super(),this.isCrudAction=!1,this.isInsertAction=!1,Object(s.u)(e)||(this.cacheAdaptor=e),this.pageSize=r,this.guidId=i.getGuid("cacheAdaptor"),window.localStorage.setItem(this.guidId,JSON.stringify({keys:[],results:[]}));let a=this.guidId;Object(s.u)(t)||setInterval(()=>{let e;e=i.parse.parseJson(window.localStorage.getItem(a));let r=[];for(let s=0;s<e.results.length;s++){let a=+new Date,o=+new Date(e.results[s].timeStamp);e.results[s].timeStamp=a-o,a-o>t&&r.push(s)}for(let t=0;t<r.length;t++)e.results.splice(r[t],1),e.keys.splice(r[t],1);window.localStorage.removeItem(a),window.localStorage.setItem(a,JSON.stringify(e))},t)}generateKey(e,t){let r=this.getQueryRequest(t),s=a.filterQueryLists(t.queries,["onSelect","onPage","onSkip","onTake","onRange"]),o=e,n="onPage";n in s&&(o+=s[n].pageIndex),r.sorts.forEach(e=>{o+=e.e.direction+e.e.fieldName}),r.groups.forEach(e=>{o+=e.e.fieldName}),r.searches.forEach(e=>{o+=e.e.searchKey});for(let a=0;a<r.filters.length;a++){let s=r.filters[a];if(s.e.isComplex){let r=t.clone();r.queries=[];for(let e=0;e<s.e.predicates.length;e++)r.queries.push({fn:"onWhere",e:s.e.predicates[e],filter:t.queries.filter});o+=s.e.condition+this.generateKey(e,r)}else o+=s.e.field+s.e.operator+s.e.value}return o}processQuery(e,t,r){let s,a=this.generateKey(e.dataSource.url,t);s=i.parse.parseJson(window.localStorage.getItem(this.guidId));let o=s?s.results[s.keys.indexOf(a)]:null;return null==o||this.isCrudAction||this.isInsertAction?(this.isCrudAction=null,this.isInsertAction=null,this.cacheAdaptor.processQuery.apply(this.cacheAdaptor,[].slice.call(arguments,0))):o}processResponse(e,t,r,s,a,o){if(this.isInsertAction||a&&this.cacheAdaptor.options.batch&&i.endsWith(a.url,this.cacheAdaptor.options.batch)&&"post"===a.type.toLowerCase())return this.cacheAdaptor.processResponse(e,t,r,s,a,o);e=this.cacheAdaptor.processResponse.apply(this.cacheAdaptor,[].slice.call(arguments,0));let n=r?this.generateKey(t.dataSource.url,r):t.dataSource.url,l={};l=i.parse.parseJson(window.localStorage.getItem(this.guidId));let u=l.keys.indexOf(n);for(-1!==u&&(l.results.splice(u,1),l.keys.splice(u,1)),l.results[l.keys.push(n)-1]={keys:n,result:e.result,timeStamp:new Date,count:e.count};l.results.length>this.pageSize;)l.results.splice(0,1),l.keys.splice(0,1);return window.localStorage.setItem(this.guidId,JSON.stringify(l)),e}beforeSend(e,t,r){!Object(s.u)(this.cacheAdaptor.options.batch)&&i.endsWith(r.url,this.cacheAdaptor.options.batch)&&"post"===r.type.toLowerCase()&&t.setRequestHeader("Accept",this.cacheAdaptor.options.multipartAccept),e.dataSource.crossDomain||t.setRequestHeader("Accept",this.cacheAdaptor.options.accept)}update(e,t,r,s){return this.isCrudAction=!0,this.cacheAdaptor.update(e,t,r,s)}insert(e,t,r){return this.isInsertAction=!0,this.cacheAdaptor.insert(e,t,r)}remove(e,t,r,s){return this.isCrudAction=!0,this.cacheAdaptor.remove(e,t,r,s)}batchRequest(e,t,r){return this.cacheAdaptor.batchRequest(e,t,r)}}class y{constructor(e,t,r){let o;return this.dateParse=!0,this.timeZoneHandling=!0,this.requests=[],e||this.dataSource||(e=[]),r=r||e.adaptor,e&&!1===e.timeZoneHandling&&(this.timeZoneHandling=e.timeZoneHandling),e instanceof Array?o={json:e,offline:!0}:"object"==typeof e?(e.json||(e.json=[]),o={url:e.url,insertUrl:e.insertUrl,removeUrl:e.removeUrl,updateUrl:e.updateUrl,crudUrl:e.crudUrl,batchUrl:e.batchUrl,json:e.json,headers:e.headers,accept:e.accept,data:e.data,timeTillExpiration:e.timeTillExpiration,cachingPageSize:e.cachingPageSize,enableCaching:e.enableCaching,requestType:e.requestType,key:e.key,crossDomain:e.crossDomain,jsonp:e.jsonp,dataType:e.dataType,offline:void 0!==e.offline?e.offline:!(e.adaptor instanceof p||e.adaptor instanceof g||e.url),requiresFormat:e.requiresFormat}):i.throwError("DataManager: Invalid arguments"),void 0!==o.requiresFormat||i.isCors()||(o.requiresFormat=!!Object(s.u)(o.crossDomain)||o.crossDomain),void 0===o.dataType&&(o.dataType="json"),this.dataSource=o,this.defaultQuery=t,o.url&&o.offline&&!o.json.length?(this.isDataAvailable=!1,this.adaptor=r||new h,this.dataSource.offline=!1,this.ready=this.executeQuery(t||new a),this.ready.then(e=>{this.dataSource.offline=!0,this.isDataAvailable=!0,o.json=e.result,this.adaptor=new c})):this.adaptor=o.offline?new c:new h,!o.jsonp&&this.adaptor instanceof h&&(o.jsonp="callback"),this.adaptor=r||this.adaptor,o.enableCaching&&(this.adaptor=new f(this.adaptor,o.timeTillExpiration,o.cachingPageSize)),this}setDefaultQuery(e){return this.defaultQuery=e,this}executeLocal(e){this.defaultQuery||e instanceof a||i.throwError("DataManager - executeLocal() : A query is required to execute"),this.dataSource.json||i.throwError("DataManager - executeLocal() : Json data is required to execute");let t=this.adaptor.processQuery(this,e=e||this.defaultQuery);if(e.subQuery){let r=e.subQuery.fromTable,a=e.subQuery.lookups,o=e.isCountRequired?t.result:t;a&&a instanceof Array&&i.buildHierarchy(e.subQuery.fKey,r,o,a,e.subQuery.key);for(let t=0;t<o.length;t++)o[t][r]instanceof Array&&(o[t]=Object(s.q)({},{},o[t]),o[t][r]=this.adaptor.processResponse(e.subQuery.using(new y(o[t][r].slice(0))).executeLocal(),this,e))}return this.adaptor.processResponse(t,this,e)}executeQuery(e,t,r,o){"function"==typeof e&&(o=r,r=t,t=e,e=null),e||(e=this.defaultQuery),e instanceof a||i.throwError("DataManager - executeQuery() : A query is required to execute");let n=new m,l={query:e};if(!this.dataSource.offline&&void 0!==this.dataSource.url&&""!==this.dataSource.url||!Object(s.u)(this.adaptor.makeRequest)||this.isCustomDataAdaptor(this.adaptor)){let t=this.adaptor.processQuery(this,e);Object(s.u)(this.adaptor.makeRequest)?!Object(s.u)(t.url)||this.isCustomDataAdaptor(this.adaptor)?this.makeRequest(t,n,l,e):(l=y.getDeferedArgs(e,t,l),n.resolve(l)):this.adaptor.makeRequest(t,n,l,e)}else y.nextTick(()=>{let t=this.executeLocal(e);l=y.getDeferedArgs(e,t,l),n.resolve(l)});return(t||r)&&n.promise.then(t,r),o&&n.promise.then(o,o),n.promise}static getDeferedArgs(e,t,r){return e.isCountRequired?(r.result=t.result,r.count=t.count,r.aggregates=t.aggregates):r.result=t,r}static nextTick(e){(window.setImmediate||window.setTimeout)(e,0)}extendRequest(e,t,r){return Object(s.q)({},{type:"GET",dataType:this.dataSource.dataType,crossDomain:this.dataSource.crossDomain,jsonp:this.dataSource.jsonp,cache:!0,processData:!1,onSuccess:t,onFailure:r},e)}makeRequest(e,t,r,a){let o=!!a.subQuerySelector,n=e=>{r.error=e,t.reject(r)},l=(e,s,a,o,n,i,l)=>{r.xhr=a,r.count=s?parseInt(s.toString(),10):0,r.result=e,r.request=o,r.aggregates=i,r.actual=n,r.virtualSelectRecords=l,t.resolve(r)},u=(e,t)=>{let s=new m,u={parent:r};a.subQuery.isChild=!0;let c=this.adaptor.processQuery(this,a.subQuery,e?this.adaptor.processResponse(e):t),d=this.makeRequest(c,s,u,a.subQuery);return o||s.then(t=>{e&&(i.buildHierarchy(a.subQuery.fKey,a.subQuery.fromTable,e,t,a.subQuery.key),l(e,t.count,t.xhr))},n),d},c=this.extendRequest(e,(e,t)=>{if(this.isGraphQLAdaptor(this.adaptor)&&!Object(s.u)(e.errors))return n(e.errors);this.isCustomDataAdaptor(this.adaptor)&&(t=Object(s.q)({},this.ajaxReqOption,t)),-1===t.httpRequest.getResponseHeader("Content-Type").indexOf("xml")&&this.dateParse&&(e=i.parse.parseJson(e));let r=this.adaptor.processResponse(e,this,a,t.httpRequest,t),c=0,d=null,h=e.virtualSelectRecords;a.isCountRequired&&(c=r.count,d=r.aggregates,r=r.result),a.subQuery?o||u(r,t):l(r,c,t.httpRequest,t.type,e,d,h)},n);if(this.isCustomDataAdaptor(this.adaptor))this.ajaxReqOption=c,this.adaptor.options.getData({data:c.data,onSuccess:c.onSuccess,onFailure:c.onFailure});else{let e=new s.a(c);e.beforeSend=()=>{this.beforeSend(e.httpRequest,e)},c=e.send(),c.catch(e=>!0),this.requests.push(e)}if(o){let e,t=a.subQuerySelector.call(this,{query:a.subQuery,parent:a});t&&t.length?(e=Promise.all([c,u(null,t)]),e.then((...e)=>{let t=e[0],r=this.adaptor.processResponse(t[0],this,a,this.requests[0].httpRequest,this.requests[0]),s=0;a.isCountRequired&&(s=r.count,r=r.result);let n=this.adaptor.processResponse(t[1],this,a.subQuery,this.requests[1].httpRequest,this.requests[1]);s=0,a.subQuery.isCountRequired&&(s=n.count,n=n.result),i.buildHierarchy(a.subQuery.fKey,a.subQuery.fromTable,r,n,a.subQuery.key),o=!1,l(r,s,this.requests[0].httpRequest)})):o=!1}return c}beforeSend(e,t){this.adaptor.beforeSend(this,e,t);let r,s=this.dataSource.headers;for(let a=0;s&&a<s.length;a++){r=[];let t=Object.keys(s[a]);for(let o of t)r.push(o),e.setRequestHeader(o,s[a][o])}}saveChanges(e,t,r,o,n){r instanceof a&&(o=r,r=null);let i={url:r,key:t||this.dataSource.key},l=this.adaptor.batchRequest(this,e,i,o||new a,n);if(this.dataSource.offline)return l;if(Object(s.u)(this.adaptor.doAjaxRequest)){if(this.isCustomDataAdaptor(this.adaptor))return this.doAjaxRequest(l,this.adaptor.options.batchUpdate);{let t=new m,r=new s.a(l);return r.beforeSend=()=>{this.beforeSend(r.httpRequest,r)},r.onSuccess=(a,o)=>{this.isGraphQLAdaptor(this.adaptor)&&(Object(s.u)(a.errors)||r.onFailure(JSON.stringify(a.errors))),t.resolve(this.adaptor.processResponse(a,this,null,o.httpRequest,o,e,i))},r.onFailure=e=>{t.reject([{error:e}])},r.send().catch(e=>!0),t.promise}}return this.adaptor.doAjaxRequest(l)}insert(e,t,r,o){t instanceof a&&(r=t,t=null);let n=this.adaptor.insert(this,e,t,r,o);return this.dataSource.offline?n:Object(s.u)(this.adaptor.doAjaxRequest)?this.doAjaxRequest(n,this.adaptor.options.addRecord):this.adaptor.doAjaxRequest(n)}remove(e,t,r,o){"object"==typeof t&&(t=i.getObject(e,t)),r instanceof a&&(o=r,r=null);let n=this.adaptor.remove(this,e,t,r,o);return this.dataSource.offline?n:Object(s.u)(this.adaptor.doAjaxRequest)?this.doAjaxRequest(n,this.adaptor.options.deleteRecord):this.adaptor.doAjaxRequest(n)}update(e,t,r,o,n){r instanceof a&&(o=r,r=null);let i=this.adaptor.update(this,e,t,r,o,n);return this.dataSource.offline?i:Object(s.u)(this.adaptor.doAjaxRequest)?this.doAjaxRequest(i,this.adaptor.options.updateRecord):this.adaptor.doAjaxRequest(i)}isCustomDataAdaptor(e){return this.adaptor.getModuleName&&"CustomDataAdaptor"===this.adaptor.getModuleName()}isGraphQLAdaptor(e){return this.adaptor.getModuleName&&"GraphQLAdaptor"===this.adaptor.getModuleName()}successFunc(e,t){if(this.isGraphQLAdaptor(this.adaptor)){let t=JSON.parse(e);Object(s.u)(t.errors)||this.failureFunc(JSON.stringify(t.errors))}this.isCustomDataAdaptor(this.adaptor)&&(t=Object(s.q)({},this.ajaxReqOption,t));try{i.parse.parseJson(e)}catch(r){e=[]}e=this.adaptor.processResponse(i.parse.parseJson(e),this,null,t.httpRequest,t),this.ajaxDeffered.resolve(e)}failureFunc(e){this.ajaxDeffered.reject([{error:e}])}doAjaxRequest(e,t){if(e=Object(s.q)({},{type:"POST",contentType:"application/json; charset=utf-8",processData:!1},e),this.ajaxDeffered=new m,this.isCustomDataAdaptor(this.adaptor))this.ajaxReqOption=e,t.call(this,{data:e.data,onSuccess:this.successFunc.bind(this),onFailure:this.failureFunc.bind(this)});else{let t=new s.a(e);t.beforeSend=()=>{this.beforeSend(t.httpRequest,t)},t.onSuccess=this.successFunc.bind(this),t.onFailure=this.failureFunc.bind(this),t.send().catch(e=>!0)}return this.ajaxDeffered.promise}}class m{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t}),this.then=this.promise.then.bind(this.promise),this.catch=this.promise.catch.bind(this.promise)}}}}]);